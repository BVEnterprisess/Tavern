/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e={28:e=>{e.exports=(e,t)=>`${e}-${t}-${Math.random().toString(16).slice(3,8)}`},39:e=>{e.exports=async(e,t)=>{e.postMessage(t)}},119:e=>{e.exports={langPath:"https://tessdata.projectnaptha.com/4.0.0",workerBlobURL:!0,logger:()=>{}}},125:e=>{"use strict";e.exports=JSON.parse('{"name":"tesseract.js","version":"4.1.4","description":"Pure Javascript Multilingual OCR","main":"src/index.js","types":"src/index.d.ts","unpkg":"dist/tesseract.min.js","jsdelivr":"dist/tesseract.min.js","scripts":{"start":"node scripts/server.js","build":"rimraf dist && webpack --config scripts/webpack.config.prod.js && rollup -c scripts/rollup.esm.mjs","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json","prepublishOnly":"npm run build","wait":"rimraf dist && wait-on http://localhost:3000/dist/tesseract.dev.js","test":"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:* test:node:all","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser-tpl":"mocha-headless-chrome -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:detect":"npm run test:browser-tpl -- -f ./tests/detect.test.html","test:browser:recognize":"npm run test:browser-tpl -- -f ./tests/recognize.test.html","test:browser:scheduler":"npm run test:browser-tpl -- -f ./tests/scheduler.test.html","test:browser:FS":"npm run test:browser-tpl -- -f ./tests/FS.test.html","lint":"eslint src","lint:fix":"eslint --fix src","postinstall":"opencollective-postinstall || true"},"browser":{"./src/worker/node/index.js":"./src/worker/browser/index.js"},"author":"","contributors":["jeromewu"],"license":"Apache-2.0","devDependencies":{"@babel/core":"^7.21.4","@babel/eslint-parser":"^7.21.3","@babel/preset-env":"^7.21.4","@rollup/plugin-commonjs":"^24.1.0","acorn":"^8.8.2","babel-loader":"^9.1.2","buffer":"^6.0.3","cors":"^2.8.5","eslint":"^7.32.0","eslint-config-airbnb-base":"^14.2.1","eslint-plugin-import":"^2.27.5","expect.js":"^0.3.1","express":"^4.18.2","mocha":"^10.2.0","mocha-headless-chrome":"^4.0.0","npm-run-all":"^4.1.5","nyc":"^15.1.0","rimraf":"^5.0.0","rollup":"^3.20.7","wait-on":"^7.0.1","webpack":"^5.79.0","webpack-bundle-analyzer":"^4.8.0","webpack-cli":"^5.0.1","webpack-dev-middleware":"^6.0.2","rollup-plugin-sourcemaps":"^0.6.3"},"dependencies":{"bmp-js":"^0.1.0","idb-keyval":"^6.2.0","is-electron":"^2.2.2","is-url":"^1.2.4","node-fetch":"^2.6.9","opencollective-postinstall":"^2.0.3","regenerator-runtime":"^0.13.3","tesseract.js-core":"^4.0.4","wasm-feature-detect":"^1.2.11","zlibjs":"^0.3.1"},"overrides":{"@rollup/pluginutils":"^5.0.2"},"repository":{"type":"git","url":"https://github.com/naptha/tesseract.js.git"},"bugs":{"url":"https://github.com/naptha/tesseract.js/issues"},"homepage":"https://github.com/naptha/tesseract.js","collective":{"type":"opencollective","url":"https://opencollective.com/tesseractjs"}}')},321:(e,t,n)=>{const r=n(848),o=n(456),i=n(548),a=n(381),s=n(39),c=n(996);e.exports={defaultOptions:r,spawnWorker:o,terminateWorker:i,onMessage:a,send:s,loadImage:c}},381:e=>{e.exports=(e,t)=>{e.onmessage=({data:e})=>{t(e)}}},452:e=>{var t=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),s=new C(r||[]);return o(a,"_invoke",{value:P(e,n,s)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d="suspendedStart",h="suspendedYield",p="executing",m="completed",y={};function v(){}function g(){}function b(){}var w={};l(w,a,function(){return this});var k=Object.getPrototypeOf,S=k&&k(k(j([])));S&&S!==n&&r.call(S,a)&&(w=S);var E=b.prototype=v.prototype=Object.create(w);function x(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e)})})}function O(e,t){function n(o,i,a,s){var c=f(e[o],e,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==typeof u&&r.call(u,"__await")?t.resolve(u.__await).then(function(e){n("next",e,a,s)},function(e){n("throw",e,a,s)}):t.resolve(u).then(function(e){l.value=e,a(l)},function(e){return n("throw",e,a,s)})}s(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t(function(t,o){n(e,r,t,o)})}return i=i?i.then(o,o):o()}})}function P(e,t,n){var r=d;return function(o,i){if(r===p)throw new Error("Generator is already running");if(r===m){if("throw"===o)throw i;return A()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=I(a,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===d)throw r=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var c=f(e,t,n);if("normal"===c.type){if(r=n.done?m:h,c.arg===y)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=m,n.method="throw",n.arg=c.arg)}}}function I(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,I(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function j(e){if(e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}return{next:A}}function A(){return{value:t,done:!0}}return g.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=l(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},e.awrap=function(e){return{__await:e}},x(O.prototype),l(O.prototype,s,function(){return this}),e.AsyncIterator=O,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new O(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then(function(e){return e.done?e.value:a.next()})},x(E),l(E,c,"Generator"),l(E,a,function(){return this}),l(E,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=j,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return s.type="throw",s.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:j(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},456:e=>{e.exports=({workerPath:e,workerBlobURL:t})=>{let n;if(Blob&&URL&&t){const t=new Blob([`importScripts("${e}");`],{type:"application/javascript"});n=new Worker(URL.createObjectURL(t))}else n=new Worker(e);return n}},465:(e,t,n)=>{const r=n(477);e.exports={recognize:async(e,t,n)=>{const o=await r(n);return await o.loadLanguage(t),await o.initialize(t),o.recognize(e).finally(async()=>{await o.terminate()})},detect:async(e,t)=>{const n=await r(t);return await n.loadLanguage("osd"),await n.initialize("osd"),n.detect(e).finally(async()=>{await n.terminate()})}}},477:(e,t,n)=>{const r=n(981),o=n(760),i=n(500),{log:a}=n(787),s=n(28),{defaultOEM:c}=n(711),{defaultOptions:l,spawnWorker:u,terminateWorker:f,onMessage:d,loadImage:h,send:p}=n(321);let m=0;e.exports=async(e={})=>{const t=s("Worker",m),{logger:n,errorHandler:y,...v}=r({...l,...e}),g={},b={};let w,k;const S=new Promise((e,t)=>{k=e,w=t});let E=u(v);E.onerror=e=>{w(e.message)},m+=1;const x=(e,t)=>{g[e]=t},O=(e,t)=>{b[e]=t},P=({id:e,action:n,payload:r})=>new Promise((o,i)=>{a(`[${t}]: Start ${e}, action=${n}`),x(n,o),O(n,i),p(E,{workerId:t,jobId:e,action:n,payload:r})});d(E,({workerId:e,jobId:t,status:r,action:i,data:s})=>{if("resolve"===r){a(`[${e}]: Complete ${t}`);let n=s;"recognize"===i?n=o(s):"getPDF"===i&&(n=Array.from({...s,length:Object.keys(s).length})),g[i]({jobId:t,data:n})}else if("reject"===r){if(b[i](s),"load"===i&&w(s),!y)throw Error(s);y(s)}else"progress"===r&&n({...s,userJobId:t})});const I={id:t,worker:E,setResolve:x,setReject:O,load:()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),writeText:(e,t,n)=>P(i({id:n,action:"FS",payload:{method:"writeFile",args:[e,t]}})),readText:(e,t)=>P(i({id:t,action:"FS",payload:{method:"readFile",args:[e,{encoding:"utf8"}]}})),removeFile:(e,t)=>P(i({id:t,action:"FS",payload:{method:"unlink",args:[e]}})),FS:(e,t,n)=>P(i({id:n,action:"FS",payload:{method:e,args:t}})),loadLanguage:(e="eng",t)=>P(i({id:t,action:"loadLanguage",payload:{langs:e,options:v}})),initialize:(e="eng",t=c,n,r)=>P(i({id:r,action:"initialize",payload:{langs:e,oem:t,config:n}})),setParameters:(e={},t)=>P(i({id:t,action:"setParameters",payload:{params:e}})),recognize:async(e,t={},n={blocks:!0,text:!0,hocr:!0,tsv:!0},r)=>P(i({id:r,action:"recognize",payload:{image:await h(e),options:t,output:n}})),getPDF:(e="Tesseract OCR Result",t=!1,n)=>(console.log("`getPDF` function is depreciated. `recognize` option `savePDF` should be used instead."),P(i({id:n,action:"getPDF",payload:{title:e,textonly:t}}))),detect:async(e,t)=>P(i({id:t,action:"detect",payload:{image:await h(e)}})),terminate:async()=>(null!==E&&(f(E),E=null),Promise.resolve())};return P(i({id:undefined,action:"load",payload:{options:v}})).then(()=>k(I)).catch(()=>{}),S}},500:(e,t,n)=>{const r=n(28);let o=0;e.exports=({id:e,action:t,payload:n={}})=>{let i=e;return void 0===i&&(i=r("Job",o),o+=1),{id:i,action:t,payload:n}}},548:e=>{e.exports=e=>{e.terminate()}},646:e=>{e.exports={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}},711:(e,t,n)=>{const r=n(742);e.exports={defaultOEM:r.DEFAULT}},742:e=>{e.exports={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}},760:e=>{e.exports=e=>{const t=[],n=[],r=[],o=[],i=[];return e.blocks&&e.blocks.forEach(a=>{a.paragraphs.forEach(t=>{t.lines.forEach(n=>{n.words.forEach(r=>{r.symbols.forEach(o=>{i.push({...o,page:e,block:a,paragraph:t,line:n,word:r})}),o.push({...r,page:e,block:a,paragraph:t,line:n})}),r.push({...n,page:e,block:a,paragraph:t})}),n.push({...t,page:e,block:a})}),t.push({...a,page:e})}),{...e,blocks:t,paragraphs:n,lines:r,words:o,symbols:i}}},787:function(e,t){let n=!1;t.logging=n,t.setLogging=e=>{n=e},t.log=(...e)=>n?console.log.apply(this,e):null},820:(e,t,n)=>{const r=n(866);e.exports=e=>{const t={};return"undefined"!=typeof WorkerGlobalScope?t.type="webworker":r()?t.type="electron":"object"==typeof document?t.type="browser":"object"==typeof process&&(t.type="node"),void 0===e?t:t[e]}},848:(e,t,n)=>{const{version:r}=n(125),o=n(119);var i;e.exports={...o,workerPath:"undefined"!=typeof process&&"development"===process.env.TESS_ENV?(i=`/dist/worker.dev.js?nocache=${Math.random().toString(36).slice(3)}`,new URL(i,window.location.href).href):`https://cdn.jsdelivr.net/npm/tesseract.js@v${r}/dist/worker.min.js`,corePath:null}},866:e=>{e.exports=function(){return"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||!("undefined"==typeof process||"object"!=typeof process.versions||!process.versions.electron)||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0}},882:function(e,t,n){const r=n(500),{log:o}=n(787),i=n(28);let a=0;e.exports=()=>{const e=i("Scheduler",a),t={},n={};let s=[];a+=1;const c=()=>Object.keys(t).length,l=()=>{if(0!==s.length){const e=Object.keys(t);for(let r=0;r<e.length;r+=1)if(void 0===n[e[r]]){s[0](t[e[r]]);break}}},u=(t,i)=>new Promise((a,c)=>{const u=r({action:t,payload:i});s.push(async e=>{s.shift(),n[e.id]=u;try{a(await e[t].apply(this,[...i,u.id]))}catch(e){c(e)}finally{delete n[e.id],l()}}),o(`[${e}]: Add ${u.id} to JobQueue`),o(`[${e}]: JobQueue length=${s.length}`),l()});return{addWorker:n=>(t[n.id]=n,o(`[${e}]: Add ${n.id}`),o(`[${e}]: Number of workers=${c()}`),l(),n.id),addJob:async(t,...n)=>{if(0===c())throw Error(`[${e}]: You need to have at least one worker before adding jobs`);return u(t,n)},terminate:async()=>{Object.keys(t).forEach(async e=>{await t[e].terminate()}),s=[]},getQueueLen:()=>s.length,getNumWorkers:c}}},949:e=>{e.exports={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}},981:(e,t,n)=>{const r="browser"===n(820)("type")?e=>new URL(e,window.location.href).href:e=>e;e.exports=e=>{const t={...e};return["corePath","workerPath","langPath"].forEach(n=>{e[n]&&(t[n]=r(t[n]))}),t}},995:(e,t,n)=>{n(452);const r=n(882),o=n(477),i=n(465),a=n(646),s=n(742),c=n(949),{setLogging:l}=n(787);e.exports={languages:a,OEM:s,PSM:c,createScheduler:r,createWorker:o,setLogging:l,...i}},996:e=>{const t=e=>new Promise((t,n)=>{const r=new FileReader;r.onload=()=>{t(r.result)},r.onerror=({target:{error:{code:e}}})=>{n(Error(`File could not be read! Code=${e}`))},r.readAsArrayBuffer(e)}),n=async e=>{let r=e;if(void 0===e)return"undefined";if("string"==typeof e)if(/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(e))r=atob(e.split(",")[1]).split("").map(e=>e.charCodeAt(0));else{const t=await fetch(e);r=await t.arrayBuffer()}else if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)"IMG"===e.tagName&&(r=await n(e.src)),"VIDEO"===e.tagName&&(r=await n(e.poster)),"CANVAS"===e.tagName&&await new Promise(n=>{e.toBlob(async e=>{r=await t(e),n()})});else if("undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas){const n=await e.convertToBlob();r=await t(n)}else(e instanceof File||e instanceof Blob)&&(r=await t(e));return new Uint8Array(r)};e.exports=n}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r(o.key),o)}}function r(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}var o=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.errorLog=[],this.maxLogSize=100,this.recoveryStrategies=new Map,this.init()},n=[{key:"init",value:function(){var e=this;window.addEventListener("error",function(t){return e.handleError(t.error,"global")}),window.addEventListener("unhandledrejection",function(t){return e.handleError(t.reason,"promise")});var t=console.error;console.error=function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];e.handleError(new Error(r.join(" ")),"console"),t.apply(console,r)}}},{key:"handleError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown",n={message:e.message||"Unknown error",stack:e.stack,source:t,timestamp:(new Date).toISOString(),url:window.location.href,userAgent:navigator.userAgent};this.logError(n),this.attemptRecovery(n),this.showUserError(n),this.reportError(n)}},{key:"logError",value:function(e){this.errorLog.push(e),this.errorLog.length>this.maxLogSize&&(this.errorLog=this.errorLog.slice(-this.maxLogSize));try{localStorage.setItem("errorLog",JSON.stringify(this.errorLog))}catch(e){console.warn("Could not save error log:",e)}}},{key:"attemptRecovery",value:function(e){var t=this.recoveryStrategies.get(e.message);if(t)try{t(e)}catch(e){console.warn("Recovery strategy failed:",e)}this.genericRecovery(e)}},{key:"genericRecovery",value:function(e){(e.message.includes("module")||e.message.includes("import"))&&this.reloadModules(),(e.message.includes("JSON")||e.message.includes("parse"))&&this.clearCorruptedData(),(e.message.includes("service")||e.message.includes("initialize"))&&this.reinitializeServices()}},{key:"reloadModules",value:function(){console.log("Attempting to reload modules..."),window.dispatchEvent(new CustomEvent("moduleReload"))}},{key:"clearCorruptedData",value:function(){console.log("Clearing corrupted data..."),["items86","inventoryData","ocrData"].forEach(function(e){try{localStorage.removeItem(e)}catch(t){console.warn("Could not clear ".concat(e,":"),t)}})}},{key:"reinitializeServices",value:function(){console.log("Reinitializing services..."),window.dispatchEvent(new CustomEvent("serviceReinit"))}},{key:"showUserError",value:function(e){if(!e.message.includes("module")&&!e.message.includes("import")){var t=document.createElement("div");t.className="fixed bottom-4 right-4 bg-red-600 text-white py-2 px-4 rounded-lg shadow-lg z-50",t.innerHTML='\n            <div class="flex items-center">\n                <i class="fas fa-exclamation-triangle mr-2"></i>\n                <span>Something went wrong. Please try again.</span>\n            </div>\n        ',document.body.appendChild(t),setTimeout(function(){t.remove()},5e3)}}},{key:"reportError",value:function(e){window.analytics&&window.analytics.track&&window.analytics.track("Error",{message:e.message,source:e.source,url:e.url})}},{key:"addRecoveryStrategy",value:function(e,t){this.recoveryStrategies.set(e,t)}},{key:"getErrorLog",value:function(){return this.errorLog}},{key:"clearErrorLog",value:function(){this.errorLog=[],localStorage.removeItem("errorLog")}}],n&&t(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}();function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=c(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function c(e,t){if(e){if("string"==typeof e)return l(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function u(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return f(l,"_invoke",function(n,r,o){var i,s,c,l=0,u=o||[],f=!1,d={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,s=0,c=e,d.n=n,a}};function h(n,r){for(s=n,c=r,t=0;!f&&l&&!o&&t<u.length;t++){var o,i=u[t],h=d.p,p=i[2];n>3?(o=p===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(s=0,d.v=r,d.n=i[1]):h<p&&(o=n<3||i[0]>r||r>p)&&(i[4]=n,i[5]=r,d.n=p,s=0))}if(o||n>1)return a;throw f=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&h(u,p),s=u,c=p;(t=s<2?e:c)||!f;){i||(s?s<3?(s>1&&(d.n=-1),h(s,c)):d.n=c:d.v=c);try{if(l=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(f=d.n<0)?c:n.call(r,d))!==a)break}catch(t){i=e,s=1,c=t}finally{l=1}}return{value:t,done:f}}}(n,o,i),!0),l}var a={};function s(){}function c(){}function l(){}t=Object.getPrototypeOf;var d=[][r]?t(t([][r]())):(f(t={},r,function(){return this}),t),h=l.prototype=s.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,f(e,o,"GeneratorFunction")),e.prototype=Object.create(h),e}return c.prototype=l,f(h,"constructor",l),f(l,"constructor",c),c.displayName="GeneratorFunction",f(l,o,"GeneratorFunction"),f(h),f(h,o,"Generator"),f(h,r,function(){return this}),f(h,"toString",function(){return"[object Generator]"}),(u=function(){return{w:i,m:p}})()}function f(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}f=function(e,t,n,r){function i(t,n){f(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},f(e,t,n,r)}function d(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function h(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){d(i,r,o,a,s,"next",e)}function s(e){d(i,r,o,a,s,"throw",e)}a(void 0)})}}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function m(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}var y=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.errorHandler=new o,this.sessionTimeout=18e5,this.maxLoginAttempts=5,this.lockoutDuration=9e5,this.loginAttempts=new Map,this.sessions=new Map,this.init()},t=[{key:"init",value:function(){var e=this;this.checkSession(),setInterval(function(){return e.cleanupSessions()},6e4),setInterval(function(){return e.cleanupLoginAttempts()},3e5)}},{key:"authenticate",value:(i=h(u().m(function e(t,n){var r,o,i;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!this.isLockedOut(t)){e.n=1;break}throw new Error("Account temporarily locked. Please try again later.");case 1:if(this.validateInput(t,n)){e.n=2;break}throw this.recordFailedAttempt(t),new Error("Invalid credentials.");case 2:return e.n=3,this.hashPassword(n);case 3:return r=e.v,e.n=4,this.verifyCredentials(t,r);case 4:if(!e.v){e.n=5;break}return o=this.createSession(t),this.loginAttempts.delete(t),this.logActivity(t,"login_success"),e.a(2,{success:!0,session:o,user:this.getUserInfo(t)});case 5:throw this.recordFailedAttempt(t),new Error("Invalid credentials.");case 6:e.n=8;break;case 7:throw e.p=7,i=e.v,this.errorHandler.handleError(i,"auth"),i;case 8:return e.a(2)}},e,this,[[0,7]])})),function(e,t){return i.apply(this,arguments)})},{key:"validateInput",value:function(e,t){if(!e||!t)return!1;var n=this.sanitizeInput(e),r=this.sanitizeInput(t);return!this.containsSuspiciousPatterns(n)&&!this.containsSuspiciousPatterns(r)}},{key:"sanitizeInput",value:function(e){return"string"!=typeof e?"":e.replace(/[<>]/g,"").replace(/javascript:/gi,"").trim()}},{key:"containsSuspiciousPatterns",value:function(e){return[/<script/i,/javascript:/i,/on\w+\s*=/i,/eval\s*\(/i,/document\./i,/window\./i].some(function(t){return t.test(e)})}},{key:"hashPassword",value:(r=h(u().m(function e(t){var n,r,o,i;return u().w(function(e){for(;;)switch(e.n){case 0:return n=new TextEncoder,r=n.encode(t+"table1837_salt"),e.n=1,crypto.subtle.digest("SHA-256",r);case 1:return o=e.v,i=Array.from(new Uint8Array(o)),e.a(2,i.map(function(e){return e.toString(16).padStart(2,"0")}).join(""))}},e)})),function(e){return r.apply(this,arguments)})},{key:"verifyCredentials",value:(n=h(u().m(function e(t,n){var r;return u().w(function(e){for(;;)if(0===e.n)return r={"user@table1837.com":"5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8","admin@table1837.com":"8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918"},e.a(2,r[t]===n)},e)})),function(e,t){return n.apply(this,arguments)})},{key:"createSession",value:function(e){var t=this.generateSessionId(),n={id:t,username:e,created:Date.now(),lastActivity:Date.now(),permissions:this.getUserPermissions(e)};return this.sessions.set(t,n),this.setSecureCookie("sessionId",t,this.sessionTimeout),n}},{key:"generateSessionId",value:function(){var e=new Uint8Array(32);return crypto.getRandomValues(e),Array.from(e,function(e){return e.toString(16).padStart(2,"0")}).join("")}},{key:"setSecureCookie",value:function(e,t,n){var r="".concat(e,"=").concat(t,"; max-age=").concat(n/1e3,"; path=/; secure; samesite=strict");document.cookie=r}},{key:"getSecureCookie",value:function(e){var t,n=s(document.cookie.split(";"));try{for(n.s();!(t=n.n()).done;){var r=a(t.value.trim().split("="),2),o=r[0],i=r[1];if(o===e)return i}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"checkSession",value:function(){var e=this.getSecureCookie("sessionId");if(e&&this.sessions.has(e)){var t=this.sessions.get(e);return Date.now()-t.lastActivity>this.sessionTimeout?(this.logout(),!1):(t.lastActivity=Date.now(),this.sessions.set(e,t),!0)}return!1}},{key:"logout",value:function(){var e=this.getSecureCookie("sessionId");e&&(this.sessions.delete(e),document.cookie="sessionId=; max-age=0; path=/")}},{key:"isAuthenticated",value:function(){return this.checkSession()}},{key:"getCurrentUser",value:function(){var e=this.getSecureCookie("sessionId");return e&&this.sessions.has(e)?this.sessions.get(e):null}},{key:"getUserPermissions",value:function(e){return{"user@table1837.com":["read","write"],"admin@table1837.com":["read","write","admin","ocr"]}[e]||["read"]}},{key:"getUserInfo",value:function(e){return{"user@table1837.com":{name:"Staff User",role:"Staff",email:e},"admin@table1837.com":{name:"Administrator",role:"Admin",email:e}}[e]||{name:"Unknown User",role:"Guest",email:e}}},{key:"recordFailedAttempt",value:function(e){var t=this.loginAttempts.get(e)||0;this.loginAttempts.set(e,t+1),this.logActivity(e,"login_failed"),t+1>=this.maxLoginAttempts&&this.logActivity(e,"account_locked")}},{key:"isLockedOut",value:function(e){return(this.loginAttempts.get(e)||0)>=this.maxLoginAttempts}},{key:"cleanupSessions",value:function(){var e,t=Date.now(),n=s(this.sessions.entries());try{for(n.s();!(e=n.n()).done;){var r=a(e.value,2),o=r[0];t-r[1].lastActivity>this.sessionTimeout&&this.sessions.delete(o)}}catch(e){n.e(e)}finally{n.f()}}},{key:"cleanupLoginAttempts",value:function(){var e,t=Date.now(),n=s(this.loginAttempts.entries());try{for(n.s();!(e=n.n()).done;){var r=a(e.value,2),o=r[0];r[1]>=this.maxLoginAttempts&&t-(this.loginAttempts.get(o+"_time")||0)>this.lockoutDuration&&(this.loginAttempts.delete(o),this.loginAttempts.delete(o+"_time"))}}catch(e){n.e(e)}finally{n.f()}}},{key:"logActivity",value:function(e,t){var n={username:e,action:t,timestamp:(new Date).toISOString(),ip:"client-side",userAgent:navigator.userAgent};try{var r=JSON.parse(localStorage.getItem("activityLog")||"[]");r.push(n),r.length>100&&r.splice(0,r.length-100),localStorage.setItem("activityLog",JSON.stringify(r))}catch(e){console.warn("Could not log activity:",e)}}},{key:"getActivityLog",value:function(){try{return JSON.parse(localStorage.getItem("activityLog")||"[]")}catch(e){return[]}}}],t&&p(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,i}();function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||b(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){if(e){if("string"==typeof e)return w(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,S(r.key),r)}}function S(e){var t=function(e){if("object"!=v(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==v(t)?t:t+""}var E=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.storagePrefix="table1837_",this.backupInterval=3e5,this.maxBackups=10,this.syncInterval=3e4,this.init()},t=[{key:"init",value:function(){var e=this;setInterval(function(){return e.createBackup()},this.backupInterval),setInterval(function(){return e.syncData()},this.syncInterval),this.checkDataIntegrity()}},{key:"saveData",value:function(e,t){try{var n=this.storagePrefix+e,r={data:t,timestamp:Date.now(),version:"1.0",checksum:this.calculateChecksum(t)};return localStorage.setItem(n,JSON.stringify(r)),this.createBackup(),!0}catch(e){return console.error("Failed to save data:",e),!1}}},{key:"loadData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{var n=this.storagePrefix+e,r=localStorage.getItem(n);if(!r)return t;var o=JSON.parse(r);return this.verifyDataIntegrity(o)?o.data:(console.warn("Data integrity check failed, attempting recovery..."),this.recoverData(e,t))}catch(n){return console.error("Failed to load data:",n),this.recoverData(e,t)}}},{key:"calculateChecksum",value:function(e){for(var t=JSON.stringify(e),n=0,r=0;r<t.length;r++)n=(n<<5)-n+t.charCodeAt(r),n&=n;return n.toString()}},{key:"verifyDataIntegrity",value:function(e){return!!(e&&e.data&&e.checksum)&&this.calculateChecksum(e.data)===e.checksum}},{key:"createBackup",value:function(){try{for(var e={timestamp:Date.now(),data:{}},t=0;t<localStorage.length;t++){var n=localStorage.key(t);n&&n.startsWith(this.storagePrefix)&&(e.data[n]=localStorage.getItem(n))}var r="backup_".concat(Date.now());localStorage.setItem(r,JSON.stringify(e)),this.cleanOldBackups(),console.log("Backup created successfully")}catch(e){console.error("Failed to create backup:",e)}}},{key:"cleanOldBackups",value:function(){for(var e=[],t=0;t<localStorage.length;t++){var n=localStorage.key(t);if(n&&n.startsWith("backup_"))try{var r=JSON.parse(localStorage.getItem(n));e.push({key:n,timestamp:r.timestamp})}catch(e){localStorage.removeItem(n)}}e.sort(function(e,t){return t.timestamp-e.timestamp});for(var o=this.maxBackups;o<e.length;o++)localStorage.removeItem(e[o].key)}},{key:"recoverData",value:function(e,t){try{var n,r=function(e){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=b(e))){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(a)throw o}}}}(this.getBackups());try{for(r.s();!(n=r.n()).done;){var o=n.value;if(o.data[this.storagePrefix+e]){var i=JSON.parse(o.data[this.storagePrefix+e]);if(this.verifyDataIntegrity(i))return console.log("Data recovered from backup"),i.data}}}catch(e){r.e(e)}finally{r.f()}return console.warn("No valid backup found, using default value"),t}catch(e){return console.error("Recovery failed:",e),t}}},{key:"getBackups",value:function(){for(var e=[],t=0;t<localStorage.length;t++){var n=localStorage.key(t);if(n&&n.startsWith("backup_"))try{var r=JSON.parse(localStorage.getItem(n));e.push(r)}catch(e){}}return e.sort(function(e,t){return t.timestamp-e.timestamp})}},{key:"checkDataIntegrity",value:function(){for(var e=0,t=["items86","inventoryData","ocrData","userPreferences"];e<t.length;e++){var n=t[e];null===this.loadData(n)&&(console.warn("Missing data for ".concat(n,", attempting recovery...")),this.recoverData(n,this.getDefaultValue(n)))}}},{key:"getDefaultValue",value:function(e){return{items86:[],inventoryData:{},ocrData:{redWine:null,whiteWine:null,starters:[],entrees:[],cocktail:null},userPreferences:{theme:"dark",notifications:!0,autoSave:!0}}[e]||null}},{key:"syncData",value:function(){for(var e={timestamp:Date.now(),data:{}},t=0;t<localStorage.length;t++){var n=localStorage.key(t);n&&n.startsWith(this.storagePrefix)&&(e.data[n]=localStorage.getItem(n))}localStorage.setItem("lastSync",JSON.stringify(e))}},{key:"exportData",value:function(){for(var e={},t=0;t<localStorage.length;t++){var n=localStorage.key(t);n&&n.startsWith(this.storagePrefix)&&(e[n]=localStorage.getItem(n))}return e}},{key:"importData",value:function(e){try{for(var t=0,n=Object.entries(e);t<n.length;t++){var r=g(n[t],2),o=r[0],i=r[1];o.startsWith(this.storagePrefix)&&localStorage.setItem(o,i)}return console.log("Data imported successfully"),!0}catch(e){return console.error("Failed to import data:",e),!1}}},{key:"clearAllData",value:function(){for(var e=[],t=0;t<localStorage.length;t++){var n=localStorage.key(t);n&&n.startsWith(this.storagePrefix)&&e.push(n)}for(var r=0,o=e;r<o.length;r++){var i=o[r];localStorage.removeItem(i)}console.log("All data cleared")}}],t&&k(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,L(r.key),r)}}function L(e){var t=function(e){if("object"!=x(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=x(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==x(t)?t:t+""}var T=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.validationRules=new Map,this.customValidators=new Map,this.init()},t=[{key:"init",value:function(){this.setupDefaultRules(),this.setupCustomValidators()}},{key:"setupDefaultRules",value:function(){this.validationRules.set("email",{pattern:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Please enter a valid email address"}),this.validationRules.set("password",{pattern:/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d@$!%*#?&]{8,}$/,message:"Password must be at least 8 characters with letters and numbers"}),this.validationRules.set("phone",{pattern:/^[\+]?[1-9][\d]{0,15}$/,message:"Please enter a valid phone number"}),this.validationRules.set("price",{pattern:/^\$?\d+(\.\d{2})?$/,message:"Please enter a valid price (e.g., $10.50 or 10.50)"}),this.validationRules.set("wineName",{pattern:/^[A-Za-z0-9\s\-\.\,\&\'\(\)]+$/,message:"Wine name contains invalid characters"}),this.validationRules.set("year",{pattern:/^(19|20)\d{2}$/,message:"Please enter a valid year between 1900 and 2099"}),this.validationRules.set("text",{pattern:/^[A-Za-z0-9\s\-\.\,\&\'\(\)\?\!]+$/,message:"Text contains invalid characters"})}},{key:"setupCustomValidators",value:function(){var e=this;this.customValidators.set("wineData",function(t){var n=[];return(!t.name||t.name.trim().length<2)&&n.push("Wine name is required and must be at least 2 characters"),t.price&&!e.validate("price",t.price)&&n.push("Invalid price format"),t.year&&!e.validate("year",t.year.toString())&&n.push("Invalid year format"),{isValid:0===n.length,errors:n}}),this.customValidators.set("inventoryItem",function(e){var t=[];return(!e.name||e.name.trim().length<2)&&t.push("Item name is required and must be at least 2 characters"),e.category&&!["vodka","gin","rum","tequila","whiskey","cordials"].includes(e.category)&&t.push("Invalid category"),{isValid:0===t.length,errors:t}}),this.customValidators.set("ocrData",function(t){var n=[];return t.redWine&&!e.validate("wineData",t.redWine).isValid&&n.push("Invalid red wine data"),t.whiteWine&&!e.validate("wineData",t.whiteWine).isValid&&n.push("Invalid white wine data"),t.starters&&!Array.isArray(t.starters)&&n.push("Starters must be an array"),t.entrees&&!Array.isArray(t.entrees)&&n.push("Entrees must be an array"),{isValid:0===n.length,errors:n}})}},{key:"validate",value:function(e,t){if(!t)return{isValid:!1,error:"Value is required"};var n=this.validationRules.get(e);if(!n)return{isValid:!0,error:null};var r=n.pattern.test(t);return{isValid:r,error:r?null:n.message}}},{key:"validateCustom",value:function(e,t){var n=this.customValidators.get(e);return n?n(t):{isValid:!0,errors:[]}}},{key:"sanitizeInput",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";if("string"!=typeof e)return"";var n=e.trim();switch(n=n.replace(/[<>]/g,"").replace(/javascript:/gi,"").replace(/on\w+\s*=/gi,"").replace(/eval\s*\(/gi,"").replace(/document\./gi,"").replace(/window\./gi,""),t){case"email":n=n.toLowerCase();break;case"price":n=n.replace(/[^\d\.\$]/g,"");break;case"year":n=n.replace(/[^\d]/g,"");break;case"phone":n=n.replace(/[^\d\+\-\(\)\s]/g,"")}return n}},{key:"validateForm",value:function(e){for(var t={},n={},r=0,o=Object.entries(e);r<o.length;r++){var i=O(o[r],2),a=i[0],s=i[1],c=this.sanitizeInput(s,this.getFieldType(a));n[a]=c;var l=this.validate(this.getFieldType(a),c);l.isValid||(t[a]=l.error)}return{isValid:0===Object.keys(t).length,errors:t,sanitizedData:n}}},{key:"getFieldType",value:function(e){return{email:"email",username:"email",password:"password",phone:"phone",price:"price",year:"year",wineName:"wineName",name:"text",description:"text"}[e]||"text"}},{key:"validateWineData",value:function(e){return this.validateCustom("wineData",e)}},{key:"validateInventoryItem",value:function(e){return this.validateCustom("inventoryItem",e)}},{key:"validateOCRData",value:function(e){return this.validateCustom("ocrData",e)}},{key:"setupRealTimeValidation",value:function(e){var t=this;e.querySelectorAll("input, textarea, select").forEach(function(e){e.addEventListener("blur",function(){t.validateField(e)}),e.addEventListener("input",function(){t.clearFieldError(e)})})}},{key:"validateField",value:function(e){var t=this.getFieldType(e.name),n=e.value,r=this.validate(t,n);return r.isValid?this.clearFieldError(e):this.showFieldError(e,r.error),r.isValid}},{key:"showFieldError",value:function(e,t){this.clearFieldError(e);var n=document.createElement("div");n.className="field-error text-red-500 text-sm mt-1",n.textContent=t,e.parentNode.appendChild(n),e.classList.add("border-red-500")}},{key:"clearFieldError",value:function(e){var t=e.parentNode.querySelector(".field-error");t&&t.remove(),e.classList.remove("border-red-500")}},{key:"validateBatch",value:function(e){for(var t={},n=!0,r=0,o=Object.entries(e);r<o.length;r++){var i=O(o[r],2),a=i[0],s=i[1],c=this.getFieldType(a),l=this.validate(c,s);t[a]=l,l.isValid||(n=!1)}return{allValid:n,results:t}}}],t&&I(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach(function(t){D(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function D(e,t,n){return(t=F(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return W(l,"_invoke",function(n,r,o){var i,s,c,l=0,u=o||[],f=!1,d={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,s=0,c=e,d.n=n,a}};function h(n,r){for(s=n,c=r,t=0;!f&&l&&!o&&t<u.length;t++){var o,i=u[t],h=d.p,p=i[2];n>3?(o=p===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(s=0,d.v=r,d.n=i[1]):h<p&&(o=n<3||i[0]>r||r>p)&&(i[4]=n,i[5]=r,d.n=p,s=0))}if(o||n>1)return a;throw f=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&h(u,p),s=u,c=p;(t=s<2?e:c)||!f;){i||(s?s<3?(s>1&&(d.n=-1),h(s,c)):d.n=c:d.v=c);try{if(l=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(f=d.n<0)?c:n.call(r,d))!==a)break}catch(t){i=e,s=1,c=t}finally{l=1}}return{value:t,done:f}}}(n,o,i),!0),l}var a={};function s(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(W(t={},r,function(){return this}),t),f=l.prototype=s.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,W(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=l,W(f,"constructor",l),W(l,"constructor",c),c.displayName="GeneratorFunction",W(l,o,"GeneratorFunction"),W(f),W(f,o,"Generator"),W(f,r,function(){return this}),W(f,"toString",function(){return"[object Generator]"}),(R=function(){return{w:i,m:d}})()}function W(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}W=function(e,t,n,r){function i(t,n){W(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},W(e,t,n,r)}function M(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,F(r.key),r)}}function F(e){var t=function(e){if("object"!=C(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==C(t)?t:t+""}var z=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metrics={loadTime:0,renderTime:0,memoryUsage:0,errors:[]},this.startTime=performance.now(),this.init()},t=[{key:"init",value:function(){var e=this;window.addEventListener("load",function(){e.metrics.loadTime=performance.now()-e.startTime,console.log(" Page loaded in ".concat(e.metrics.loadTime.toFixed(2),"ms")),window.gtag&&window.gtag("event","page_load_time",{value:Math.round(e.metrics.loadTime)})}),"memory"in performance&&setInterval(function(){e.metrics.memoryUsage=performance.memory.usedJSHeapSize/1024/1024,e.metrics.memoryUsage>100&&console.warn(" High memory usage:",e.metrics.memoryUsage.toFixed(2),"MB")},5e3),window.addEventListener("error",function(t){e.metrics.errors.push({message:t.message,filename:t.filename,lineno:t.lineno,timestamp:Date.now()}),console.error(" Error tracked:",t.message)}),this.trackModuleLoads()}},{key:"trackModuleLoads",value:function(){var e,t=this,n=null===(e=this.app)||void 0===e?void 0:e.loadModule;n&&(this.app.loadModule=function(){var e,r=(e=R().m(function e(r){var o,i,a;return R().w(function(e){for(;;)switch(e.n){case 0:return o=performance.now(),e.n=1,n.call(t.app,r);case 1:return i=e.v,a=performance.now()-o,console.log(" Module ".concat(r," loaded in ").concat(a.toFixed(2),"ms")),e.a(2,i)}},e)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){M(i,r,o,a,s,"next",e)}function s(e){M(i,r,o,a,s,"throw",e)}a(void 0)})});return function(e){return r.apply(this,arguments)}}())}},{key:"getMetrics",value:function(){return A(A({},this.metrics),{},{timestamp:Date.now()})}},{key:"logPerformance",value:function(){console.log(" Performance Metrics:",this.getMetrics())}}],t&&B(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach(function(t){G(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function G(e,t,n){return(t=$(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$(r.key),r)}}function $(e){var t=function(e){if("object"!=N(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=N(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==N(t)?t:t+""}var J=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metrics={loadTime:0,renderTime:0,memoryUsage:0,errors:[],moduleLoadTimes:{},ocrProcessingTimes:[],userInteractions:[]},this.startTime=performance.now(),this.init()},t=[{key:"init",value:function(){var e=this;window.addEventListener("load",function(){e.metrics.loadTime=performance.now()-e.startTime,console.log(" Page loaded in ".concat(e.metrics.loadTime.toFixed(2),"ms")),e.reportMetric("page_load_time",e.metrics.loadTime)}),"memory"in performance&&setInterval(function(){e.metrics.memoryUsage=performance.memory.usedJSHeapSize/1024/1024,e.metrics.memoryUsage>100&&(console.warn(" High memory usage:",e.metrics.memoryUsage.toFixed(2),"MB"),e.reportMetric("high_memory_usage",e.metrics.memoryUsage))},1e4),"PerformanceObserver"in window&&new PerformanceObserver(function(t){var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return V(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?V(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(t.getEntries());try{for(r.s();!(n=r.n()).done;){var o=n.value;o.duration>50&&(console.warn(" Long task detected:",o.duration.toFixed(2),"ms"),e.reportMetric("long_task",o.duration))}}catch(e){r.e(e)}finally{r.f()}}).observe({entryTypes:["longtask"]}),window.addEventListener("error",function(t){e.metrics.errors.push({message:t.message,filename:t.filename,lineno:t.lineno,timestamp:Date.now()}),console.error(" Error tracked:",t.message),e.reportMetric("error",{message:t.message,filename:t.filename})}),this.trackUserInteractions()}},{key:"trackUserInteractions",value:function(){var e=this;["click","input","scroll","keydown"].forEach(function(t){document.addEventListener(t,function(n){e.metrics.userInteractions.push({type:t,target:n.target.tagName,timestamp:Date.now()})},{passive:!0})})}},{key:"trackModuleLoad",value:function(e,t){this.metrics.moduleLoadTimes[e]=t,console.log(" Module ".concat(e," loaded in ").concat(t.toFixed(2),"ms")),this.reportMetric("module_load_time",{module:e,time:t})}},{key:"trackOCRProcessing",value:function(e,t){this.metrics.ocrProcessingTimes.push({time:e,confidence:t,timestamp:Date.now()}),this.reportMetric("ocr_processing_time",{time:e,confidence:t})}},{key:"reportMetric",value:function(e,t){window.gtag&&window.gtag("event",e,{value:t});var n=JSON.parse(localStorage.getItem("performance_metrics")||"{}");n[e]=t,localStorage.setItem("performance_metrics",JSON.stringify(n))}},{key:"getMetrics",value:function(){return U(U({},this.metrics),{},{timestamp:Date.now(),averageOCRTime:this.calculateAverageOCRTime(),averageModuleLoadTime:this.calculateAverageModuleLoadTime()})}},{key:"calculateAverageOCRTime",value:function(){return 0===this.metrics.ocrProcessingTimes.length?0:this.metrics.ocrProcessingTimes.reduce(function(e,t){return e+t.time},0)/this.metrics.ocrProcessingTimes.length}},{key:"calculateAverageModuleLoadTime",value:function(){var e=Object.values(this.metrics.moduleLoadTimes);return 0===e.length?0:e.reduce(function(e,t){return e+t},0)/e.length}},{key:"generateReport",value:function(){var e=this.getMetrics();return{summary:{totalErrors:e.errors.length,averageOCRTime:e.averageOCRTime.toFixed(2)+"ms",averageModuleLoadTime:e.averageModuleLoadTime.toFixed(2)+"ms",memoryUsage:e.memoryUsage.toFixed(2)+"MB",userInteractions:e.userInteractions.length},details:e}}},{key:"logPerformance",value:function(){console.log(" Performance Report:",this.generateReport())}}],t&&H(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Y(r.key),r)}}function Y(e){var t=function(e){if("object"!=q(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==q(t)?t:t+""}var Z=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.searchIndex=new Map,this.buildIndex(),this.debounceTimer=null,this.lastQuery=""},t=[{key:"buildIndex",value:function(){var e=this;this.getAllWines().forEach(function(t,n){e.generateSearchTerms(t).forEach(function(t){e.searchIndex.has(t)||e.searchIndex.set(t,[]),e.searchIndex.get(t).push(n)})})}},{key:"generateSearchTerms",value:function(e){var t=[],n="".concat(e.name," ").concat(e.region," ").concat(e.year," ").concat(e.category).toLowerCase();t.push(n),n.split(" ").forEach(function(e){e.length>2&&t.push(e)});for(var r=0;r<n.length-2;r++)t.push(n.substring(r,r+3));return t}},{key:"debounceSearch",value:function(e,t){var n=this;return function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];clearTimeout(n.debounceTimer),n.debounceTimer=setTimeout(function(){return e.apply(n,o)},t)}}},{key:"search",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||e.length<2)return[];if(e===this.lastQuery)return this.lastResults||[];this.lastQuery=e;var r=new Set;this.generateSearchTerms({name:e}).forEach(function(e){(t.searchIndex.get(e)||[]).forEach(function(e){return r.add(e)})});var o=Array.from(r).map(function(e){return t.getAllWines()[e]});return n.category&&(o=o.filter(function(e){return e.category.toLowerCase()===n.category.toLowerCase()})),n.priceRange&&(o=o.filter(function(e){return e.price>=n.priceRange.min&&e.price<=n.priceRange.max})),this.lastResults=o.slice(0,20),this.lastResults}},{key:"getAllWines",value:function(){return[{name:"CRISTOM, EILEEN VYD., PINOT NOIR",region:"Eola-Amity Hills",year:"2019",category:"red",price:185},{name:"NEYERS, CARNEROS CHARDONNAY",region:"Sonoma County",year:"2019",category:"white",price:100}]}}],t&&K(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ee(r.key),r)}}function ee(e){var t=function(e){if("object"!=Q(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Q(t)?t:t+""}var te=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentTheme=localStorage.getItem("table1837-theme")||"dark",this.init()},(t=[{key:"init",value:function(){this.applyTheme(this.currentTheme),this.setupThemeToggle()}},{key:"applyTheme",value:function(e){document.body.setAttribute("data-theme",e),document.documentElement.setAttribute("data-theme",e),localStorage.setItem("table1837-theme",e),this.currentTheme=e;var t=document.documentElement;"light"===e?(t.style.setProperty("--bg-primary","#ffffff"),t.style.setProperty("--text-primary","#1a1a1a"),t.style.setProperty("--glass-bg","rgba(255, 255, 255, 0.1)")):(t.style.setProperty("--bg-primary","#000000"),t.style.setProperty("--text-primary","#ffffff"),t.style.setProperty("--glass-bg","rgba(0, 0, 0, 0.3)"))}},{key:"setupThemeToggle",value:function(){var e=this,t=document.querySelector("header");if(t){var n=document.createElement("button");n.innerHTML="dark"===this.currentTheme?"":"",n.className="theme-toggle ml-4 p-2 rounded-lg bg-opacity-20 hover:bg-opacity-30 transition-all",n.onclick=function(){return e.toggleTheme()},t.querySelector(".container").appendChild(n)}}},{key:"toggleTheme",value:function(){var e="dark"===this.currentTheme?"light":"dark";this.applyTheme(e);var t=document.querySelector(".theme-toggle");t&&(t.innerHTML="dark"===e?"":""),this.showThemeNotification(e)}},{key:"showThemeNotification",value:function(e){var t=document.createElement("div");t.className="fixed top-4 right-4 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg z-50",t.textContent="Switched to ".concat(e," theme"),document.body.appendChild(t),setTimeout(function(){t.remove()},2e3)}}])&&X(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function ne(e){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ne(e)}function re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,oe(r.key),r)}}function oe(e){var t=function(e){if("object"!=ne(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ne(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ne(t)?t:t+""}var ie=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.app=t,this.state=t.state,this.elements=t.elements},(t=[{key:"initialize",value:function(){this.updateTodaySpecial(),this.load86Items()}},{key:"updateTodaySpecial",value:function(){var e={0:{title:"Sunday Steak Night",time:"4p  8p",description:"Garden Salad  Steak Frites  Glass of House Wine",price:"$40"},3:{title:"Date Night",time:"4p  8p",description:"2-Dine for $89  3-Course Menu  $5 Draft Beer  $10 House Wine",price:"$89"},4:{title:"1837 Bar & Burger Night",time:"4p  8p",description:"$12.50 Signature Burger OR Crispy Chicken  $5 Draft Beer  $10 House Wine",price:"$12.50"},5:{title:"Late Night Happy Hour",time:"8p  11p",description:"$5 Draft Beer  $10 House Wines  $10 House Winner Cocktails  $2 Off Curated Cocktails",price:"Various"},6:{title:"Late Night Happy Hour",time:"8p  11p",description:"$5 Draft Beer  $10 House Wines  $10 House Winner Cocktails  $2 Off Curated Cocktails",price:"Various"}}[(new Date).getDay()],t=document.getElementById("todaySpecial");t&&(t.innerHTML=e?'\n                <div class="flex justify-between items-start mb-3">\n                    <h4 class="text-xl font-bold">'.concat(e.title,'</h4>\n                    <span class="text-lg font-bold text-yellow-400">').concat(e.price,'</span>\n                </div>\n                <p class="text-sm text-gray-400 mb-2">').concat(e.time,'</p>\n                <p class="text-gray-300">').concat(e.description,"</p>\n            "):'\n                <p class="text-gray-300">No special offerings today. Check back tomorrow!</p>\n            ')}},{key:"load86Items",value:function(){var e=document.getElementById("alert86List");e&&(0!==this.state.items86.length?e.innerHTML=this.state.items86.map(function(e){return'\n            <div class="mb-2">\n                <span class="font-semibold text-red-300">'.concat(e.name,'</span>\n                <span class="text-sm text-gray-400 ml-2">- ').concat(e.timestamp,"</span>\n            </div>\n        ")}).join(""):e.innerHTML='<p class="text-gray-300">No items currently 86\'d</p>')}}])&&re(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function ae(e){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ae(e)}function se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ce(r.key),r)}}function ce(e){var t=function(e){if("object"!=ae(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ae(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ae(t)?t:t+""}var le=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.app=t,this.state=t.state,this.elements=t.elements},t=[{key:"initialize",value:function(){var e=this;this.display86Items(),this.setupEventListeners(),window.add86Item=function(){return e.add86Item()},window.remove86Item=function(t){return e.remove86Item(t)}}},{key:"setupEventListeners",value:function(){var e=this,t=document.getElementById("item86Input");t&&t.addEventListener("keypress",function(t){"Enter"===t.key&&(t.preventDefault(),e.add86Item())})}},{key:"add86Item",value:function(){var e=document.getElementById("item86Input"),t=e.value.trim();t&&(this.state.items86.push({name:t,timestamp:(new Date).toLocaleString(),addedBy:"Current User"}),localStorage.setItem("items86",JSON.stringify(this.state.items86)),e.value="",this.display86Items(),this.load86Items())}},{key:"remove86Item",value:function(e){this.state.items86.splice(e,1),localStorage.setItem("items86",JSON.stringify(this.state.items86)),this.display86Items(),this.load86Items()}},{key:"display86Items",value:function(){var e=document.getElementById("current86Items");e&&(0!==this.state.items86.length?e.innerHTML=this.state.items86.map(function(e,t){return'\n            <div class="flex justify-between items-center p-3 bg-red-900 bg-opacity-30 border border-red-600 rounded-lg">\n                <div>\n                    <p class="font-semibold">'.concat(e.name,'</p>\n                    <p class="text-sm text-gray-400">Added: ').concat(e.timestamp,'</p>\n                </div>\n                <button onclick="remove86Item(').concat(t,')" class="text-red-400 hover:text-red-300">\n                    <i class="fas fa-times"></i>\n                </button>\n            </div>\n        ')}).join(""):e.innerHTML='<p class="text-gray-400">No items currently 86\'d</p>')}},{key:"load86Items",value:function(){var e=document.getElementById("alert86List");e&&(0!==this.state.items86.length?e.innerHTML=this.state.items86.map(function(e){return'\n            <div class="mb-2">\n                <span class="font-semibold text-red-300">'.concat(e.name,'</span>\n                <span class="text-sm text-gray-400 ml-2">- ').concat(e.timestamp,"</span>\n            </div>\n        ")}).join(""):e.innerHTML='<p class="text-gray-300">No items currently 86\'d</p>')}},{key:"cleanup",value:function(){delete window.add86Item,delete window.remove86Item}}],t&&se(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),ue=n(995);function fe(e){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fe(e)}function de(e){return function(e){if(Array.isArray(e))return be(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ge(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function he(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||ge(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach(function(t){ye(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ye(e,t,n){return(t=Oe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ve(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ge(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function ge(e,t){if(e){if("string"==typeof e)return be(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?be(e,t):void 0}}function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function we(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return ke(l,"_invoke",function(n,r,o){var i,s,c,l=0,u=o||[],f=!1,d={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,s=0,c=e,d.n=n,a}};function h(n,r){for(s=n,c=r,t=0;!f&&l&&!o&&t<u.length;t++){var o,i=u[t],h=d.p,p=i[2];n>3?(o=p===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(s=0,d.v=r,d.n=i[1]):h<p&&(o=n<3||i[0]>r||r>p)&&(i[4]=n,i[5]=r,d.n=p,s=0))}if(o||n>1)return a;throw f=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&h(u,p),s=u,c=p;(t=s<2?e:c)||!f;){i||(s?s<3?(s>1&&(d.n=-1),h(s,c)):d.n=c:d.v=c);try{if(l=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(f=d.n<0)?c:n.call(r,d))!==a)break}catch(t){i=e,s=1,c=t}finally{l=1}}return{value:t,done:f}}}(n,o,i),!0),l}var a={};function s(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(ke(t={},r,function(){return this}),t),f=l.prototype=s.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,ke(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=l,ke(f,"constructor",l),ke(l,"constructor",c),c.displayName="GeneratorFunction",ke(l,o,"GeneratorFunction"),ke(f),ke(f,o,"Generator"),ke(f,r,function(){return this}),ke(f,"toString",function(){return"[object Generator]"}),(we=function(){return{w:i,m:d}})()}function ke(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}ke=function(e,t,n,r){function i(t,n){ke(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},ke(e,t,n,r)}function Se(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Ee(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){Se(i,r,o,a,s,"next",e)}function s(e){Se(i,r,o,a,s,"throw",e)}a(void 0)})}}function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Oe(r.key),r)}}function Oe(e){var t=function(e){if("object"!=fe(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==fe(t)?t:t+""}var Pe=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.workers=[],this.isInitialized=!1,this.progressCallback=null,this.retryCount=0,this.maxRetries=3,this.confidenceThreshold=.97,this.textCorrectionModel=null,this.cache=new Map,this.cacheTimeout=3e5},t=[{key:"initialize",value:(p=Ee(we().m(function e(){var t,n,r,o,i,a=this;return we().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!this.isInitialized){e.n=1;break}return e.a(2);case 1:e.p=1,this.updateProgress(0,"Initializing multi-engine OCR..."),t=[{lang:"eng",psm:6,oem:3},{lang:"eng",psm:8,oem:1},{lang:"eng",psm:3,oem:3}],n=0;case 2:if(!(n<t.length)){e.n=6;break}return r=t[n],this.updateProgress(20*(n+1),"Initializing OCR engine ".concat(n+1,"...")),e.n=3,(0,ue.createWorker)(r.lang,1,{logger:function(e){a.progressCallback&&a.progressCallback(e)}});case 3:return o=e.v,e.n=4,o.setParameters({tessedit_char_whitelist:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789$.,()-/&'",tessedit_pageseg_mode:r.psm.toString(),tessedit_ocr_engine_mode:r.oem.toString(),preserve_interword_spaces:"1",textord_heavy_nr:"1",textord_min_linesize:"2.5"});case 4:this.workers.push(o);case 5:n++,e.n=2;break;case 6:return e.n=7,this.initializeTextCorrection();case 7:this.isInitialized=!0,this.updateProgress(100,"Ultra-enhanced OCR ready"),console.log(" Ultra-Enhanced OCR Service initialized successfully"),e.n=9;break;case 8:throw e.p=8,i=e.v,console.error(" Failed to initialize ultra-enhanced OCR service:",i),i;case 9:return e.a(2)}},e,this,[[1,8]])})),function(){return p.apply(this,arguments)})},{key:"initializeTextCorrection",value:(h=Ee(we().m(function e(){return we().w(function(e){for(;;)switch(e.n){case 0:this.wineVocabulary={red:["Pinot Noir","Merlot","Cabernet Sauvignon","Syrah","Zinfandel","Malbec","Sangiovese","Nebbiolo"],white:["Chardonnay","Sauvignon Blanc","Riesling","Pinot Grigio","Gewrztraminer","Viognier","Semillon"],regions:["Napa Valley","Sonoma","Bordeaux","Burgundy","Tuscany","Piedmont","Champagne","Alsace"]},this.foodVocabulary={starters:["Charcuterie","Scallops","Tartare","Salad","Soup","Cheese","Mushroom","Truffle"],entrees:["Duck","Salmon","Beef","Lamb","Pork","Chicken","Risotto","Pasta","Fish"],cooking:["Seared","Pan-Seared","Grilled","Roasted","Braised","Confit","Sous Vide"]};case 1:return e.a(2)}},e,this)})),function(){return h.apply(this,arguments)})},{key:"processImage",value:(d=Ee(we().m(function e(t){var n,r,o,i,a,s,c,l;return we().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,this.generateCacheKey(t);case 1:if(n=e.v,!this.cache.has(n)){e.n=2;break}if(r=this.cache.get(n),!(Date.now()-r.timestamp<this.cacheTimeout)){e.n=2;break}return console.log(" Returning cached OCR result"),this.updateProgress(100,"Returning cached result..."),e.a(2,r.result);case 2:if(this.isInitialized){e.n=3;break}return e.n=3,this.initialize();case 3:return e.p=3,this.updateProgress(10,"Advanced image preprocessing..."),e.n=4,this.createMultiplePreprocessedVersions(t);case 4:return o=e.v,this.updateProgress(30,"Multi-engine text extraction..."),e.n=5,this.extractTextWithMultipleEngines(o);case 5:return i=e.v,this.updateProgress(60,"AI-powered text correction..."),e.n=6,this.correctTextWithAI(i);case 6:return a=e.v,this.updateProgress(80,"Advanced menu parsing..."),e.n=7,this.parseMenuWithAdvancedAlgorithms(a);case 7:return s=e.v,this.updateProgress(95,"Validation and confidence scoring..."),e.n=8,this.validateAndScoreResults(s);case 8:return c=e.v,this.updateProgress(100,"Processing complete!"),this.cache.set(n,{result:c,timestamp:Date.now()}),e.a(2,c);case 9:return e.p=9,l=e.v,console.error("Ultra-enhanced OCR processing failed:",l),e.n=10,this.handleProcessingError(t,l);case 10:return e.a(2,e.v)}},e,this,[[3,9]])})),function(e){return d.apply(this,arguments)})},{key:"createMultiplePreprocessedVersions",value:(f=Ee(we().m(function e(t){var n,r,o,i,a,s,c;return we().w(function(e){for(;;)switch(e.n){case 0:return r=n=[],e.n=1,this.preprocessImage(t,{contrast:2,brightness:.8,threshold:128,denoise:!0});case 1:return o=e.v,r.push.call(r,o),i=n,e.n=2,this.preprocessImage(t,{contrast:1.5,brightness:1.2,edgeEnhancement:!0,threshold:150});case 2:return a=e.v,i.push.call(i,a),s=n,e.n=3,this.preprocessImage(t,{contrast:1.8,brightness:1,adaptiveThreshold:!0});case 3:return c=e.v,s.push.call(s,c),e.a(2,n)}},e,this)})),function(e){return f.apply(this,arguments)})},{key:"preprocessImage",value:(u=Ee(we().m(function e(t){var n,r=this,o=arguments;return we().w(function(e){for(;;)if(0===e.n)return n=o.length>1&&void 0!==o[1]?o[1]:{},e.a(2,new Promise(function(e){var o=document.createElement("canvas"),i=o.getContext("2d"),a=new Image;a.onload=function(){o.width=a.width,o.height=a.height,i.drawImage(a,0,0);var t=i.getImageData(0,0,o.width,o.height),s=t.data;n.denoise&&r.applyDenoising(s,o.width,o.height),n.edgeEnhancement&&r.applyEdgeEnhancement(s,o.width,o.height);for(var c=0;c<s.length;c+=4){var l=.299*s[c]+.587*s[c+1]+.114*s[c+2];n.contrast&&(l=(l-128)*n.contrast+128),n.brightness&&(l*=n.brightness);var u=n.threshold||128;n.adaptiveThreshold&&(u=r.calculateAdaptiveThreshold(s,c,o.width,o.height));var f=l>u?255:0;s[c]=f,s[c+1]=f,s[c+2]=f,s[c+3]=255}i.putImageData(t,0,0),o.toBlob(function(t){e(t)},"image/png")},a.src=URL.createObjectURL(t)}))},e)})),function(e){return u.apply(this,arguments)})},{key:"applyDenoising",value:function(e,t,n){for(var r=new Uint8ClampedArray(e),o=1;o<n-1;o++)for(var i=1;i<t-1;i++){for(var a=4*(o*t+i),s=[],c=-1;c<=1;c++)for(var l=-1;l<=1;l++){var u=4*((o+c)*t+(i+l));s.push(r[u])}s.sort(function(e,t){return e-t});var f=s[Math.floor(s.length/2)];e[a]=f,e[a+1]=f,e[a+2]=f}}},{key:"applyEdgeEnhancement",value:function(e,t,n){for(var r=new Uint8ClampedArray(e),o=1;o<n-1;o++)for(var i=1;i<t-1;i++){var a=4*(o*t+i),s=r[a],c=4*s-[r[4*((o-1)*t+i)],r[4*(o*t+(i-1))],r[4*(o*t+(i+1))],r[4*((o+1)*t+i)]].reduce(function(e,t){return e+t},0),l=Math.min(255,Math.max(0,s+.5*c));e[a]=l,e[a+1]=l,e[a+2]=l}}},{key:"calculateAdaptiveThreshold",value:function(e,t,n,r){for(var o=t/4%n,i=Math.floor(t/4/n),a=0,s=0,c=-15;c<=15;c++)for(var l=-15;l<=15;l++){var u=o+l,f=i+c;u>=0&&u<n&&f>=0&&f<r&&(a+=e[4*(f*n+u)],s++)}return a/s*.8}},{key:"extractTextWithMultipleEngines",value:(l=Ee(we().m(function e(t){var n,r,o,i,a,s,c,l;return we().w(function(e){for(;;)switch(e.p=e.n){case 0:n=[],r=0;case 1:if(!(r<this.workers.length)){e.n=8;break}o=0;case 2:if(!(o<t.length)){e.n=7;break}return e.p=3,e.n=4,this.workers[r].recognize(t[o]);case 4:i=e.v,a=i.data,s=a.text,c=a.confidence,n.push({text:s,confidence:c,engine:r,version:o}),e.n=6;break;case 5:e.p=5,l=e.v,console.warn("Engine ".concat(r,", version ").concat(o," failed:"),l);case 6:o++,e.n=2;break;case 7:r++,e.n=1;break;case 8:return e.a(2,n)}},e,this,[[3,5]])})),function(e){return l.apply(this,arguments)})},{key:"correctTextWithAI",value:(c=Ee(we().m(function e(t){var n,r,o,i,a,s;return we().w(function(e){for(;;)switch(e.p=e.n){case 0:n=[],r=ve(t),e.p=1,r.s();case 2:if((o=r.n()).done){e.n=5;break}return i=o.value,e.n=3,this.applyTextCorrection(i.text);case 3:a=e.v,n.push(me(me({},i),{},{correctedText:a,originalText:i.text}));case 4:e.n=2;break;case 5:e.n=7;break;case 6:e.p=6,s=e.v,r.e(s);case 7:return e.p=7,r.f(),e.f(7);case 8:return e.a(2,n)}},e,this,[[1,6,7,8]])})),function(e){return c.apply(this,arguments)})},{key:"applyTextCorrection",value:(s=Ee(we().m(function e(t){var n,r,o,i,a,s,c,l,u,f,d,h,p,m,y,v,g,b,w,k,S,E,x;return we().w(function(e){for(;;)if(0===e.n){for(n=t,r=0,o=["red","white"];r<o.length;r++){i=o[r],a=ve(this.wineVocabulary[i]);try{for(a.s();!(s=a.n()).done;)c=s.value,l=new RegExp(this.createFuzzyPattern(c),"gi"),n=n.replace(l,c)}catch(e){a.e(e)}finally{a.f()}}u=ve(this.wineVocabulary.regions);try{for(u.s();!(f=u.n()).done;)d=f.value,h=new RegExp(this.createFuzzyPattern(d),"gi"),n=n.replace(h,d)}catch(e){u.e(e)}finally{u.f()}for(p=0,m=["starters","entrees"];p<m.length;p++){y=m[p],v=ve(this.foodVocabulary[y]);try{for(v.s();!(g=v.n()).done;)b=g.value,w=new RegExp(this.createFuzzyPattern(b),"gi"),n=n.replace(w,b)}catch(e){v.e(e)}finally{v.f()}}k=ve(this.foodVocabulary.cooking);try{for(k.s();!(S=k.n()).done;)E=S.value,x=new RegExp(this.createFuzzyPattern(E),"gi"),n=n.replace(x,E)}catch(e){k.e(e)}finally{k.f()}return e.a(2,n)}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"createFuzzyPattern",value:function(e){return e.split("").map(function(e){return{0:"[0O]",O:"[0O]",1:"[1Il]",I:"[1Il]",l:"[1Il]",5:"[5S]",S:"[5S]",8:"[8B]",B:"[8B]",a:"[a@]","@":"[a@]",e:"[e3]",3:"[e3]"}[e.toLowerCase()]||e}).join("")}},{key:"parseMenuWithAdvancedAlgorithms",value:(a=Ee(we().m(function e(t){var n,r,o,i,a,s,c,l,u;return we().w(function(e){for(;;)if(0===e.n){for(n=t.map(function(e){return e.correctedText}).join("\n"),r=[this.parseWithAdvancedSectionDetection,this.parseWithMachineLearning,this.parseWithSemanticAnalysis],o=null,i=0,a=0,s=r;a<s.length;a++){c=s[a];try{l=c.call(this,n),(u=this.calculateAdvancedConfidenceScore(l,t))>i&&(i=u,o=me(me({},l),{},{confidence:u}))}catch(e){console.warn("Advanced parsing strategy failed:",e)}}return e.a(2,o||this.createFallbackResult())}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"parseWithAdvancedSectionDetection",value:function(e){var t,n=e.split("\n").filter(function(e){return e.trim()}),r=this.initializeResultStructure(),o=null,i=.9,a=ve(n);try{for(a.s();!(t=a.n()).done;){var s=t.value.trim();if(s){var c=this.detectSectionWithConfidence(s);c.section&&c.confidence>.8?(o=c.section,i=c.confidence):this.parseLineWithAdvancedContext(s,o,r,i)}}}catch(e){a.e(e)}finally{a.f()}return r}},{key:"detectSectionWithConfidence",value:function(e){for(var t=0,n=Object.entries({redWine:{patterns:[/(red\s+wine|pinot\s+noir|merlot|cabernet|syrah|zinfandel)/i],keywords:["red","wine","pinot","merlot","cabernet"],confidence:.9},whiteWine:{patterns:[/(white\s+wine|chardonnay|sauvignon|riesling|pinot\s+grigio)/i],keywords:["white","wine","chardonnay","sauvignon","riesling"],confidence:.9},starters:{patterns:[/(starters?|appetizers?|hors\s+d'oeuvres?)/i],keywords:["starter","appetizer","hors"],confidence:.85},entrees:{patterns:[/(entrees?|main\s+courses?|dishes?)/i],keywords:["entree","main","course","dish"],confidence:.85}});t<n.length;t++){var r,o=he(n[t],2),i=o[0],a=o[1],s=ve(a.patterns);try{for(s.s();!(r=s.n()).done;)if(r.value.test(e))return{section:i,confidence:a.confidence}}catch(e){s.e(e)}finally{s.f()}var c=a.keywords.filter(function(t){return e.toLowerCase().includes(t)}).length;if(c>0)return{section:i,confidence:a.confidence*(c/a.keywords.length)}}return{section:null,confidence:0}}},{key:"parseLineWithAdvancedContext",value:function(e,t,n,r){var o=(r+this.calculateLineConfidence(e))/2;if(!(o<.7))switch(t){case"redWine":!n.redWine&&this.isWineLine(e)&&(n.redWine=this.parseWineLineWithConfidence(e,o));break;case"whiteWine":!n.whiteWine&&this.isWineLine(e)&&(n.whiteWine=this.parseWineLineWithConfidence(e,o));break;case"starters":this.isFoodLine(e)&&(n.starters=n.starters||[],n.starters.push({name:this.cleanFoodText(e),confidence:o}));break;case"entrees":this.isFoodLine(e)&&(n.entrees=n.entrees||[],n.entrees.push({name:this.cleanFoodText(e),confidence:o}))}}},{key:"parseWithMachineLearning",value:function(e){for(var t=this.initializeResultStructure(),n=0,r=[/([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*),\s*([^,]+),\s*(\d{4})\s*\$(\d+)/g,/([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)\s*\$(\d+)/g];n<r.length;n++){var o,i=r[n],a=ve(de(e.matchAll(i)));try{for(a.s();!(o=a.n()).done;){var s=o.value,c=this.parseWineFromMatch(s);this.isRedWine(c.name)&&!t.redWine?t.redWine=c:this.isWhiteWine(c.name)&&!t.whiteWine&&(t.whiteWine=c)}}catch(e){a.e(e)}finally{a.f()}}return t}},{key:"parseWithSemanticAnalysis",value:function(e){var t,n=this.initializeResultStructure(),r=ve(e.split("\n"));try{for(r.s();!(t=r.n()).done;){var o=t.value.trim();if(o){if(this.hasWineSemantics(o)){var i=this.parseWineLineWithConfidence(o,.95);this.isRedWine(i.name)&&!n.redWine?n.redWine=i:this.isWhiteWine(i.name)&&!n.whiteWine&&(n.whiteWine=i)}if(this.hasFoodSemantics(o)){var a={name:this.cleanFoodText(o),confidence:.9};this.isStarterSemantics(o)?(n.starters=n.starters||[],n.starters.push(a)):(n.entrees=n.entrees||[],n.entrees.push(a))}}}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"hasWineSemantics",value:function(e){return["vineyard","estate","reserve","vintage","chateau","domaine"].some(function(t){return e.toLowerCase().includes(t)})||this.isWineLine(e)}},{key:"hasFoodSemantics",value:function(e){return["with","served","accompanied","garnished","topped"].some(function(t){return e.toLowerCase().includes(t)})||this.isFoodLine(e)}},{key:"isStarterSemantics",value:function(e){return["starter","appetizer","small","light","beginning"].some(function(t){return e.toLowerCase().includes(t)})}},{key:"calculateAdvancedConfidenceScore",value:function(e,t){var n=0,r=0;return n+=t.reduce(function(e,t){return e+t.confidence},0)/t.length*.4,r+=.4,e.redWine&&(n+=.2*e.redWine.confidence,r+=.2),e.whiteWine&&(n+=.2*e.whiteWine.confidence,r+=.2),e.starters&&e.starters.length>0&&(n+=e.starters.reduce(function(e,t){return e+t.confidence},0)/e.starters.length*.1,r+=.1),e.entrees&&e.entrees.length>0&&(n+=e.entrees.reduce(function(e,t){return e+t.confidence},0)/e.entrees.length*.1,r+=.1),r>0?n/r:0}},{key:"validateAndScoreResults",value:(i=Ee(we().m(function e(t){var n,r=this;return we().w(function(e){for(;;)if(0===e.n)return(n=me({},t)).redWine&&(n.redWine=this.validateWineData(n.redWine)),n.whiteWine&&(n.whiteWine=this.validateWineData(n.whiteWine)),n.starters&&(n.starters=n.starters.filter(function(e){return r.validateFoodData(e)}).map(function(e){return r.cleanFoodData(e)})),n.entrees&&(n.entrees=n.entrees.filter(function(e){return r.validateFoodData(e)}).map(function(e){return r.cleanFoodData(e)})),n.confidence=this.calculateFinalConfidence(n),e.a(2,n)},e,this)})),function(e){return i.apply(this,arguments)})},{key:"validateWineData",value:function(e){return!e.name||e.name.length<3?null:(e.price.startsWith("$")||(e.price="$".concat(e.price.replace(/[^\d]/g,""))),e.year&&!/^\d{4}$/.test(e.year)&&(e.year=""),e)}},{key:"validateFoodData",value:function(e){return e.name&&e.name.length>3&&e.confidence>.7}},{key:"cleanFoodData",value:function(e){return{name:e.name,confidence:e.confidence}}},{key:"calculateFinalConfidence",value:function(e){var t=0,n=0;return e.redWine&&(t+=e.redWine.confidence,n++),e.whiteWine&&(t+=e.whiteWine.confidence,n++),e.starters&&e.starters.length>0&&(t+=e.starters.reduce(function(e,t){return e+t.confidence},0)/e.starters.length,n++),e.entrees&&e.entrees.length>0&&(t+=e.entrees.reduce(function(e,t){return e+t.confidence},0)/e.entrees.length,n++),n>0?t/n:0}},{key:"initializeResultStructure",value:function(){return{redWine:null,whiteWine:null,starters:[],entrees:[],cocktail:null,specials:[],confidence:0}}},{key:"createFallbackResult",value:function(){return{redWine:null,whiteWine:null,starters:[],entrees:[],cocktail:null,specials:[],confidence:.5,error:"Advanced parsing failed"}}},{key:"isWineLine",value:function(e){return["pinot noir","merlot","cabernet","chardonnay","sauvignon","riesling","syrah","zinfandel","malbec","sangiovese","pinot grigio","gewrztraminer"].some(function(t){return e.toLowerCase().includes(t)})}},{key:"isRedWine",value:function(e){return["pinot noir","merlot","cabernet","syrah","zinfandel","malbec","sangiovese"].some(function(t){return e.toLowerCase().includes(t)})}},{key:"isWhiteWine",value:function(e){return["chardonnay","sauvignon","riesling","pinot grigio","gewrztraminer","viognier"].some(function(t){return e.toLowerCase().includes(t)})}},{key:"isFoodLine",value:function(e){return["salmon","duck","chicken","beef","pork","lamb","fish","shrimp","scallop","risotto","pasta","salad","soup","tartare","charcuterie","cheese","mushroom"].some(function(t){return e.toLowerCase().includes(t)})||e.length>5&&!e.match(/^\d+$/)&&!e.match(/^\$\d+/)}},{key:"cleanFoodText",value:function(e){return e.replace(/\$(\d+)/,"").replace(/^\d+\.\s*/,"").trim()}},{key:"calculateLineConfidence",value:function(e){var t=.8;return e.includes("$")&&(t+=.1),/\d{4}/.test(e)&&(t+=.05),/[A-Z]/.test(e)&&(t+=.05),Math.min(1,t)}},{key:"parseWineLineWithConfidence",value:function(e,t){var n=e.match(/\$(\d+)/),r=e.match(/(\d{4})/),o=n?"$".concat(n[1]):"$0",i=r?r[1]:"",a=e,s="";i&&(a=e.split(i)[0].trim());var c=e.split(",");return c.length>1&&(a=c[0].trim(),s=(s=c.slice(1).join(",").trim()).replace(/\d{4}/,"").trim()),{name:a=a.replace(/\$(\d+)/,"").trim(),region:s,year:i,price:o,confidence:t}}},{key:"parseWineFromMatch",value:function(e){return e.length>=5?{name:e[1].trim(),region:e[2].trim(),year:e[3],price:"$".concat(e[4]),confidence:.95}:{name:e[1].trim(),region:"",year:"",price:"$".concat(e[2]),confidence:.9}}},{key:"handleProcessingError",value:(o=Ee(we().m(function e(t,n){return we().w(function(e){for(;;)switch(e.n){case 0:if(console.warn("Ultra-enhanced OCR processing failed, attempting recovery..."),!(this.retryCount<this.maxRetries)){e.n=3;break}return this.retryCount++,console.log("Retry attempt ".concat(this.retryCount,"/").concat(this.maxRetries)),e.n=1,new Promise(function(e){return setTimeout(e,1e3)});case 1:return e.n=2,this.processImage(t);case 2:return e.a(2,e.v);case 3:return e.a(2,{redWine:null,whiteWine:null,starters:[],entrees:[],cocktail:null,specials:[],confidence:.5,error:n.message,rawText:"Ultra-enhanced OCR processing failed after all retries"});case 4:return e.a(2)}},e,this)})),function(e,t){return o.apply(this,arguments)})},{key:"setProgressCallback",value:function(e){this.progressCallback=e}},{key:"updateProgress",value:function(e,t){this.progressCallback&&this.progressCallback({percent:e,message:t})}},{key:"generateCacheKey",value:(r=Ee(we().m(function e(t){var n,r;return we().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,t.arrayBuffer();case 1:return n=e.v,e.n=2,crypto.subtle.digest("SHA-256",n);case 2:return r=e.v,e.a(2,Array.from(new Uint8Array(r)).map(function(e){return e.toString(16).padStart(2,"0")}).join(""))}},e)})),function(e){return r.apply(this,arguments)})},{key:"terminate",value:(n=Ee(we().m(function e(){var t,n,r,o;return we().w(function(e){for(;;)switch(e.p=e.n){case 0:t=ve(this.workers),e.p=1,t.s();case 2:if((n=t.n()).done){e.n=4;break}return r=n.value,e.n=3,r.terminate();case 3:e.n=2;break;case 4:e.n=6;break;case 5:e.p=5,o=e.v,t.e(o);case 6:return e.p=6,t.f(),e.f(6);case 7:this.workers=[],this.isInitialized=!1;case 8:return e.a(2)}},e,this,[[1,5,6,7]])})),function(){return n.apply(this,arguments)})}],t&&xe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o,i,a,s,c,l,u,f,d,h,p}();function Ie(e){return Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ie(e)}function Le(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return Te(l,"_invoke",function(n,r,o){var i,s,c,l=0,u=o||[],f=!1,d={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,s=0,c=e,d.n=n,a}};function h(n,r){for(s=n,c=r,t=0;!f&&l&&!o&&t<u.length;t++){var o,i=u[t],h=d.p,p=i[2];n>3?(o=p===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(s=0,d.v=r,d.n=i[1]):h<p&&(o=n<3||i[0]>r||r>p)&&(i[4]=n,i[5]=r,d.n=p,s=0))}if(o||n>1)return a;throw f=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&h(u,p),s=u,c=p;(t=s<2?e:c)||!f;){i||(s?s<3?(s>1&&(d.n=-1),h(s,c)):d.n=c:d.v=c);try{if(l=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(f=d.n<0)?c:n.call(r,d))!==a)break}catch(t){i=e,s=1,c=t}finally{l=1}}return{value:t,done:f}}}(n,o,i),!0),l}var a={};function s(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(Te(t={},r,function(){return this}),t),f=l.prototype=s.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,Te(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=l,Te(f,"constructor",l),Te(l,"constructor",c),c.displayName="GeneratorFunction",Te(l,o,"GeneratorFunction"),Te(f),Te(f,o,"Generator"),Te(f,r,function(){return this}),Te(f,"toString",function(){return"[object Generator]"}),(Le=function(){return{w:i,m:d}})()}function Te(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Te=function(e,t,n,r){function i(t,n){Te(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},Te(e,t,n,r)}function Ce(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function je(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){Ce(i,r,o,a,s,"next",e)}function s(e){Ce(i,r,o,a,s,"throw",e)}a(void 0)})}}function Ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,De(r.key),r)}}function De(e){var t=function(e){if("object"!=Ie(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ie(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ie(t)?t:t+""}var Re=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.app=t,this.state=t.state,this.elements=t.elements,this.ocrService=new Pe},t=[{key:"initialize",value:function(){this.setupMessageForm(),this.setupOCRFunctionality()}},{key:"setupMessageForm",value:function(){var e=this,t=document.getElementById("adminMessageForm");t&&t.addEventListener("submit",function(t){t.preventDefault(),e.handleMessageSubmit(t)})}},{key:"setupOCRFunctionality",value:function(){var e=this,t=document.getElementById("ocrFileUpload"),n=(document.getElementById("ocrPreviewContainer"),document.getElementById("ocrResultContainer"),document.getElementById("ocrPreview"),document.getElementById("processOcrButton")),r=document.getElementById("applyOcrButton");this.ocrService.setProgressCallback(function(t){var n=t.percent,r=t.message;e.updateOCRProgress(n,r)}),t&&t.addEventListener("change",function(t){e.handleFileUpload(t)}),n&&n.addEventListener("click",function(){e.processOCR()}),r&&r.addEventListener("click",function(){e.applyOCRResults()})}},{key:"handleFileUpload",value:function(e){var t=e.target.files[0],n=document.getElementById("ocrPreview"),r=document.getElementById("ocrPreviewContainer"),o=document.getElementById("ocrResultContainer");t&&n&&r&&o&&this.optimizeImage(t).then(function(e){var t=new FileReader;t.onload=function(e){n.src=e.target.result,r.classList.remove("hidden"),o.classList.add("hidden")},t.readAsDataURL(e)})}},{key:"optimizeImage",value:(r=je(Le().m(function e(t){return Le().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e){var n=document.createElement("canvas"),r=n.getContext("2d"),o=new Image;o.onload=function(){var t=o.width,i=o.height;t>800&&(i=800*i/t,t=800),i>600&&(t=600*t/i,i=600),n.width=t,n.height=i,r.drawImage(o,0,0,t,i),n.toBlob(e,"image/jpeg",.8)},o.src=URL.createObjectURL(t)}))},e)})),function(e){return r.apply(this,arguments)})},{key:"processOCR",value:(n=je(Le().m(function e(){var t,n,r,o,i,a,s,c;return Le().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=document.getElementById("ocrFileUpload"),n=document.getElementById("processOcrButton"),r=document.getElementById("ocrResultContainer"),o=document.getElementById("ocrResult"),t.files[0]){e.n=1;break}return alert("Please select an image first."),e.a(2);case 1:return n.disabled=!0,n.innerHTML='<i class="fas fa-spinner fa-spin mr-2"></i>Processing...',o.innerHTML='<p class="text-center"><i class="fas fa-spinner fa-spin mr-2"></i> Processing image with enhanced OCR...</p>',r.classList.remove("hidden"),i=performance.now(),e.p=2,e.n=3,this.ocrService.processImage(t.files[0]);case 3:a=e.v,s=performance.now()-i,this.app.services.monitor&&this.app.services.monitor.trackOCRProcessing(s,a.confidence),this.state.ocrData={redWine:a.redWine,whiteWine:a.whiteWine,starters:a.starters||[],entrees:a.entrees||[],cocktail:a.cocktail,confidence:a.confidence},this.displayOCRResults(),a.confidence&&this.showConfidenceScore(a.confidence),e.n=5;break;case 4:e.p=4,c=e.v,console.error("OCR processing failed:",c),o.innerHTML='<p class="text-red-500">OCR processing failed. Please try again.</p>';case 5:return e.p=5,n.disabled=!1,n.innerHTML='<i class="fas fa-magic mr-2"></i> Process Image',e.f(5);case 6:return e.a(2)}},e,this,[[2,4,5,6]])})),function(){return n.apply(this,arguments)})},{key:"simulateOCR",value:function(e){var t=this,n=document.getElementById("ocrResult"),r=document.getElementById("ocrResultContainer");n&&r&&(n.innerHTML='<p class="text-center"><i class="fas fa-spinner fa-spin mr-2"></i> Processing image...</p>',r.classList.remove("hidden"),setTimeout(function(){t.state.ocrData={redWine:{name:"INSIGNIA, JOSEPH PHELPS ESTATE",region:"Napa Valley, CA, 2014",price:"$305",code:"R051"},whiteWine:{name:"RAMEY, RUSSIAN RIVER VALLEY",region:"California, 2021",price:"$120",code:"C016"},starters:["House-Made Charcuterie Board with Artisanal Cheeses","Seared Sea Scallops with Citrus Beurre Blanc"],entrees:["Pan-Seared Duck Breast with Cherry Reduction","Wild Mushroom Risotto with Black Truffle"],cocktail:{name:"Barrel-Aged Manhattan",description:"Aged bourbon, sweet vermouth, bitters",price:"$14"}},t.displayOCRResults()},1500))}},{key:"displayOCRResults",value:function(){var e=document.getElementById("ocrResult");if(e){var t='<div class="space-y-4">';if(this.state.ocrData.redWine||this.state.ocrData.whiteWine){if(t+='<h4 class="font-bold text-yellow-400 mb-2">Featured Wines:</h4>',this.state.ocrData.redWine){var n=Math.round(100*(this.state.ocrData.redWine.confidence||.9)),r=n>=97?"text-green-400":n>=90?"text-yellow-400":"text-red-400";t+='\n                    <div class="bg-black bg-opacity-20 p-3 rounded-lg mb-2">\n                        <p><span class="font-semibold">Red:</span> '.concat(this.state.ocrData.redWine.name," - ").concat(this.state.ocrData.redWine.price,'</p>\n                        <p class="text-sm text-gray-400">').concat(this.state.ocrData.redWine.region," ").concat(this.state.ocrData.redWine.year?"(".concat(this.state.ocrData.redWine.year,")"):"",'</p>\n                        <div class="flex items-center mt-1">\n                            <span class="text-xs ').concat(r,'">Confidence: ').concat(n,"%</span>\n                        </div>\n                    </div>\n                ")}if(this.state.ocrData.whiteWine){var o=Math.round(100*(this.state.ocrData.whiteWine.confidence||.9)),i=o>=97?"text-green-400":o>=90?"text-yellow-400":"text-red-400";t+='\n                    <div class="bg-black bg-opacity-20 p-3 rounded-lg mb-2">\n                        <p><span class="font-semibold">White:</span> '.concat(this.state.ocrData.whiteWine.name," - ").concat(this.state.ocrData.whiteWine.price,'</p>\n                        <p class="text-sm text-gray-400">').concat(this.state.ocrData.whiteWine.region," ").concat(this.state.ocrData.whiteWine.year?"(".concat(this.state.ocrData.whiteWine.year,")"):"",'</p>\n                        <div class="flex items-center mt-1">\n                            <span class="text-xs ').concat(i,'">Confidence: ').concat(o,"%</span>\n                        </div>\n                    </div>\n                ")}}if(this.state.ocrData.starters&&this.state.ocrData.starters.length>0&&(t+='<h4 class="font-bold text-yellow-400 mt-4 mb-2">Starters:</h4>',t+='<ul class="list-disc pl-4 mb-2">',this.state.ocrData.starters.forEach(function(e){var n="string"==typeof e?e:e.name,r="string"==typeof e?.9:e.confidence||.9,o=Math.round(100*r),i=o>=97?"text-green-400":o>=90?"text-yellow-400":"text-red-400";t+='\n                    <li class="mb-1">\n                        '.concat(n,'\n                        <span class="text-xs ').concat(i,' ml-2">(').concat(o,"%)</span>\n                    </li>\n                ")}),t+="</ul>"),this.state.ocrData.entrees&&this.state.ocrData.entrees.length>0&&(t+='<h4 class="font-bold text-yellow-400 mt-4 mb-2">Entrees:</h4>',t+='<ul class="list-disc pl-4 mb-2">',this.state.ocrData.entrees.forEach(function(e){var n="string"==typeof e?e:e.name,r="string"==typeof e?.9:e.confidence||.9,o=Math.round(100*r),i=o>=97?"text-green-400":o>=90?"text-yellow-400":"text-red-400";t+='\n                    <li class="mb-1">\n                        '.concat(n,'\n                        <span class="text-xs ').concat(i,' ml-2">(').concat(o,"%)</span>\n                    </li>\n                ")}),t+="</ul>"),this.state.ocrData.cocktail){t+='<h4 class="font-bold text-yellow-400 mt-4 mb-2">Featured Cocktail:</h4>';var a=Math.round(100*(this.state.ocrData.cocktail.confidence||.9)),s=a>=97?"text-green-400":a>=90?"text-yellow-400":"text-red-400";t+='\n                <div class="bg-black bg-opacity-20 p-3 rounded-lg">\n                    <p>'.concat(this.state.ocrData.cocktail.name," - ").concat(this.state.ocrData.cocktail.price,'</p>\n                    <p class="text-sm text-gray-400">').concat(this.state.ocrData.cocktail.description||"",'</p>\n                    <div class="flex items-center mt-1">\n                        <span class="text-xs ').concat(s,'">Confidence: ').concat(a,"%</span>\n                    </div>\n                </div>\n            ")}t+="</div>",e.innerHTML=t}}},{key:"applyOCRResults",value:function(){var e=document.querySelectorAll(".featured-wine");if(this.state.ocrData.redWine&&e[0]){var t=e[0],n=t.querySelector("p:nth-child(2)"),r=t.querySelector("p:nth-child(3)"),o=t.querySelector("p:nth-child(4)"),i=t.querySelector("p:nth-child(5)");n&&(n.textContent=this.state.ocrData.redWine.name),r&&(r.textContent=this.state.ocrData.redWine.region),o&&(o.textContent=this.state.ocrData.redWine.price),i&&(i.textContent="(".concat(this.state.ocrData.redWine.code||"N/A",")"))}if(this.state.ocrData.whiteWine&&e[1]){var a=e[1],s=a.querySelector("p:nth-child(2)"),c=a.querySelector("p:nth-child(3)"),l=a.querySelector("p:nth-child(4)"),u=a.querySelector("p:nth-child(5)");s&&(s.textContent=this.state.ocrData.whiteWine.name),c&&(c.textContent=this.state.ocrData.whiteWine.region),l&&(l.textContent=this.state.ocrData.whiteWine.price),u&&(u.textContent="(".concat(this.state.ocrData.whiteWine.code||"N/A",")"))}if(this.state.ocrData.starters&&this.state.ocrData.starters.length>=2){var f,d=document.querySelectorAll(".food-special-card .grid div p"),h="string"==typeof this.state.ocrData.starters[0]?this.state.ocrData.starters[0]:this.state.ocrData.starters[0].name,p="string"==typeof this.state.ocrData.starters[1]?this.state.ocrData.starters[1]:(null===(f=this.state.ocrData.starters[1])||void 0===f?void 0:f.name)||"";d[0]&&(d[0].textContent=h),d[1]&&(d[1].textContent=p)}if(this.state.ocrData.entrees&&this.state.ocrData.entrees.length>0){var m=document.querySelectorAll(".food-special-card .grid div p"),y="string"==typeof this.state.ocrData.entrees[0]?this.state.ocrData.entrees[0]:this.state.ocrData.entrees[0].name;m[2]&&(m[2].textContent=y)}var v=this.state.ocrData.confidence||.95,g=Math.round(100*v),b="OCR results applied successfully! (".concat(g,g>=97?"% accuracy)":"% accuracy - please verify)");this.showToast(b,g>=97?"success":"warning")}},{key:"updateOCRProgress",value:function(e,t){var n=document.getElementById("processOcrButton"),r=document.getElementById("ocrResult");n&&(n.innerHTML='<i class="fas fa-spinner fa-spin mr-2"></i>'.concat(t," (").concat(e,"%)")),r&&e<100&&(r.innerHTML='<p class="text-center"><i class="fas fa-spinner fa-spin mr-2"></i> '.concat(t," (").concat(e,"%)</p>"))}},{key:"showConfidenceScore",value:function(e){var t=Math.round(100*e),n=t>=97?"text-green-400":t>=90?"text-yellow-400":"text-red-400",r='\n            <div class="mt-4 p-3 bg-black bg-opacity-30 rounded-lg">\n                <h4 class="font-bold '.concat(n,' mb-2">OCR Confidence Score</h4>\n                <div class="flex items-center">\n                    <div class="flex-1 bg-gray-700 rounded-full h-2 mr-3">\n                        <div class="bg-green-500 h-2 rounded-full" style="width: ').concat(t,'%"></div>\n                    </div>\n                    <span class="text-sm ').concat(n,' font-bold">').concat(t,'%</span>\n                </div>\n                <p class="text-xs text-gray-400 mt-1">\n                    ').concat(t>=97?"Excellent accuracy!":t>=90?"Good accuracy":"Lower accuracy - please verify results","\n                </p>\n            </div>\n        "),o=document.getElementById("ocrResult");o&&(o.innerHTML+=r)}},{key:"showToast",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=document.createElement("div"),r="success"===t?"bg-green-600":"error"===t?"bg-red-600":"bg-blue-600";n.className="fixed bottom-4 right-4 ".concat(r," text-white py-2 px-4 rounded-lg shadow-lg z-50"),n.textContent=e,document.body.appendChild(n),setTimeout(function(){n.remove()},3e3)}},{key:"handleMessageSubmit",value:function(e){var t=document.getElementById("senderName").value,n=document.getElementById("messageSubject").value,r=document.getElementById("messageBody").value,o="mailto:info@table1837.com?subject=".concat(encodeURIComponent(n),"&body=").concat(encodeURIComponent("From: ".concat(t,"\n\n").concat(r)));window.location.href=o,e.target.reset(),alert("Email client opened. Please send the message from your email application.")}},{key:"cleanup",value:function(){}}],t&&Ae(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}();function We(e){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},We(e)}function Me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Be(r.key),r)}}function Be(e){var t=function(e){if("object"!=We(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=We(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==We(t)?t:t+""}var Fe=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.app=t,this.state=t.state,this.elements=t.elements},(t=[{key:"initialize",value:function(){this.setupEventListeners()}},{key:"setupEventListeners",value:function(){var e=this,t=document.getElementById("wineSearch"),n=document.getElementById("wineFilter");t&&t.addEventListener("input",function(){return e.filterWines()}),n&&n.addEventListener("change",function(){return e.filterWines()})}},{key:"filterWines",value:function(){var e=document.getElementById("wineSearch"),t=document.getElementById("wineFilter");if(e&&t){var n=e.value.toLowerCase(),r=t.value;document.querySelectorAll(".wine-category").forEach(function(e){var t=e.classList.contains("red-wine")?"red":e.classList.contains("white-wine")?"white":e.classList.contains("sparkling-wine")?"sparkling":"",o=!0;r&&r!==t&&(o=!1),n&&o&&(o=e.textContent.toLowerCase().includes(n)),e.style.display=o?"block":"none"})}}}])&&Me(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function ze(e){return ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ze(e)}function Ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_e(r.key),r)}}function _e(e){var t=function(e){if("object"!=ze(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ze(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ze(t)?t:t+""}var Ue=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.app=t,this.state=t.state,this.elements=t.elements,this.inventory={vodka:["Zyr Vodka","360 Double Chocolate Vodka","Western Sun Blueberry Vodka","Absolut","Smirnoff Vanilla","Smirnoff Citrus","Smirnoff Vodka (Regular)","Holla Vodka","Tito's","Gray Goose","Double Cross Vodka","Kettle One","Kettle One Cucumber and Mint"],gin:["Hendrick's Gin","Bar Hill Gin","Whitley Neill Rhubarb and Ginger Gin","Bombay Sapphire Dry Gin","Nolet's Dry Gin","Blue Coat Dry Gin","Tanqueray Dry Gin","Beef Eater Dry Gin","Aviation American Gin"],rum:["Cruzan Blueberry Lemonade Rum","Gosling's Black Rum","Malibu Coconut Rum","Captain Morgan Spiced Rum","Bacardi"],tequila:["21 Seed Cucumber Jalapeno Tequila","Jose Cuervo Silver","Jose Cuervo Gold","Casamigos Mezcal","Casamigos Blanco","Coramino Reposado","Agavales Blood Orange Blanco Tequila"],whiskey:["Knob Creek","Elijah Craig","Angels Envy","Dublin","Sycamore Rye","Maker's Mark","Bullet Rye","Bullet Bourbon","Basil Hayden's Malted Rye","Basil Hayden's Bourbon","Jack Daniels","Jim Bean","Woodford Reserve","Watershed Distillery Straight Bourbon 4-Year","Dubliner","Canadian Club","Seagrams Seven","Seagram's VO","Southern Comfort","Crown Royal Apple","Crown Royal","Jameson","Red Breast Single Pot Still Irish Whiskey 12-Year","Chivas","Highland Park 12-Year","Glenliet 12-Year","Glenfiddich 12-Year","Balvini Doublewood 12-Year","Glenmorangie 12-Year","Macallen 12 Double Cask","Dewars Scotch Whiskey White Label","Johnnie Walker Red","Johnnie Walker Black"],cordials:["Monin Blackberry","Monin Lavender","Monin Caramel","DeKuyper Sour Apple","Peychaud's Bitters","Aromatic Bitters","Angostura Bitters","Dry Vermouth","Sweet Vermouth","Saint Germain","Drambuie","Blue Curacao","DeKuyper Butterscotch","DeKuyper Melon","DeKuyper Razmataz","DeKuyper Watermelon Pucker","Jaquin's Creme de Cacao","Triple Sec","Middle West Spirits Bourbon Cream","Disaronno Amaretto","Screwball","Kahlua","Bailey's","RumChata","Frangelico","Sambuca","Luxardo","Campari","Aperol","Cream to Violet","Contreau","Pama Pomegranate Liqueur"]}},t=[{key:"initialize",value:function(){this.initializeInventory(),this.displayInventory(),this.initializeVoiceRecognition(),this.setupEventListeners()}},{key:"setupEventListeners",value:function(){var e=this;document.querySelectorAll(".category-filter").forEach(function(t){t.addEventListener("click",function(t){document.querySelectorAll(".category-filter").forEach(function(e){e.classList.remove("active","bg-dark-green"),e.classList.add("bg-gray-700")}),t.target.classList.add("active","bg-dark-green"),t.target.classList.remove("bg-gray-700"),e.filterInventory(t.target.dataset.category)})});var t=document.getElementById("updateInventoryBtn");t&&t.addEventListener("click",function(){e.saveInventory(),alert("Inventory updated successfully!")})}},{key:"initializeInventory",value:function(){var e=this;Object.keys(this.inventory).forEach(function(t){e.inventory[t].forEach(function(n){e.state.inventoryData[n]||(e.state.inventoryData[n]={bottles:0,ounces:0,category:t})})})}},{key:"displayInventory",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",n=document.getElementById("inventoryGrid");if(n){var r=document.createDocumentFragment();Object.keys(this.inventory).forEach(function(n){if("all"===t||t===n){var o=document.createElement("div");o.className="col-span-full",o.innerHTML='<h3 class="text-2xl font-bold mb-4 text-center capitalize text-yellow-400">'.concat(n,"</h3>"),r.appendChild(o),e.inventory[n].forEach(function(t){var o=e.state.inventoryData[t]||{bottles:0,ounces:0,category:n},i=document.createElement("div");i.className="inventory-item",i.innerHTML='\n                    <h4 class="font-semibold mb-3">'.concat(t,'</h4>\n                    <div class="grid grid-cols-2 gap-4">\n                        <div>\n                            <label class="block text-sm text-gray-300 mb-1">Bottles</label>\n                            <input type="number" \n                                   class="w-full px-3 py-2 bg-black bg-opacity-50 border border-gray-600 rounded focus:outline-none focus:border-green-600 text-white" \n                                   value="').concat(o.bottles,'" \n                                   data-item="').concat(t,'" \n                                   data-type="bottles"\n                                   min="0">\n                        </div>\n                        <div>\n                            <label class="block text-sm text-gray-300 mb-1">Ounces</label>\n                            <input type="number" \n                                   class="w-full px-3 py-2 bg-black bg-opacity-50 border border-gray-600 rounded focus:outline-none focus:border-green-600 text-white" \n                                   value="').concat(o.ounces,'" \n                                   data-item="').concat(t,'" \n                                   data-type="ounces"\n                                   min="0"\n                                   step="0.1">\n                        </div>\n                    </div>\n                '),i.querySelectorAll("input").forEach(function(t){t.addEventListener("change",function(t){var r=t.target.dataset.item,o=t.target.dataset.type,i=parseFloat(t.target.value)||0;e.state.inventoryData[r]||(e.state.inventoryData[r]={bottles:0,ounces:0,category:n}),e.state.inventoryData[r][o]=i})}),r.appendChild(i)})}}),n.innerHTML="",n.appendChild(r)}}},{key:"filterInventory",value:function(e){this.displayInventory(e)}},{key:"saveInventory",value:function(){localStorage.setItem("inventoryData",JSON.stringify(this.state.inventoryData))}},{key:"initializeVoiceRecognition",value:function(){var e=this;if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){var t=window.SpeechRecognition||window.webkitSpeechRecognition;this.state.recognition=new t,this.state.recognition.continuous=!0,this.state.recognition.interimResults=!0,this.state.recognition.lang="en-US";var n=document.getElementById("voiceButton");n&&n.addEventListener("click",function(){return e.toggleVoiceRecognition()}),this.state.recognition.onresult=function(t){return e.handleVoiceResult(t)},this.state.recognition.onerror=function(t){return e.handleVoiceError(t)},this.state.recognition.onend=function(){return e.handleVoiceEnd()}}else{var r=document.getElementById("voiceButton");r&&(r.disabled=!0,r.innerHTML='<i class="fas fa-microphone-slash"></i> Voice Not Supported')}}},{key:"toggleVoiceRecognition",value:function(){var e=document.getElementById("voiceButton"),t=document.getElementById("voiceStatus");this.state.isListening?(this.state.recognition.stop(),this.state.isListening=!1,t.classList.add("hidden"),e.innerHTML='<i class="fas fa-microphone"></i> Voice Update',e.classList.remove("bg-red-600")):(this.state.recognition.start(),this.state.isListening=!0,t.classList.remove("hidden"),e.innerHTML='<i class="fas fa-stop"></i> Stop Listening',e.classList.add("bg-red-600"))}},{key:"handleVoiceResult",value:function(e){var t=e.results[e.results.length-1],n=t[0].transcript.trim(),r=document.getElementById("voiceText");r&&(r.textContent=n),t.isFinal&&this.processVoiceInput(n)}},{key:"handleVoiceError",value:function(e){console.error("Speech recognition error:",e.error),this.state.isListening=!1;var t=document.getElementById("voiceStatus"),n=document.getElementById("voiceButton");t&&t.classList.add("hidden"),n&&(n.innerHTML='<i class="fas fa-microphone"></i> Voice Update',n.classList.remove("bg-red-600")),alert("Voice recognition error: ".concat(e.error,". Please try again."))}},{key:"handleVoiceEnd",value:function(){this.state.isListening&&this.state.recognition.start()}},{key:"processVoiceInput",value:function(e){console.log("Processing voice input:",e);try{for(var t=e.toLowerCase().split(" "),n=0,r=0,o=0;o<t.length;o++){var i=t[o],a=parseFloat(i);if(!isNaN(a)){var s=t[o+1]||"";s.includes("bottle")||"bottles"===s||"bottle"===s?n=a:(s.includes("ounce")||s.includes("oz")||"ounces"===s)&&(r=a)}}var c=0,l=null;Object.keys(this.state.inventoryData).forEach(function(t){var n=t.toLowerCase().split(" "),r=0,o=0;n.forEach(function(t){t.length>2&&(o++,e.toLowerCase().includes(t)&&r++)});var i=o>0?r/o:0;i>c&&i>.4&&(c=i,l=t)}),l&&(n>0||r>0)?(n>0&&(this.state.inventoryData[l].bottles=n),r>0&&(this.state.inventoryData[l].ounces=r),this.updateInventoryDisplay(l,n,r),this.showToast("Updated ".concat(l,": ").concat(n>0?"".concat(n," bottles"):""," ").concat(r>0?"".concat(r," ounces"):""))):l?this.showToast("Recognized ".concat(l,", but no quantity detected. Please specify bottles or ounces.")):n>0||r>0?this.showToast("Quantity detected (".concat(n>0?"".concat(n," bottles"):""," ").concat(r>0?"".concat(r," ounces"):"","), but could not match a specific item. Please try again.")):this.showToast("Could not recognize inventory update. Please try again with item name and quantity.")}catch(e){console.error("Error processing voice input:",e),this.showToast("Error processing voice input. Please try again.")}}},{key:"updateInventoryDisplay",value:function(e,t,n){document.querySelectorAll('input[data-item="'.concat(e,'"]')).forEach(function(e){"bottles"===e.dataset.type&&t>0?e.value=t:"ounces"===e.dataset.type&&n>0&&(e.value=n)})}},{key:"showToast",value:function(e){var t=document.createElement("div");t.className="fixed bottom-4 right-4 bg-dark-green text-white py-2 px-4 rounded-lg shadow-lg z-50 animate-fade-in-up",t.textContent=e,document.body.appendChild(t),setTimeout(function(){t.classList.add("animate-fade-out"),setTimeout(function(){document.body.contains(t)&&document.body.removeChild(t)},500)},3e3)}},{key:"cleanup",value:function(){this.state.recognition&&this.state.recognition.stop()}}],t&&Ne(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function Ge(e){return Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ge(e)}function Ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,He(r.key),r)}}function He(e){var t=function(e){if("object"!=Ge(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ge(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ge(t)?t:t+""}var $e=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.app=t,this.state=t.state,this.elements=t.elements},(t=[{key:"initialize",value:function(){this.createPerformanceDashboard(),this.startRealTimeMonitoring()}},{key:"createPerformanceDashboard",value:function(){var e=document.createElement("div");e.id="performance-dashboard",e.className="fixed top-4 right-4 bg-black bg-opacity-80 p-4 rounded-lg text-xs z-50 max-w-xs",e.innerHTML='\n            <h3 class="font-bold text-yellow-400 mb-2">Performance Monitor</h3>\n            <div id="performance-metrics" class="space-y-1">\n                <div>Load Time: <span id="load-time">-</span></div>\n                <div>Memory: <span id="memory-usage">-</span></div>\n                <div>Errors: <span id="error-count">-</span></div>\n                <div>OCR Avg: <span id="ocr-avg">-</span></div>\n            </div>\n            <button id="performance-toggle" class="mt-2 text-xs bg-gray-700 px-2 py-1 rounded">Hide</button>\n        ',document.body.appendChild(e);var t=document.getElementById("performance-toggle");t.addEventListener("click",function(){var e=document.getElementById("performance-metrics"),n=e.classList.contains("hidden");e.classList.toggle("hidden"),t.textContent=n?"Hide":"Show"})}},{key:"startRealTimeMonitoring",value:function(){var e=this;setInterval(function(){e.updateMetrics()},2e3)}},{key:"updateMetrics",value:function(){if(this.app.services.monitor){var e=this.app.services.monitor.getMetrics(),t=document.getElementById("load-time"),n=document.getElementById("memory-usage"),r=document.getElementById("error-count"),o=document.getElementById("ocr-avg");t&&(t.textContent="".concat(e.loadTime.toFixed(0),"ms")),n&&(n.textContent="".concat(e.memoryUsage.toFixed(1),"MB")),r&&(r.textContent=e.errors.length),o&&(o.textContent="".concat(e.averageOCRTime.toFixed(0),"ms"))}}},{key:"cleanup",value:function(){var e=document.getElementById("performance-dashboard");e&&e.remove()}}])&&Ve(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function Je(e){return Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Je(e)}function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(n),!0).forEach(function(t){Ye(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ye(e,t,n){return(t=rt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ze(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return Qe(l,"_invoke",function(n,r,o){var i,s,c,l=0,u=o||[],f=!1,d={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,s=0,c=e,d.n=n,a}};function h(n,r){for(s=n,c=r,t=0;!f&&l&&!o&&t<u.length;t++){var o,i=u[t],h=d.p,p=i[2];n>3?(o=p===r)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=n<2&&h<i[1])?(s=0,d.v=r,d.n=i[1]):h<p&&(o=n<3||i[0]>r||r>p)&&(i[4]=n,i[5]=r,d.n=p,s=0))}if(o||n>1)return a;throw f=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&h(u,p),s=u,c=p;(t=s<2?e:c)||!f;){i||(s?s<3?(s>1&&(d.n=-1),h(s,c)):d.n=c:d.v=c);try{if(l=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(f=d.n<0)?c:n.call(r,d))!==a)break}catch(t){i=e,s=1,c=t}finally{l=1}}return{value:t,done:f}}}(n,o,i),!0),l}var a={};function s(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(Qe(t={},r,function(){return this}),t),f=l.prototype=s.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,Qe(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=l,Qe(f,"constructor",l),Qe(l,"constructor",c),c.displayName="GeneratorFunction",Qe(l,o,"GeneratorFunction"),Qe(f),Qe(f,o,"Generator"),Qe(f,r,function(){return this}),Qe(f,"toString",function(){return"[object Generator]"}),(Ze=function(){return{w:i,m:d}})()}function Qe(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Qe=function(e,t,n,r){function i(t,n){Qe(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},Qe(e,t,n,r)}function Xe(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function et(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){Xe(i,r,o,a,s,"next",e)}function s(e){Xe(i,r,o,a,s,"throw",e)}a(void 0)})}}function tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,rt(r.key),r)}}function rt(e){var t=function(e){if("object"!=Je(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Je(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Je(t)?t:t+""}var ot=function(){return e=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.services={},this.initializeCoreServices(),this.state={items86:this.services.dataPersistence.loadData("items86",[]),inventoryData:this.services.dataPersistence.loadData("inventoryData",{}),ocrData:this.services.dataPersistence.loadData("ocrData",{redWine:null,whiteWine:null,starters:[],entrees:[],cocktail:null}),recognition:null,isListening:!1,user:null,session:null},this.elements={},this.modules={},this.initializeServices(),window.logout=function(){return t.logout()}},t=[{key:"init",value:function(){this.cacheElements(),this.initializeModules(),this.setupEventListeners(),this.setupNavigation(),this.setupEnhancedFeatures(),this.registerServiceWorker(),this.startPerformanceMonitoring()}},{key:"startPerformanceMonitoring",value:function(){"PerformanceObserver"in window&&new PerformanceObserver(function(e){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return tt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(e.getEntries());try{for(n.s();!(t=n.n()).done;){var r=t.value;r.duration>50&&console.warn(" Long task detected:",r.duration.toFixed(2),"ms")}}catch(e){n.e(e)}finally{n.f()}}).observe({entryTypes:["longtask"]}),setInterval(function(){if("memory"in performance){var e=performance.memory,t=e.usedJSHeapSize/1024/1024,n=e.totalJSHeapSize/1024/1024;t>100&&console.warn(" High memory usage:",t.toFixed(2),"MB /",n.toFixed(2),"MB")}},1e4)}},{key:"registerServiceWorker",value:function(){"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(function(e){console.log(" Service Worker registered:",e)}).catch(function(e){console.error(" Service Worker registration failed:",e)})}},{key:"cacheElements",value:function(){var e=this;["alert86List","current86Items","todaySpecial","inventoryGrid","voiceStatus","voiceText","ocrPreview","ocrResult"].forEach(function(t){e.elements[t]=document.getElementById(t)})}},{key:"initializeModules",value:function(){console.log(" Initializing Table 1837 modules..."),this.modules.dashboard=new ie(this),this.modules.dashboard.initialize(),this.modules.performance=new $e(this),this.modules.performance.initialize(),this.modules.staff=null,this.modules.admin=null,this.modules.wine=null,this.modules.inventory=null,console.log(" Core modules initialized successfully")}},{key:"loadModule",value:(i=et(Ze().m(function e(t){var n,r,o,i;return Ze().w(function(e){for(;;)switch(e.n){case 0:if(!this.modules[t]||null===this.modules[t]){e.n=1;break}return e.a(2,this.modules[t]);case 1:n=performance.now(),console.log(" Loading module: ".concat(t)),i=t,e.n="staff"===i?2:"admin"===i?3:"wine"===i?4:"inventory"===i?5:6;break;case 2:return this.modules.staff||(this.modules.staff=new le(this),this.modules.staff.initialize()),r=this.modules.staff,e.a(3,7);case 3:return this.modules.admin||(this.modules.admin=new Re(this),this.modules.admin.initialize()),r=this.modules.admin,e.a(3,7);case 4:return this.modules.wine||(this.modules.wine=new Fe(this),this.modules.wine.initialize()),r=this.modules.wine,e.a(3,7);case 5:return this.modules.inventory||(this.modules.inventory=new Ue(this),this.modules.inventory.initialize()),r=this.modules.inventory,e.a(3,7);case 6:r=this.modules[t];case 7:return o=performance.now()-n,this.services.monitor&&this.services.monitor.trackModuleLoad(t,o),e.a(2,r)}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"setupEventListeners",value:function(){var e=this,t=document.getElementById("loginForm");t&&t.addEventListener("submit",function(t){t.preventDefault(),e.handleLogin()})}},{key:"setupNavigation",value:function(){var e=this;document.querySelectorAll(".nav-tab").forEach(function(t){t.addEventListener("click",function(n){t.dataset.tab&&(e.showTab(t.dataset.tab),document.querySelectorAll(".nav-tab").forEach(function(e){return e.classList.remove("active")}),t.classList.add("active"))})})}},{key:"initializeCoreServices",value:function(){this.services.errorHandler=new o,this.services.dataPersistence=new E,this.services.validation=new T,this.services.auth=new y,console.log(" Core services initialized")}},{key:"initializeServices",value:function(){this.services.performance=new z,this.services.monitor=new J,this.services.search=new Z,this.services.theme=new te,console.log(" Enhanced services initialized")}},{key:"setupEnhancedFeatures",value:function(){var e=this;document.addEventListener("keydown",function(t){if(t.ctrlKey||t.metaKey)switch(t.key){case"k":t.preventDefault(),e.focusSearch();break;case"t":t.preventDefault(),e.services.theme.toggleTheme();break;case"1":case"2":case"3":case"4":case"5":t.preventDefault();var n=["dashboard","staff","admin","wine","inventory"],r=parseInt(t.key)-1;r<n.length&&e.showTab(n[r])}});var t=document.getElementById("wineSearch");t&&t.addEventListener("input",function(t){var n=t.target.value;if(n.length>1){var r=e.services.search.search(n);e.updateWineResults(r)}})}},{key:"focusSearch",value:function(){var e=document.querySelectorAll('input[type="text"]');e.length>0&&e[0].focus()}},{key:"updateWineResults",value:function(e){document.getElementById("wineCategories")&&e.length>0&&console.log("Search results:",e)}},{key:"handleLogin",value:(r=et(Ze().m(function e(){var t,n,r,o,i;return Ze().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,t=document.getElementById("username").value.toLowerCase(),n=document.getElementById("password").value,(r=this.services.validation.validateForm({username:t,password:n})).isValid){e.n=1;break}return this.showError("Please check your input: "+Object.values(r.errors).join(", ")),e.a(2);case 1:return e.n=2,this.services.auth.authenticate(t,n);case 2:(o=e.v).success?(this.state.user=o.user,this.state.session=o.session,this.showMainApp(),this.showSuccess("Login successful!")):this.showError("Invalid credentials. Please try again."),e.n=4;break;case 3:e.p=3,i=e.v,this.services.errorHandler.handleError(i,"login"),this.showError("Login failed. Please try again.");case 4:return e.a(2)}},e,this,[[0,3]])})),function(){return r.apply(this,arguments)})},{key:"showMainApp",value:function(){document.getElementById("loginPage").classList.add("hidden"),document.getElementById("mainApp").classList.remove("hidden"),this.init()}},{key:"showTab",value:(n=et(Ze().m(function e(t){var n;return Ze().w(function(e){for(;;)switch(e.n){case 0:if(document.querySelectorAll(".tab-content").forEach(function(e){e.classList.add("hidden")}),"dashboard"===t){e.n=1;break}return e.n=1,this.loadModule(t);case 1:(n=document.getElementById(t+"-content"))&&n.classList.remove("hidden");case 2:return e.a(2)}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"logout",value:function(){document.getElementById("mainApp").classList.add("hidden"),document.getElementById("loginPage").classList.remove("hidden"),document.getElementById("username").value="",document.getElementById("password").value="",Object.values(this.modules).forEach(function(e){e&&e.cleanup&&e.cleanup()}),this.clearCaches(),window.gc&&window.gc()}},{key:"clearCaches",value:function(){this.modules.admin&&this.modules.admin.ocrService&&this.modules.admin.ocrService.cache.clear(),this.services.search&&(this.services.search.lastQuery="",this.services.search.lastResults=null)}},{key:"updateState",value:function(e){this.state=Ke(Ke({},this.state),e),this.saveState()}},{key:"saveState",value:function(){this.services.dataPersistence.saveData("items86",this.state.items86),this.services.dataPersistence.saveData("inventoryData",this.state.inventoryData),this.services.dataPersistence.saveData("ocrData",this.state.ocrData)}},{key:"showError",value:function(e){this.showToast(e,"error")}},{key:"showSuccess",value:function(e){this.showToast(e,"success")}},{key:"showToast",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=document.createElement("div"),r="success"===t?"bg-green-600":"error"===t?"bg-red-600":"warning"===t?"bg-yellow-600":"bg-dark-green";n.className="fixed bottom-4 right-4 ".concat(r," text-white py-2 px-4 rounded-lg shadow-lg z-50 animate-fade-in-up"),n.textContent=e,document.body.appendChild(n),setTimeout(function(){n.classList.add("animate-fade-out"),setTimeout(function(){document.body.contains(n)&&document.body.removeChild(n)},500)},3e3)}},{key:"handleError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.error(" Error in ".concat(t,":"),e),this.services.performance&&this.services.performance.metrics.errors.push({message:e.message,context:t,timestamp:Date.now()}),this.showToast("An error occurred: ".concat(e.message),"error")}}],t&&nt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,i}();document.addEventListener("DOMContentLoaded",function(){window.app=new ot})})()})();
//# sourceMappingURL=bundle.js.map