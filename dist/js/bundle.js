/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e={28:e=>{e.exports=(e,t)=>`${e}-${t}-${Math.random().toString(16).slice(3,8)}`},39:e=>{e.exports=async(e,t)=>{e.postMessage(t)}},45:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(825));t.default=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=t,this.schema=r,this.fetch=n}select(e,{head:t=!1,count:r}={}){const n=t?"HEAD":"GET";let s=!1;const o=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!s?"":('"'===e&&(s=!s),e)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new i.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){const n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),r||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:s=!0}={}){const o=[`resolution=${r?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&o.push(this.headers.Prefer),n&&o.push(`count=${n}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),this.headers.Prefer=r.join(","),new i.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new i.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}},119:e=>{e.exports={langPath:"https://tessdata.projectnaptha.com/4.0.0",workerBlobURL:!0,logger:()=>{}}},125:e=>{"use strict";e.exports=JSON.parse('{"name":"tesseract.js","version":"4.1.4","description":"Pure Javascript Multilingual OCR","main":"src/index.js","types":"src/index.d.ts","unpkg":"dist/tesseract.min.js","jsdelivr":"dist/tesseract.min.js","scripts":{"start":"node scripts/server.js","build":"rimraf dist && webpack --config scripts/webpack.config.prod.js && rollup -c scripts/rollup.esm.mjs","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json","prepublishOnly":"npm run build","wait":"rimraf dist && wait-on http://localhost:3000/dist/tesseract.dev.js","test":"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:* test:node:all","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser-tpl":"mocha-headless-chrome -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:detect":"npm run test:browser-tpl -- -f ./tests/detect.test.html","test:browser:recognize":"npm run test:browser-tpl -- -f ./tests/recognize.test.html","test:browser:scheduler":"npm run test:browser-tpl -- -f ./tests/scheduler.test.html","test:browser:FS":"npm run test:browser-tpl -- -f ./tests/FS.test.html","lint":"eslint src","lint:fix":"eslint --fix src","postinstall":"opencollective-postinstall || true"},"browser":{"./src/worker/node/index.js":"./src/worker/browser/index.js"},"author":"","contributors":["jeromewu"],"license":"Apache-2.0","devDependencies":{"@babel/core":"^7.21.4","@babel/eslint-parser":"^7.21.3","@babel/preset-env":"^7.21.4","@rollup/plugin-commonjs":"^24.1.0","acorn":"^8.8.2","babel-loader":"^9.1.2","buffer":"^6.0.3","cors":"^2.8.5","eslint":"^7.32.0","eslint-config-airbnb-base":"^14.2.1","eslint-plugin-import":"^2.27.5","expect.js":"^0.3.1","express":"^4.18.2","mocha":"^10.2.0","mocha-headless-chrome":"^4.0.0","npm-run-all":"^4.1.5","nyc":"^15.1.0","rimraf":"^5.0.0","rollup":"^3.20.7","wait-on":"^7.0.1","webpack":"^5.79.0","webpack-bundle-analyzer":"^4.8.0","webpack-cli":"^5.0.1","webpack-dev-middleware":"^6.0.2","rollup-plugin-sourcemaps":"^0.6.3"},"dependencies":{"bmp-js":"^0.1.0","idb-keyval":"^6.2.0","is-electron":"^2.2.2","is-url":"^1.2.4","node-fetch":"^2.6.9","opencollective-postinstall":"^2.0.3","regenerator-runtime":"^0.13.3","tesseract.js-core":"^4.0.4","wasm-feature-detect":"^1.2.11","zlibjs":"^0.3.1"},"overrides":{"@rollup/pluginutils":"^5.0.2"},"repository":{"type":"git","url":"https://github.com/naptha/tesseract.js.git"},"bugs":{"url":"https://github.com/naptha/tesseract.js/issues"},"homepage":"https://github.com/naptha/tesseract.js","collective":{"type":"opencollective","url":"https://opencollective.com/tesseractjs"}}')},261:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(660));class s extends i.default{select(e){let t=!1;const r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const s=i?`${i}.order`:"order",o=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const i=void 0===n?"offset":`${n}.offset`,s=void 0===n?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(s,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:s="text"}={}){var o;const a=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=null!==(o=this.headers.Accept)&&void 0!==o?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${c}"; options=${a};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}t.default=s},279:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;const i=n(r(961));t.PostgrestClient=i.default;const s=n(r(45));t.PostgrestQueryBuilder=s.default;const o=n(r(825));t.PostgrestFilterBuilder=o.default;const a=n(r(261));t.PostgrestTransformBuilder=a.default;const c=n(r(660));t.PostgrestBuilder=c.default;const l=n(r(818));t.PostgrestError=l.default,t.default={PostgrestClient:i.default,PostgrestQueryBuilder:s.default,PostgrestFilterBuilder:o.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:c.default,PostgrestError:l.default}},321:(e,t,r)=>{const n=r(848),i=r(456),s=r(548),o=r(381),a=r(39),c=r(996);e.exports={defaultOptions:n,spawnWorker:i,terminateWorker:s,onMessage:o,send:a,loadImage:c}},381:e=>{e.exports=(e,t)=>{e.onmessage=({data:e})=>{t(e)}}},452:e=>{var t=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var s=t&&t.prototype instanceof g?t:g,o=Object.create(s.prototype),a=new P(n||[]);return i(o,"_invoke",{value:j(e,r,a)}),o}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",p="executing",y="completed",m={};function g(){}function v(){}function b(){}var w={};l(w,o,function(){return this});var k=Object.getPrototypeOf,S=k&&k(k(I([])));S&&S!==r&&n.call(S,o)&&(w=S);var _=b.prototype=g.prototype=Object.create(w);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e)})})}function E(e,t){function r(i,s,o,a){var c=h(e[i],e,s);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==typeof u&&n.call(u,"__await")?t.resolve(u.__await).then(function(e){r("next",e,o,a)},function(e){r("throw",e,o,a)}):t.resolve(u).then(function(e){l.value=e,o(l)},function(e){return r("throw",e,o,a)})}a(c.arg)}var s;i(this,"_invoke",{value:function(e,n){function i(){return new t(function(t,i){r(e,n,t,i)})}return s=s?s.then(i,i):i()}})}function j(e,t,r){var n=d;return function(i,s){if(n===p)throw new Error("Generator is already running");if(n===y){if("throw"===i)throw s;return A()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=x(o,r);if(a){if(a===m)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===d)throw n=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var c=h(e,t,r);if("normal"===c.type){if(n=r.done?y:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=y,r.method="throw",r.arg=c.arg)}}}function x(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var s=h(i,e.iterator,r.arg);if("throw"===s.type)return r.method="throw",r.arg=s.arg,r.delegate=null,m;var o=s.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function I(e){if(e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}return{next:A}}function A(){return{value:t,done:!0}}return v.prototype=b,i(_,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:v,configurable:!0}),v.displayName=l(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,c,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,a,function(){return this}),e.AsyncIterator=E,e.async=function(t,r,n,i,s){void 0===s&&(s=Promise);var o=new E(u(t,r,n,i),s);return e.isGeneratorFunction(r)?o:o.next().then(function(e){return e.done?e.value:o.next()})},T(_),l(_,c,"Generator"),l(_,o,function(){return this}),l(_,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=I,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;C(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},456:e=>{e.exports=({workerPath:e,workerBlobURL:t})=>{let r;if(Blob&&URL&&t){const t=new Blob([`importScripts("${e}");`],{type:"application/javascript"});r=new Worker(URL.createObjectURL(t))}else r=new Worker(e);return r}},465:(e,t,r)=>{const n=r(477);e.exports={recognize:async(e,t,r)=>{const i=await n(r);return await i.loadLanguage(t),await i.initialize(t),i.recognize(e).finally(async()=>{await i.terminate()})},detect:async(e,t)=>{const r=await n(t);return await r.loadLanguage("osd"),await r.initialize("osd"),r.detect(e).finally(async()=>{await r.terminate()})}}},477:(e,t,r)=>{const n=r(981),i=r(760),s=r(500),{log:o}=r(787),a=r(28),{defaultOEM:c}=r(711),{defaultOptions:l,spawnWorker:u,terminateWorker:h,onMessage:d,loadImage:f,send:p}=r(321);let y=0;e.exports=async(e={})=>{const t=a("Worker",y),{logger:r,errorHandler:m,...g}=n({...l,...e}),v={},b={};let w,k;const S=new Promise((e,t)=>{k=e,w=t});let _=u(g);_.onerror=e=>{w(e.message)},y+=1;const T=(e,t)=>{v[e]=t},E=(e,t)=>{b[e]=t},j=({id:e,action:r,payload:n})=>new Promise((i,s)=>{o(`[${t}]: Start ${e}, action=${r}`),T(r,i),E(r,s),p(_,{workerId:t,jobId:e,action:r,payload:n})});d(_,({workerId:e,jobId:t,status:n,action:s,data:a})=>{if("resolve"===n){o(`[${e}]: Complete ${t}`);let r=a;"recognize"===s?r=i(a):"getPDF"===s&&(r=Array.from({...a,length:Object.keys(a).length})),v[s]({jobId:t,data:r})}else if("reject"===n){if(b[s](a),"load"===s&&w(a),!m)throw Error(a);m(a)}else"progress"===n&&r({...a,userJobId:t})});const x={id:t,worker:_,setResolve:T,setReject:E,load:()=>{},writeText:(e,t,r)=>j(s({id:r,action:"FS",payload:{method:"writeFile",args:[e,t]}})),readText:(e,t)=>j(s({id:t,action:"FS",payload:{method:"readFile",args:[e,{encoding:"utf8"}]}})),removeFile:(e,t)=>j(s({id:t,action:"FS",payload:{method:"unlink",args:[e]}})),FS:(e,t,r)=>j(s({id:r,action:"FS",payload:{method:e,args:t}})),loadLanguage:(e="eng",t)=>j(s({id:t,action:"loadLanguage",payload:{langs:e,options:g}})),initialize:(e="eng",t=c,r,n)=>j(s({id:n,action:"initialize",payload:{langs:e,oem:t,config:r}})),setParameters:(e={},t)=>j(s({id:t,action:"setParameters",payload:{params:e}})),recognize:async(e,t={},r={blocks:!0,text:!0,hocr:!0,tsv:!0},n)=>j(s({id:n,action:"recognize",payload:{image:await f(e),options:t,output:r}})),getPDF:(e="Tesseract OCR Result",t=!1,r)=>j(s({id:r,action:"getPDF",payload:{title:e,textonly:t}})),detect:async(e,t)=>j(s({id:t,action:"detect",payload:{image:await f(e)}})),terminate:async()=>(null!==_&&(h(_),_=null),Promise.resolve())};var O;return j(s({id:O,action:"load",payload:{options:g}})).then(()=>k(x)).catch(()=>{}),S}},500:(e,t,r)=>{const n=r(28);let i=0;e.exports=({id:e,action:t,payload:r={}})=>{let s=e;return void 0===s&&(s=n("Job",i),i+=1),{id:s,action:t,payload:r}}},519:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="0.0.0-automated"},530:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_HEADERS=void 0;const n=r(519);t.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`}},548:e=>{e.exports=e=>{e.terminate()}},646:e=>{e.exports={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}},660:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(907)),s=n(r(818));t.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=i.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,r,n;let i=null,o=null,a=null,c=e.status,l=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(o="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const n=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),s=null===(r=e.headers.get("content-range"))||void 0===r?void 0:r.split("/");n&&s&&s.length>1&&(a=parseInt(s[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(o)&&(o.length>1?(i={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,a=null,c=406,l="Not Acceptable"):o=1===o.length?o[0]:null)}else{const t=await e.text();try{i=JSON.parse(t),Array.isArray(i)&&404===e.status&&(o=[],i=null,c=200,l="OK")}catch(r){404===e.status&&""===t?(c=204,l="No Content"):i={message:t}}if(i&&this.isMaybeSingle&&(null===(n=null==i?void 0:i.details)||void 0===n?void 0:n.includes("0 rows"))&&(i=null,c=200,l="OK"),i&&this.shouldThrowOnError)throw new s.default(i)}return{error:i,data:o,count:a,status:c,statusText:l}});return this.shouldThrowOnError||(r=r.catch(e=>{var t,r,n;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(r=null==e?void 0:e.stack)&&void 0!==r?r:""}`,hint:"",code:`${null!==(n=null==e?void 0:e.code)&&void 0!==n?n:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}returns(){return this}overrideTypes(){return this}}},711:(e,t,r)=>{const n=r(742);e.exports={defaultOEM:n.DEFAULT}},742:e=>{e.exports={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}},760:e=>{e.exports=e=>{const t=[],r=[],n=[],i=[],s=[];return e.blocks&&e.blocks.forEach(o=>{o.paragraphs.forEach(t=>{t.lines.forEach(r=>{r.words.forEach(n=>{n.symbols.forEach(i=>{s.push({...i,page:e,block:o,paragraph:t,line:r,word:n})}),i.push({...n,page:e,block:o,paragraph:t,line:r})}),n.push({...r,page:e,block:o,paragraph:t})}),r.push({...t,page:e,block:o})}),t.push({...o,page:e})}),{...e,blocks:t,paragraphs:r,lines:n,words:i,symbols:s}}},787:function(e,t){let r=!1;t.logging=r,t.setLogging=e=>{r=e},t.log=(...e)=>r?void 0:null},818:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=r},820:(e,t,r)=>{const n=r(866);e.exports=e=>{const t={};return"undefined"!=typeof WorkerGlobalScope?t.type="webworker":n()?t.type="electron":"object"==typeof document?t.type="browser":"object"==typeof process&&(t.type="node"),void 0===e?t:t[e]}},825:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(261));class s extends i.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(e=>"string"==typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";"plain"===n?i="pl":"phrase"===n?i="ph":"websearch"===n&&(i="w");const s=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${s}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}}t.default=s},848:(e,t,r)=>{const{version:n}=r(125),i=r(119);var s;e.exports={...i,workerPath:"undefined"!=typeof process&&"development"===process.env.TESS_ENV?(s=`/dist/worker.dev.js?nocache=${Math.random().toString(36).slice(3)}`,new URL(s,window.location.href).href):`https://cdn.jsdelivr.net/npm/tesseract.js@v${n}/dist/worker.min.js`,corePath:null}},866:e=>{e.exports=function(){return"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||(!("undefined"==typeof process||"object"!=typeof process.versions||!process.versions.electron)||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}},882:function(e,t,r){const n=r(500),{log:i}=r(787),s=r(28);let o=0;e.exports=()=>{const e=s("Scheduler",o),t={},r={};let a=[];o+=1;const c=()=>Object.keys(t).length,l=()=>{if(0!==a.length){const e=Object.keys(t);for(let n=0;n<e.length;n+=1)if(void 0===r[e[n]]){a[0](t[e[n]]);break}}},u=(t,s)=>new Promise((o,c)=>{const u=n({action:t,payload:s});a.push(async e=>{a.shift(),r[e.id]=u;try{o(await e[t].apply(this,[...s,u.id]))}catch(e){c(e)}finally{delete r[e.id],l()}}),i(`[${e}]: Add ${u.id} to JobQueue`),i(`[${e}]: JobQueue length=${a.length}`),l()});return{addWorker:r=>(t[r.id]=r,i(`[${e}]: Add ${r.id}`),i(`[${e}]: Number of workers=${c()}`),l(),r.id),addJob:async(t,...r)=>{if(0===c())throw Error(`[${e}]: You need to have at least one worker before adding jobs`);return u(t,r)},terminate:async()=>{Object.keys(t).forEach(async e=>{await t[e].terminate()}),a=[]},getQueueLen:()=>a.length,getNumWorkers:c}}},907:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Headers:()=>o,Request:()=>a,Response:()=>c,default:()=>s,fetch:()=>i});var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==r.g)return r.g;throw new Error("unable to locate global object")}();const i=n.fetch,s=n.fetch.bind(n),o=n.Headers,a=n.Request,c=n.Response},949:e=>{e.exports={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}},961:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(45)),s=n(r(825)),o=r(530);class a{constructor(e,{headers:t={},schema:r,fetch:n}={}){this.url=e,this.headers=Object.assign(Object.assign({},o.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=n}from(e){const t=new URL(`${this.url}/${e}`);return new i.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new a(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:n=!1,count:i}={}){let o;const a=new URL(`${this.url}/rpc/${e}`);let c;r||n?(o=r?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{a.searchParams.append(e,t)})):(o="POST",c=t);const l=Object.assign({},this.headers);return i&&(l.Prefer=`count=${i}`),new s.default({method:o,url:a,headers:l,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}}t.default=a},981:(e,t,r)=>{const n="browser"===r(820)("type")?e=>new URL(e,window.location.href).href:e=>e;e.exports=e=>{const t={...e};return["corePath","workerPath","langPath"].forEach(r=>{e[r]&&(t[r]=n(t[r]))}),t}},995:(e,t,r)=>{r(452);const n=r(882),i=r(477),s=r(465),o=r(646),a=r(742),c=r(949),{setLogging:l}=r(787);e.exports={languages:o,OEM:a,PSM:c,createScheduler:n,createWorker:i,setLogging:l,...s}},996:e=>{const t=e=>new Promise((t,r)=>{const n=new FileReader;n.onload=()=>{t(n.result)},n.onerror=({target:{error:{code:e}}})=>{r(Error(`File could not be read! Code=${e}`))},n.readAsArrayBuffer(e)}),r=async e=>{let n=e;if(void 0===e)return"undefined";if("string"==typeof e)if(/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(e))n=atob(e.split(",")[1]).split("").map(e=>e.charCodeAt(0));else{const t=await fetch(e);n=await t.arrayBuffer()}else if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)"IMG"===e.tagName&&(n=await r(e.src)),"VIDEO"===e.tagName&&(n=await r(e.poster)),"CANVAS"===e.tagName&&await new Promise(r=>{e.toBlob(async e=>{n=await t(e),r()})});else if("undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas){const r=await e.convertToBlob();n=await t(r)}else(e instanceof File||e instanceof Blob)&&(n=await t(e));return new Uint8Array(n)};e.exports=r}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,n(i.key),i)}}function n(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,r||"default");if("object"!=e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==e(r)?r:r+""}var i=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},n=[{key:"authenticate",value:function(e,t){return{"user@table1837.com":"password123","admin@table1837.com":"admin123","staff@table1837.com":"staff123"}[e]===t}},{key:"isAuthenticated",value:function(){return"true"===sessionStorage.getItem("authenticated")}},{key:"setAuthenticated",value:function(e){sessionStorage.setItem("authenticated",e.toString())}},{key:"logout",value:function(){sessionStorage.removeItem("authenticated")}}],(r=null)&&t(e.prototype,r),n&&t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n}();function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){c(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function c(e,t,r){return(t=f(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function s(r,n,i,s){var c=n&&n.prototype instanceof a?n:a,l=Object.create(c.prototype);return u(l,"_invoke",function(r,n,i){var s,a,c,l=0,u=i||[],h=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,r){return s=t,a=0,c=e,d.n=r,o}};function f(r,n){for(a=r,c=n,t=0;!h&&l&&!i&&t<u.length;t++){var i,s=u[t],f=d.p,p=s[2];r>3?(i=p===n)&&(c=s[(a=s[4])?5:(a=3,3)],s[4]=s[5]=e):s[0]<=f&&((i=r<2&&f<s[1])?(a=0,d.v=n,d.n=s[1]):f<p&&(i=r<3||s[0]>n||n>p)&&(s[4]=r,s[5]=n,d.n=p,a=0))}if(i||r>1)return o;throw h=!0,n}return function(i,u,p){if(l>1)throw TypeError("Generator is already running");for(h&&1===u&&f(u,p),a=u,c=p;(t=a<2?e:c)||!h;){s||(a?a<3?(a>1&&(d.n=-1),f(a,c)):d.n=c:d.v=c);try{if(l=2,s){if(a||(i="next"),t=s[i]){if(!(t=t.call(s,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,a<2&&(a=0)}else 1===a&&(t=s.return)&&t.call(s),a<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),a=1);s=e}else if((t=(h=d.n<0)?c:r.call(n,d))!==o)break}catch(t){s=e,a=1,c=t}finally{l=1}}return{value:t,done:h}}}(r,i,s),!0),l}var o={};function a(){}function c(){}function h(){}t=Object.getPrototypeOf;var d=[][n]?t(t([][n]())):(u(t={},n,function(){return this}),t),f=h.prototype=a.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,u(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=h,u(f,"constructor",h),u(h,"constructor",c),c.displayName="GeneratorFunction",u(h,i,"GeneratorFunction"),u(f),u(f,i,"Generator"),u(f,n,function(){return this}),u(f,"toString",function(){return"[object Generator]"}),(l=function(){return{w:s,m:p}})()}function u(e,t,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}u=function(e,t,r,n){function s(t,r){u(e,t,function(e){return this._invoke(t,r,e)})}t?i?i(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(s("next",0),s("throw",1),s("return",2))},u(e,t,r,n)}function h(e,t,r,n,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,i)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}var p=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metrics={loadTime:0,renderTime:0,memoryUsage:0,errors:[]},this.startTime=performance.now(),this.init()},t=[{key:"init",value:function(){var e=this;window.addEventListener("load",function(){e.metrics.loadTime=performance.now()-e.startTime,window.gtag&&window.gtag("event","page_load_time",{value:Math.round(e.metrics.loadTime)})}),"memory"in performance&&setInterval(function(){e.metrics.memoryUsage=performance.memory.usedJSHeapSize/1024/1024,e.metrics.memoryUsage},5e3),window.addEventListener("error",function(t){e.metrics.errors.push({message:t.message,filename:t.filename,lineno:t.lineno,timestamp:Date.now()})}),this.trackModuleLoads()}},{key:"trackModuleLoads",value:function(){var e,t=this,r=null===(e=this.app)||void 0===e?void 0:e.loadModule;r&&(this.app.loadModule=function(){var e,n=(e=l().m(function e(n){var i;return l().w(function(e){for(;;)switch(e.n){case 0:return performance.now(),e.n=1,r.call(t.app,n);case 1:return i=e.v,performance.now(),e.a(2,i)}},e)}),function(){var t=this,r=arguments;return new Promise(function(n,i){var s=e.apply(t,r);function o(e){h(s,n,i,o,a,"next",e)}function a(e){h(s,n,i,o,a,"throw",e)}o(void 0)})});return function(e){return n.apply(this,arguments)}}())}},{key:"getMetrics",value:function(){return a(a({},this.metrics),{},{timestamp:Date.now()})}},{key:"logPerformance",value:function(){}}],t&&d(e.prototype,t),r&&d(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach(function(t){v(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function v(e,t,r){return(t=S(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return w(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?w(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw s}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S(n.key),n)}}function S(e){var t=function(e,t){if("object"!=y(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==y(t)?t:t+""}var _=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metrics={loadTime:0,renderTime:0,memoryUsage:0,errors:[],moduleLoadTimes:{},ocrProcessingTimes:[],userInteractions:[]},this.startTime=performance.now(),this.init()},t=[{key:"init",value:function(){var e=this;window.addEventListener("load",function(){e.metrics.loadTime=performance.now()-e.startTime,e.reportMetric("page_load_time",e.metrics.loadTime)}),"memory"in performance&&setInterval(function(){e.metrics.memoryUsage=performance.memory.usedJSHeapSize/1024/1024,e.metrics.memoryUsage>100&&e.reportMetric("high_memory_usage",e.metrics.memoryUsage)},1e4),"PerformanceObserver"in window&&new PerformanceObserver(function(t){var r,n=b(t.getEntries());try{for(n.s();!(r=n.n()).done;){var i=r.value;i.duration>50&&e.reportMetric("long_task",i.duration)}}catch(e){n.e(e)}finally{n.f()}}).observe({entryTypes:["longtask"]}),window.addEventListener("error",function(t){e.metrics.errors.push({message:t.message,filename:t.filename,lineno:t.lineno,timestamp:Date.now()}),e.reportMetric("error",{message:t.message,filename:t.filename})}),this.trackUserInteractions()}},{key:"trackUserInteractions",value:function(){var e=this;["click","input","scroll","keydown"].forEach(function(t){document.addEventListener(t,function(r){e.metrics.userInteractions.push({type:t,target:r.target.tagName,timestamp:Date.now()})},{passive:!0})})}},{key:"trackModuleLoad",value:function(e,t){this.metrics.moduleLoadTimes[e]=t,this.reportMetric("module_load_time",{module:e,time:t})}},{key:"trackOCRProcessing",value:function(e,t){this.metrics.ocrProcessingTimes.push({time:e,confidence:t,timestamp:Date.now()}),this.reportMetric("ocr_processing_time",{time:e,confidence:t})}},{key:"reportMetric",value:function(e,t){window.gtag&&window.gtag("event",e,{value:t});var r=JSON.parse(localStorage.getItem("performance_metrics")||"{}");r[e]=t,localStorage.setItem("performance_metrics",JSON.stringify(r))}},{key:"getMetrics",value:function(){return g(g({},this.metrics),{},{timestamp:Date.now(),averageOCRTime:this.calculateAverageOCRTime(),averageModuleLoadTime:this.calculateAverageModuleLoadTime()})}},{key:"calculateAverageOCRTime",value:function(){return 0===this.metrics.ocrProcessingTimes.length?0:this.metrics.ocrProcessingTimes.reduce(function(e,t){return e+t.time},0)/this.metrics.ocrProcessingTimes.length}},{key:"calculateAverageModuleLoadTime",value:function(){var e=Object.values(this.metrics.moduleLoadTimes);return 0===e.length?0:e.reduce(function(e,t){return e+t},0)/e.length}},{key:"generateReport",value:function(){var e=this.getMetrics();return{summary:{totalErrors:e.errors.length,averageOCRTime:e.averageOCRTime.toFixed(2)+"ms",averageModuleLoadTime:e.averageModuleLoadTime.toFixed(2)+"ms",memoryUsage:e.memoryUsage.toFixed(2)+"MB",userInteractions:e.userInteractions.length},details:e}}},{key:"logPerformance",value:function(){}}],t&&k(e.prototype,t),r&&k(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,j(n.key),n)}}function j(e){var t=function(e,t){if("object"!=T(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==T(t)?t:t+""}var x=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.searchIndex=new Map,this.buildIndex(),this.debounceTimer=null,this.lastQuery=""},t=[{key:"buildIndex",value:function(){var e=this;this.getAllWines().forEach(function(t,r){e.generateSearchTerms(t).forEach(function(t){e.searchIndex.has(t)||e.searchIndex.set(t,[]),e.searchIndex.get(t).push(r)})})}},{key:"generateSearchTerms",value:function(e){var t=[],r="".concat(e.name," ").concat(e.region," ").concat(e.year," ").concat(e.category).toLowerCase();t.push(r),r.split(" ").forEach(function(e){e.length>2&&t.push(e)});for(var n=0;n<r.length-2;n++)t.push(r.substring(n,n+3));return t}},{key:"debounceSearch",value:function(e,t){var r=this;return function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];clearTimeout(r.debounceTimer),r.debounceTimer=setTimeout(function(){return e.apply(r,i)},t)}}},{key:"search",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||e.length<2)return[];if(e===this.lastQuery)return this.lastResults||[];this.lastQuery=e;var n=new Set;this.generateSearchTerms({name:e}).forEach(function(e){(t.searchIndex.get(e)||[]).forEach(function(e){return n.add(e)})});var i=Array.from(n).map(function(e){return t.getAllWines()[e]});return r.category&&(i=i.filter(function(e){return e.category.toLowerCase()===r.category.toLowerCase()})),r.priceRange&&(i=i.filter(function(e){return e.price>=r.priceRange.min&&e.price<=r.priceRange.max})),this.lastResults=i.slice(0,20),this.lastResults}},{key:"getAllWines",value:function(){return[{name:"CRISTOM, EILEEN VYD., PINOT NOIR",region:"Eola-Amity Hills",year:"2019",category:"red",price:185},{name:"NEYERS, CARNEROS CHARDONNAY",region:"Sonoma County",year:"2019",category:"white",price:100}]}}],t&&E(e.prototype,t),r&&E(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P(n.key),n)}}function P(e){var t=function(e,t){if("object"!=O(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=O(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==O(t)?t:t+""}var I=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentTheme=localStorage.getItem("table1837-theme")||"dark",this.init()},(t=[{key:"init",value:function(){this.applyTheme(this.currentTheme),this.setupThemeToggle()}},{key:"applyTheme",value:function(e){document.body.setAttribute("data-theme",e),document.documentElement.setAttribute("data-theme",e),localStorage.setItem("table1837-theme",e),this.currentTheme=e;var t=document.documentElement;"light"===e?(t.style.setProperty("--bg-primary","#ffffff"),t.style.setProperty("--text-primary","#1a1a1a"),t.style.setProperty("--glass-bg","rgba(255, 255, 255, 0.1)")):(t.style.setProperty("--bg-primary","#000000"),t.style.setProperty("--text-primary","#ffffff"),t.style.setProperty("--glass-bg","rgba(0, 0, 0, 0.3)"))}},{key:"setupThemeToggle",value:function(){var e=this,t=document.querySelector("header");if(t){var r=document.createElement("button");r.innerHTML="dark"===this.currentTheme?"☀️":"🌙",r.className="theme-toggle ml-4 p-2 rounded-lg bg-opacity-20 hover:bg-opacity-30 transition-all",r.onclick=function(){return e.toggleTheme()},t.querySelector(".container").appendChild(r)}}},{key:"toggleTheme",value:function(){var e="dark"===this.currentTheme?"light":"dark";this.applyTheme(e);var t=document.querySelector(".theme-toggle");t&&(t.innerHTML="dark"===e?"☀️":"🌙"),this.showThemeNotification(e)}},{key:"showThemeNotification",value:function(e){var t=document.createElement("div");t.className="fixed top-4 right-4 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg z-50",t.textContent="Switched to ".concat(e," theme"),document.body.appendChild(t),setTimeout(function(){t.remove()},2e3)}}])&&C(e.prototype,t),r&&C(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,R(n.key),n)}}function R(e){var t=function(e,t){if("object"!=A(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=A(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==A(t)?t:t+""}var D=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.app=t,this.state=t.state,this.elements=t.elements},(t=[{key:"initialize",value:function(){this.updateTodaySpecial(),this.load86Items()}},{key:"updateTodaySpecial",value:function(){var e={0:{title:"Sunday Steak Night",time:"4p – 8p",description:"Garden Salad • Steak Frites • Glass of House Wine",price:"$40"},3:{title:"Date Night",time:"4p – 8p",description:"2-Dine for $89 • 3-Course Menu • $5 Draft Beer • $10 House Wine",price:"$89"},4:{title:"1837 Bar & Burger Night",time:"4p – 8p",description:"$12.50 Signature Burger OR Crispy Chicken • $5 Draft Beer • $10 House Wine",price:"$12.50"},5:{title:"Late Night Happy Hour",time:"8p – 11p",description:"$5 Draft Beer • $10 House Wines • $10 House Winner Cocktails • $2 Off Curated Cocktails",price:"Various"},6:{title:"Late Night Happy Hour",time:"8p – 11p",description:"$5 Draft Beer • $10 House Wines • $10 House Winner Cocktails • $2 Off Curated Cocktails",price:"Various"}}[(new Date).getDay()],t=document.getElementById("todaySpecial");t&&(t.innerHTML=e?'\n                <div class="flex justify-between items-start mb-3">\n                    <h4 class="text-xl font-bold">'.concat(e.title,'</h4>\n                    <span class="text-lg font-bold text-yellow-400">').concat(e.price,'</span>\n                </div>\n                <p class="text-sm text-gray-400 mb-2">').concat(e.time,'</p>\n                <p class="text-gray-300">').concat(e.description,"</p>\n            "):'\n                <p class="text-gray-300">No special offerings today. Check back tomorrow!</p>\n            ')}},{key:"load86Items",value:function(){var e=document.getElementById("alert86List");e&&(0!==this.state.items86.length?e.innerHTML=this.state.items86.map(function(e){return'\n            <div class="mb-2">\n                <span class="font-semibold text-red-300">'.concat(e.name,'</span>\n                <span class="text-sm text-gray-400 ml-2">- ').concat(e.timestamp,"</span>\n            </div>\n        ")}).join(""):e.innerHTML='<p class="text-gray-300">No items currently 86\'d</p>')}}])&&L(e.prototype,t),r&&L(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,B(n.key),n)}}function B(e){var t=function(e,t){if("object"!=$(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=$(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$(t)?t:t+""}var N=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.app=t,this.state=t.state,this.elements=t.elements},t=[{key:"initialize",value:function(){var e=this;this.display86Items(),this.setupEventListeners(),window.add86Item=function(){return e.add86Item()},window.remove86Item=function(t){return e.remove86Item(t)}}},{key:"setupEventListeners",value:function(){var e=this,t=document.getElementById("item86Input");t&&t.addEventListener("keypress",function(t){"Enter"===t.key&&(t.preventDefault(),e.add86Item())})}},{key:"add86Item",value:function(){var e=document.getElementById("item86Input"),t=e.value.trim();t&&(this.state.items86.push({name:t,timestamp:(new Date).toLocaleString(),addedBy:"Current User"}),localStorage.setItem("items86",JSON.stringify(this.state.items86)),e.value="",this.display86Items(),this.load86Items())}},{key:"remove86Item",value:function(e){this.state.items86.splice(e,1),localStorage.setItem("items86",JSON.stringify(this.state.items86)),this.display86Items(),this.load86Items()}},{key:"display86Items",value:function(){var e=document.getElementById("current86Items");e&&(0!==this.state.items86.length?e.innerHTML=this.state.items86.map(function(e,t){return'\n            <div class="flex justify-between items-center p-3 bg-red-900 bg-opacity-30 border border-red-600 rounded-lg">\n                <div>\n                    <p class="font-semibold">'.concat(e.name,'</p>\n                    <p class="text-sm text-gray-400">Added: ').concat(e.timestamp,'</p>\n                </div>\n                <button onclick="remove86Item(').concat(t,')" class="text-red-400 hover:text-red-300">\n                    <i class="fas fa-times"></i>\n                </button>\n            </div>\n        ')}).join(""):e.innerHTML='<p class="text-gray-400">No items currently 86\'d</p>')}},{key:"load86Items",value:function(){var e=document.getElementById("alert86List");e&&(0!==this.state.items86.length?e.innerHTML=this.state.items86.map(function(e){return'\n            <div class="mb-2">\n                <span class="font-semibold text-red-300">'.concat(e.name,'</span>\n                <span class="text-sm text-gray-400 ml-2">- ').concat(e.timestamp,"</span>\n            </div>\n        ")}).join(""):e.innerHTML='<p class="text-gray-300">No items currently 86\'d</p>')}},{key:"cleanup",value:function(){delete window.add86Item,delete window.remove86Item}}],t&&M(e.prototype,t),r&&M(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}(),U=r(995);function W(e){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(e)}function F(e){return function(e){if(Array.isArray(e))return V(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||J(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,s,o,a=[],c=!0,l=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=s.call(r)).done)&&(a.push(n.value),a.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw i}}return a}}(e,t)||J(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach(function(t){H(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function H(e,t,r){return(t=te(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=J(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw s}}}}function J(e,t){if(e){if("string"==typeof e)return V(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?V(e,t):void 0}}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Y(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function s(r,n,i,s){var c=n&&n.prototype instanceof a?n:a,l=Object.create(c.prototype);return Q(l,"_invoke",function(r,n,i){var s,a,c,l=0,u=i||[],h=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,r){return s=t,a=0,c=e,d.n=r,o}};function f(r,n){for(a=r,c=n,t=0;!h&&l&&!i&&t<u.length;t++){var i,s=u[t],f=d.p,p=s[2];r>3?(i=p===n)&&(c=s[(a=s[4])?5:(a=3,3)],s[4]=s[5]=e):s[0]<=f&&((i=r<2&&f<s[1])?(a=0,d.v=n,d.n=s[1]):f<p&&(i=r<3||s[0]>n||n>p)&&(s[4]=r,s[5]=n,d.n=p,a=0))}if(i||r>1)return o;throw h=!0,n}return function(i,u,p){if(l>1)throw TypeError("Generator is already running");for(h&&1===u&&f(u,p),a=u,c=p;(t=a<2?e:c)||!h;){s||(a?a<3?(a>1&&(d.n=-1),f(a,c)):d.n=c:d.v=c);try{if(l=2,s){if(a||(i="next"),t=s[i]){if(!(t=t.call(s,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,a<2&&(a=0)}else 1===a&&(t=s.return)&&t.call(s),a<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),a=1);s=e}else if((t=(h=d.n<0)?c:r.call(n,d))!==o)break}catch(t){s=e,a=1,c=t}finally{l=1}}return{value:t,done:h}}}(r,i,s),!0),l}var o={};function a(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(Q(t={},n,function(){return this}),t),h=l.prototype=a.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,Q(e,i,"GeneratorFunction")),e.prototype=Object.create(h),e}return c.prototype=l,Q(h,"constructor",l),Q(l,"constructor",c),c.displayName="GeneratorFunction",Q(l,i,"GeneratorFunction"),Q(h),Q(h,i,"Generator"),Q(h,n,function(){return this}),Q(h,"toString",function(){return"[object Generator]"}),(Y=function(){return{w:s,m:d}})()}function Q(e,t,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}Q=function(e,t,r,n){function s(t,r){Q(e,t,function(e){return this._invoke(t,r,e)})}t?i?i(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(s("next",0),s("throw",1),s("return",2))},Q(e,t,r,n)}function Z(e,t,r,n,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,i)}function X(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var s=e.apply(t,r);function o(e){Z(s,n,i,o,a,"next",e)}function a(e){Z(s,n,i,o,a,"throw",e)}o(void 0)})}}function ee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,te(n.key),n)}}function te(e){var t=function(e,t){if("object"!=W(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=W(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==W(t)?t:t+""}var re=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.workers=[],this.isInitialized=!1,this.progressCallback=null,this.retryCount=0,this.maxRetries=3,this.confidenceThreshold=.97,this.textCorrectionModel=null,this.cache=new Map,this.cacheTimeout=3e5},t=[{key:"initialize",value:(w=X(Y().m(function e(){var t,r,n,i,s=this;return Y().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!this.isInitialized){e.n=1;break}return e.a(2);case 1:e.p=1,this.updateProgress(0,"Initializing multi-engine OCR..."),t=[{lang:"eng",psm:6,oem:3},{lang:"eng",psm:8,oem:1},{lang:"eng",psm:3,oem:3}],r=0;case 2:if(!(r<t.length)){e.n=6;break}return n=t[r],this.updateProgress(20*(r+1),"Initializing OCR engine ".concat(r+1,"...")),e.n=3,(0,U.createWorker)(n.lang,1,{logger:function(e){s.progressCallback&&s.progressCallback(e)}});case 3:return i=e.v,e.n=4,i.setParameters({tessedit_char_whitelist:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789$.,()-/&'",tessedit_pageseg_mode:n.psm.toString(),tessedit_ocr_engine_mode:n.oem.toString(),preserve_interword_spaces:"1",textord_heavy_nr:"1",textord_min_linesize:"2.5"});case 4:this.workers.push(i);case 5:r++,e.n=2;break;case 6:return e.n=7,this.initializeTextCorrection();case 7:this.isInitialized=!0,this.updateProgress(100,"Ultra-enhanced OCR ready"),e.n=9;break;case 8:throw e.p=8,e.v;case 9:return e.a(2)}},e,this,[[1,8]])})),function(){return w.apply(this,arguments)})},{key:"initializeTextCorrection",value:(b=X(Y().m(function e(){return Y().w(function(e){for(;;)switch(e.n){case 0:this.wineVocabulary={red:["Pinot Noir","Merlot","Cabernet Sauvignon","Syrah","Zinfandel","Malbec","Sangiovese","Nebbiolo"],white:["Chardonnay","Sauvignon Blanc","Riesling","Pinot Grigio","Gewürztraminer","Viognier","Semillon"],regions:["Napa Valley","Sonoma","Bordeaux","Burgundy","Tuscany","Piedmont","Champagne","Alsace"]},this.foodVocabulary={starters:["Charcuterie","Scallops","Tartare","Salad","Soup","Cheese","Mushroom","Truffle"],entrees:["Duck","Salmon","Beef","Lamb","Pork","Chicken","Risotto","Pasta","Fish"],cooking:["Seared","Pan-Seared","Grilled","Roasted","Braised","Confit","Sous Vide"]};case 1:return e.a(2)}},e,this)})),function(){return b.apply(this,arguments)})},{key:"processImage",value:(v=X(Y().m(function e(t){var r,n,i,s,o,a,c,l,u,h,d=arguments;return Y().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=(r=d.length>1&&void 0!==d[1]?d[1]:{}).menuType,r.specializedProcessing,e.n=1,this.generateCacheKey(t);case 1:if(i=e.v,!this.cache.has(i)){e.n=2;break}if(s=this.cache.get(i),!(Date.now()-s.timestamp<this.cacheTimeout)){e.n=2;break}return this.updateProgress(100,"Returning cached result..."),e.a(2,s.result);case 2:if(this.isInitialized){e.n=3;break}return e.n=3,this.initialize();case 3:return e.p=3,this.updateProgress(10,"Advanced image preprocessing for ".concat(n||"menu","...")),e.n=4,this.createMultiplePreprocessedVersions(t);case 4:return o=e.v,this.updateProgress(30,"Multi-engine text extraction..."),e.n=5,this.extractTextWithMultipleEngines(o);case 5:return a=e.v,this.updateProgress(60,"AI-powered text correction..."),e.n=6,this.correctTextWithAI(a,n);case 6:return c=e.v,this.updateProgress(80,"Advanced ".concat(n||"menu"," parsing...")),e.n=7,this.parseMenuWithAdvancedAlgorithms(c,n);case 7:return l=e.v,this.updateProgress(95,"Validation and confidence scoring..."),e.n=8,this.validateAndScoreResults(l,n);case 8:return u=e.v,this.updateProgress(100,"Processing complete!"),this.cache.set(i,{result:u,timestamp:Date.now(),menuType:n}),e.a(2,u);case 9:return e.p=9,h=e.v,e.n=10,this.handleProcessingError(t,h);case 10:return e.a(2,e.v)}},e,this,[[3,9]])})),function(e){return v.apply(this,arguments)})},{key:"createMultiplePreprocessedVersions",value:(g=X(Y().m(function e(t){var r,n,i,s,o,a,c;return Y().w(function(e){for(;;)switch(e.n){case 0:return n=r=[],e.n=1,this.preprocessImage(t,{contrast:2,brightness:.8,threshold:128,denoise:!0});case 1:return i=e.v,n.push.call(n,i),s=r,e.n=2,this.preprocessImage(t,{contrast:1.5,brightness:1.2,edgeEnhancement:!0,threshold:150});case 2:return o=e.v,s.push.call(s,o),a=r,e.n=3,this.preprocessImage(t,{contrast:1.8,brightness:1,adaptiveThreshold:!0});case 3:return c=e.v,a.push.call(a,c),e.a(2,r)}},e,this)})),function(e){return g.apply(this,arguments)})},{key:"preprocessImage",value:(m=X(Y().m(function e(t){var r,n=this,i=arguments;return Y().w(function(e){for(;;)if(0===e.n)return r=i.length>1&&void 0!==i[1]?i[1]:{},e.a(2,new Promise(function(e){var i=document.createElement("canvas"),s=i.getContext("2d"),o=new Image;o.onload=function(){i.width=o.width,i.height=o.height,s.drawImage(o,0,0);var t=s.getImageData(0,0,i.width,i.height),a=t.data;r.denoise&&n.applyDenoising(a,i.width,i.height),r.edgeEnhancement&&n.applyEdgeEnhancement(a,i.width,i.height);for(var c=0;c<a.length;c+=4){var l=.299*a[c]+.587*a[c+1]+.114*a[c+2];r.contrast&&(l=(l-128)*r.contrast+128),r.brightness&&(l*=r.brightness);var u=r.threshold||128;r.adaptiveThreshold&&(u=n.calculateAdaptiveThreshold(a,c,i.width,i.height));var h=l>u?255:0;a[c]=h,a[c+1]=h,a[c+2]=h,a[c+3]=255}s.putImageData(t,0,0),i.toBlob(function(t){e(t)},"image/png")},o.src=URL.createObjectURL(t)}))},e)})),function(e){return m.apply(this,arguments)})},{key:"applyDenoising",value:function(e,t,r){for(var n=new Uint8ClampedArray(e),i=1;i<r-1;i++)for(var s=1;s<t-1;s++){for(var o=4*(i*t+s),a=[],c=-1;c<=1;c++)for(var l=-1;l<=1;l++){var u=4*((i+c)*t+(s+l));a.push(n[u])}a.sort(function(e,t){return e-t});var h=a[Math.floor(a.length/2)];e[o]=h,e[o+1]=h,e[o+2]=h}}},{key:"applyEdgeEnhancement",value:function(e,t,r){for(var n=new Uint8ClampedArray(e),i=1;i<r-1;i++)for(var s=1;s<t-1;s++){var o=4*(i*t+s),a=n[o],c=4*a-[n[4*((i-1)*t+s)],n[4*(i*t+(s-1))],n[4*(i*t+(s+1))],n[4*((i+1)*t+s)]].reduce(function(e,t){return e+t},0),l=Math.min(255,Math.max(0,a+.5*c));e[o]=l,e[o+1]=l,e[o+2]=l}}},{key:"calculateAdaptiveThreshold",value:function(e,t,r,n){for(var i=t/4%r,s=Math.floor(t/4/r),o=0,a=0,c=-15;c<=15;c++)for(var l=-15;l<=15;l++){var u=i+l,h=s+c;u>=0&&u<r&&h>=0&&h<n&&(o+=e[4*(h*r+u)],a++)}return o/a*.8}},{key:"extractTextWithMultipleEngines",value:(y=X(Y().m(function e(t){var r,n,i,s,o,a,c;return Y().w(function(e){for(;;)switch(e.p=e.n){case 0:r=[],n=0;case 1:if(!(n<this.workers.length)){e.n=8;break}i=0;case 2:if(!(i<t.length)){e.n=7;break}return e.p=3,e.n=4,this.workers[n].recognize(t[i]);case 4:s=e.v,o=s.data,a=o.text,c=o.confidence,r.push({text:a,confidence:c,engine:n,version:i}),e.n=6;break;case 5:e.p=5,e.v;case 6:i++,e.n=2;break;case 7:n++,e.n=1;break;case 8:return e.a(2,r)}},e,this,[[3,5]])})),function(e){return y.apply(this,arguments)})},{key:"correctTextWithAI",value:(p=X(Y().m(function e(t,r){var n,i,s,o,a,c;return Y().w(function(e){for(;;)switch(e.p=e.n){case 0:n=[],i=K(t),e.p=1,i.s();case 2:if((s=i.n()).done){e.n=5;break}return o=s.value,e.n=3,this.applyTextCorrection(o.text,r);case 3:a=e.v,n.push(G(G({},o),{},{correctedText:a,originalText:o.text}));case 4:e.n=2;break;case 5:e.n=7;break;case 6:e.p=6,c=e.v,i.e(c);case 7:return e.p=7,i.f(),e.f(7);case 8:return e.a(2,n)}},e,this,[[1,6,7,8]])})),function(e,t){return p.apply(this,arguments)})},{key:"applyTextCorrection",value:(f=X(Y().m(function e(t,r){var n,i;return Y().w(function(e){for(;;)switch(e.n){case 0:n=t,i=r,e.n="wine"===i?1:"cocktails"===i?3:"food"===i?5:"featured"===i||"specials"===i?7:9;break;case 1:return e.n=2,this.applyWineCorrections(n);case 2:return n=e.v,e.a(3,11);case 3:return e.n=4,this.applyCocktailCorrections(n);case 4:return n=e.v,e.a(3,11);case 5:return e.n=6,this.applyFoodCorrections(n);case 6:return n=e.v,e.a(3,11);case 7:return e.n=8,this.applyFeaturedCorrections(n);case 8:return n=e.v,e.a(3,11);case 9:return e.n=10,this.applyGeneralCorrections(n);case 10:n=e.v;case 11:return e.a(2,n)}},e,this)})),function(e,t){return f.apply(this,arguments)})},{key:"applyWineCorrections",value:(d=X(Y().m(function e(t){var r,n,i,s,o,a,c,l,u,h,d,f;return Y().w(function(e){for(;;)if(0===e.n){for(r=t,n=0,i=["red","white"];n<i.length;n++){s=i[n],o=K(this.wineVocabulary[s]);try{for(o.s();!(a=o.n()).done;)c=a.value,l=new RegExp(this.createFuzzyPattern(c),"gi"),r=r.replace(l,c)}catch(e){o.e(e)}finally{o.f()}}u=K(this.wineVocabulary.regions);try{for(u.s();!(h=u.n()).done;)d=h.value,f=new RegExp(this.createFuzzyPattern(d),"gi"),r=r.replace(f,d)}catch(e){u.e(e)}finally{u.f()}return e.a(2,r)}},e,this)})),function(e){return d.apply(this,arguments)})},{key:"applyCocktailCorrections",value:(h=X(Y().m(function e(t){var r,n,i,s,o,a,c,l,u;return Y().w(function(e){for(;;)if(0===e.n){for(r=t,n={spirits:["Vodka","Gin","Rum","Tequila","Whiskey","Bourbon","Scotch","Brandy","Cognac"],mixers:["Tonic","Soda","Juice","Syrup","Bitters","Vermouth","Campari","Cointreau"],garnishes:["Lime","Lemon","Orange","Mint","Olive","Cherry","Celery","Salt","Sugar"]},i=0,s=Object.values(n);i<s.length;i++){o=s[i],a=K(o);try{for(a.s();!(c=a.n()).done;)l=c.value,u=new RegExp(this.createFuzzyPattern(l),"gi"),r=r.replace(u,l)}catch(e){a.e(e)}finally{a.f()}}return e.a(2,r)}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"applyFoodCorrections",value:(u=X(Y().m(function e(t){var r,n,i,s,o,a,c,l,u,h,d,f;return Y().w(function(e){for(;;)if(0===e.n){for(r=t,n=0,i=["starters","entrees"];n<i.length;n++){s=i[n],o=K(this.foodVocabulary[s]);try{for(o.s();!(a=o.n()).done;)c=a.value,l=new RegExp(this.createFuzzyPattern(c),"gi"),r=r.replace(l,c)}catch(e){o.e(e)}finally{o.f()}}u=K(this.foodVocabulary.cooking);try{for(u.s();!(h=u.n()).done;)d=h.value,f=new RegExp(this.createFuzzyPattern(d),"gi"),r=r.replace(f,d)}catch(e){u.e(e)}finally{u.f()}return e.a(2,r)}},e,this)})),function(e){return u.apply(this,arguments)})},{key:"applyFeaturedCorrections",value:(l=X(Y().m(function e(t){var r,n,i,s,o,a,c,l,u;return Y().w(function(e){for(;;)if(0===e.n){for(r=t,n={descriptors:["Featured","Special","Chef's","Daily","Limited","Seasonal","Signature"],categories:["Appetizer","Entree","Dessert","Drink","Cocktail","Wine"]},i=0,s=Object.values(n);i<s.length;i++){o=s[i],a=K(o);try{for(a.s();!(c=a.n()).done;)l=c.value,u=new RegExp(this.createFuzzyPattern(l),"gi"),r=r.replace(u,l)}catch(e){a.e(e)}finally{a.f()}}return e.a(2,r)}},e,this)})),function(e){return l.apply(this,arguments)})},{key:"applyGeneralCorrections",value:(c=X(Y().m(function e(t){var r;return Y().w(function(e){for(;;)switch(e.n){case 0:return r=t,e.n=1,this.applyWineCorrections(r);case 1:return r=e.v,e.n=2,this.applyCocktailCorrections(r);case 2:return r=e.v,e.n=3,this.applyFoodCorrections(r);case 3:return r=e.v,e.n=4,this.applyFeaturedCorrections(r);case 4:return r=e.v,e.a(2,r)}},e,this)})),function(e){return c.apply(this,arguments)})},{key:"createFuzzyPattern",value:function(e){return e.split("").map(function(e){return{0:"[0O]",O:"[0O]",1:"[1Il]",I:"[1Il]",l:"[1Il]",5:"[5S]",S:"[5S]",8:"[8B]",B:"[8B]",a:"[a@]","@":"[a@]",e:"[e3]",3:"[e3]"}[e.toLowerCase()]||e}).join("")}},{key:"parseMenuWithAdvancedAlgorithms",value:(a=X(Y().m(function e(t){var r,n,i,s,o,a,c,l,u;return Y().w(function(e){for(;;)if(0===e.n){for(r=t.map(function(e){return e.correctedText}).join("\n"),n=[this.parseWithAdvancedSectionDetection,this.parseWithMachineLearning,this.parseWithSemanticAnalysis],i=null,s=0,o=0,a=n;o<a.length;o++){c=a[o];try{l=c.call(this,r),(u=this.calculateAdvancedConfidenceScore(l,t))>s&&(s=u,i=G(G({},l),{},{confidence:u}))}catch(e){}}return e.a(2,i||this.createFallbackResult())}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"parseWithAdvancedSectionDetection",value:function(e){var t,r=e.split("\n").filter(function(e){return e.trim()}),n=this.initializeResultStructure(),i=null,s=.9,o=K(r);try{for(o.s();!(t=o.n()).done;){var a=t.value.trim();if(a){var c=this.detectSectionWithConfidence(a);c.section&&c.confidence>.8?(i=c.section,s=c.confidence):this.parseLineWithAdvancedContext(a,i,n,s)}}}catch(e){o.e(e)}finally{o.f()}return n}},{key:"detectSectionWithConfidence",value:function(e){for(var t=0,r=Object.entries({redWine:{patterns:[/(red\s+wine|pinot\s+noir|merlot|cabernet|syrah|zinfandel)/i],keywords:["red","wine","pinot","merlot","cabernet"],confidence:.9},whiteWine:{patterns:[/(white\s+wine|chardonnay|sauvignon|riesling|pinot\s+grigio)/i],keywords:["white","wine","chardonnay","sauvignon","riesling"],confidence:.9},starters:{patterns:[/(starters?|appetizers?|hors\s+d'oeuvres?)/i],keywords:["starter","appetizer","hors"],confidence:.85},entrees:{patterns:[/(entrees?|main\s+courses?|dishes?)/i],keywords:["entree","main","course","dish"],confidence:.85}});t<r.length;t++){var n,i=z(r[t],2),s=i[0],o=i[1],a=K(o.patterns);try{for(a.s();!(n=a.n()).done;)if(n.value.test(e))return{section:s,confidence:o.confidence}}catch(e){a.e(e)}finally{a.f()}var c=o.keywords.filter(function(t){return e.toLowerCase().includes(t)}).length;if(c>0)return{section:s,confidence:o.confidence*(c/o.keywords.length)}}return{section:null,confidence:0}}},{key:"parseLineWithAdvancedContext",value:function(e,t,r,n){var i=(n+this.calculateLineConfidence(e))/2;if(!(i<.7))switch(t){case"redWine":!r.redWine&&this.isWineLine(e)&&(r.redWine=this.parseWineLineWithConfidence(e,i));break;case"whiteWine":!r.whiteWine&&this.isWineLine(e)&&(r.whiteWine=this.parseWineLineWithConfidence(e,i));break;case"starters":this.isFoodLine(e)&&(r.starters=r.starters||[],r.starters.push({name:this.cleanFoodText(e),confidence:i}));break;case"entrees":this.isFoodLine(e)&&(r.entrees=r.entrees||[],r.entrees.push({name:this.cleanFoodText(e),confidence:i}))}}},{key:"parseWithMachineLearning",value:function(e){for(var t=this.initializeResultStructure(),r=0,n=[/([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*),\s*([^,]+),\s*(\d{4})\s*\$(\d+)/g,/([A-Z][a-z]+(?:\s+[A-Z][a-z]+)*)\s*\$(\d+)/g];r<n.length;r++){var i,s=n[r],o=K(F(e.matchAll(s)));try{for(o.s();!(i=o.n()).done;){var a=i.value,c=this.parseWineFromMatch(a);this.isRedWine(c.name)&&!t.redWine?t.redWine=c:this.isWhiteWine(c.name)&&!t.whiteWine&&(t.whiteWine=c)}}catch(e){o.e(e)}finally{o.f()}}return t}},{key:"parseWithSemanticAnalysis",value:function(e){var t,r=this.initializeResultStructure(),n=K(e.split("\n"));try{for(n.s();!(t=n.n()).done;){var i=t.value.trim();if(i){if(this.hasWineSemantics(i)){var s=this.parseWineLineWithConfidence(i,.95);this.isRedWine(s.name)&&!r.redWine?r.redWine=s:this.isWhiteWine(s.name)&&!r.whiteWine&&(r.whiteWine=s)}if(this.hasFoodSemantics(i)){var o={name:this.cleanFoodText(i),confidence:.9};this.isStarterSemantics(i)?(r.starters=r.starters||[],r.starters.push(o)):(r.entrees=r.entrees||[],r.entrees.push(o))}}}}catch(e){n.e(e)}finally{n.f()}return r}},{key:"hasWineSemantics",value:function(e){return["vineyard","estate","reserve","vintage","chateau","domaine"].some(function(t){return e.toLowerCase().includes(t)})||this.isWineLine(e)}},{key:"hasFoodSemantics",value:function(e){return["with","served","accompanied","garnished","topped"].some(function(t){return e.toLowerCase().includes(t)})||this.isFoodLine(e)}},{key:"isStarterSemantics",value:function(e){return["starter","appetizer","small","light","beginning"].some(function(t){return e.toLowerCase().includes(t)})}},{key:"calculateAdvancedConfidenceScore",value:function(e,t){var r=0,n=0;return r+=t.reduce(function(e,t){return e+t.confidence},0)/t.length*.4,n+=.4,e.redWine&&(r+=.2*e.redWine.confidence,n+=.2),e.whiteWine&&(r+=.2*e.whiteWine.confidence,n+=.2),e.starters&&e.starters.length>0&&(r+=e.starters.reduce(function(e,t){return e+t.confidence},0)/e.starters.length*.1,n+=.1),e.entrees&&e.entrees.length>0&&(r+=e.entrees.reduce(function(e,t){return e+t.confidence},0)/e.entrees.length*.1,n+=.1),n>0?r/n:0}},{key:"validateAndScoreResults",value:(o=X(Y().m(function e(t){var r,n=this;return Y().w(function(e){for(;;)if(0===e.n)return(r=G({},t)).redWine&&(r.redWine=this.validateWineData(r.redWine)),r.whiteWine&&(r.whiteWine=this.validateWineData(r.whiteWine)),r.starters&&(r.starters=r.starters.filter(function(e){return n.validateFoodData(e)}).map(function(e){return n.cleanFoodData(e)})),r.entrees&&(r.entrees=r.entrees.filter(function(e){return n.validateFoodData(e)}).map(function(e){return n.cleanFoodData(e)})),r.confidence=this.calculateFinalConfidence(r),e.a(2,r)},e,this)})),function(e){return o.apply(this,arguments)})},{key:"validateWineData",value:function(e){return!e.name||e.name.length<3?null:(e.price.startsWith("$")||(e.price="$".concat(e.price.replace(/[^\d]/g,""))),e.year&&!/^\d{4}$/.test(e.year)&&(e.year=""),e)}},{key:"validateFoodData",value:function(e){return e.name&&e.name.length>3&&e.confidence>.7}},{key:"cleanFoodData",value:function(e){return{name:e.name,confidence:e.confidence}}},{key:"calculateFinalConfidence",value:function(e){var t=0,r=0;return e.redWine&&(t+=e.redWine.confidence,r++),e.whiteWine&&(t+=e.whiteWine.confidence,r++),e.starters&&e.starters.length>0&&(t+=e.starters.reduce(function(e,t){return e+t.confidence},0)/e.starters.length,r++),e.entrees&&e.entrees.length>0&&(t+=e.entrees.reduce(function(e,t){return e+t.confidence},0)/e.entrees.length,r++),r>0?t/r:0}},{key:"initializeResultStructure",value:function(){return{redWine:null,whiteWine:null,starters:[],entrees:[],cocktail:null,specials:[],confidence:0}}},{key:"createFallbackResult",value:function(){return{redWine:null,whiteWine:null,starters:[],entrees:[],cocktail:null,specials:[],confidence:.5,error:"Advanced parsing failed"}}},{key:"isWineLine",value:function(e){return["pinot noir","merlot","cabernet","chardonnay","sauvignon","riesling","syrah","zinfandel","malbec","sangiovese","pinot grigio","gewürztraminer"].some(function(t){return e.toLowerCase().includes(t)})}},{key:"isRedWine",value:function(e){return["pinot noir","merlot","cabernet","syrah","zinfandel","malbec","sangiovese"].some(function(t){return e.toLowerCase().includes(t)})}},{key:"isWhiteWine",value:function(e){return["chardonnay","sauvignon","riesling","pinot grigio","gewürztraminer","viognier"].some(function(t){return e.toLowerCase().includes(t)})}},{key:"isFoodLine",value:function(e){return["salmon","duck","chicken","beef","pork","lamb","fish","shrimp","scallop","risotto","pasta","salad","soup","tartare","charcuterie","cheese","mushroom"].some(function(t){return e.toLowerCase().includes(t)})||e.length>5&&!e.match(/^\d+$/)&&!e.match(/^\$\d+/)}},{key:"cleanFoodText",value:function(e){return e.replace(/\$(\d+)/,"").replace(/^\d+\.\s*/,"").trim()}},{key:"calculateLineConfidence",value:function(e){var t=.8;return e.includes("$")&&(t+=.1),/\d{4}/.test(e)&&(t+=.05),/[A-Z]/.test(e)&&(t+=.05),Math.min(1,t)}},{key:"parseWineLineWithConfidence",value:function(e,t){var r=e.match(/\$(\d+)/),n=e.match(/(\d{4})/),i=r?"$".concat(r[1]):"$0",s=n?n[1]:"",o=e,a="";s&&(o=e.split(s)[0].trim());var c=e.split(",");return c.length>1&&(o=c[0].trim(),a=(a=c.slice(1).join(",").trim()).replace(/\d{4}/,"").trim()),{name:o=o.replace(/\$(\d+)/,"").trim(),region:a,year:s,price:i,confidence:t}}},{key:"parseWineFromMatch",value:function(e){return e.length>=5?{name:e[1].trim(),region:e[2].trim(),year:e[3],price:"$".concat(e[4]),confidence:.95}:{name:e[1].trim(),region:"",year:"",price:"$".concat(e[2]),confidence:.9}}},{key:"handleProcessingError",value:(s=X(Y().m(function e(t,r){return Y().w(function(e){for(;;)switch(e.n){case 0:if(!(this.retryCount<this.maxRetries)){e.n=3;break}return this.retryCount++,e.n=1,new Promise(function(e){return setTimeout(e,1e3)});case 1:return e.n=2,this.processImage(t);case 2:return e.a(2,e.v);case 3:return e.a(2,{redWine:null,whiteWine:null,starters:[],entrees:[],cocktail:null,specials:[],confidence:.5,error:r.message,rawText:"Ultra-enhanced OCR processing failed after all retries"});case 4:return e.a(2)}},e,this)})),function(e,t){return s.apply(this,arguments)})},{key:"setProgressCallback",value:function(e){this.progressCallback=e}},{key:"updateProgress",value:function(e,t){this.progressCallback&&this.progressCallback({percent:e,message:t})}},{key:"generateCacheKey",value:(i=X(Y().m(function e(t){var r,n;return Y().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,t.arrayBuffer();case 1:return r=e.v,e.n=2,crypto.subtle.digest("SHA-256",r);case 2:return n=e.v,e.a(2,Array.from(new Uint8Array(n)).map(function(e){return e.toString(16).padStart(2,"0")}).join(""))}},e)})),function(e){return i.apply(this,arguments)})},{key:"terminate",value:(n=X(Y().m(function e(){var t,r,n,i;return Y().w(function(e){for(;;)switch(e.p=e.n){case 0:t=K(this.workers),e.p=1,t.s();case 2:if((r=t.n()).done){e.n=4;break}return n=r.value,e.n=3,n.terminate();case 3:e.n=2;break;case 4:e.n=6;break;case 5:e.p=5,i=e.v,t.e(i);case 6:return e.p=6,t.f(),e.f(6);case 7:this.workers=[],this.isInitialized=!1;case 8:return e.a(2)}},e,this,[[1,5,6,7]])})),function(){return n.apply(this,arguments)})}],t&&ee(e.prototype,t),r&&ee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,n,i,s,o,a,c,l,u,h,d,f,p,y,m,g,v,b,w}();function ne(e){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ne(e)}function ie(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function s(r,n,i,s){var c=n&&n.prototype instanceof a?n:a,l=Object.create(c.prototype);return se(l,"_invoke",function(r,n,i){var s,a,c,l=0,u=i||[],h=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,r){return s=t,a=0,c=e,d.n=r,o}};function f(r,n){for(a=r,c=n,t=0;!h&&l&&!i&&t<u.length;t++){var i,s=u[t],f=d.p,p=s[2];r>3?(i=p===n)&&(c=s[(a=s[4])?5:(a=3,3)],s[4]=s[5]=e):s[0]<=f&&((i=r<2&&f<s[1])?(a=0,d.v=n,d.n=s[1]):f<p&&(i=r<3||s[0]>n||n>p)&&(s[4]=r,s[5]=n,d.n=p,a=0))}if(i||r>1)return o;throw h=!0,n}return function(i,u,p){if(l>1)throw TypeError("Generator is already running");for(h&&1===u&&f(u,p),a=u,c=p;(t=a<2?e:c)||!h;){s||(a?a<3?(a>1&&(d.n=-1),f(a,c)):d.n=c:d.v=c);try{if(l=2,s){if(a||(i="next"),t=s[i]){if(!(t=t.call(s,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,a<2&&(a=0)}else 1===a&&(t=s.return)&&t.call(s),a<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),a=1);s=e}else if((t=(h=d.n<0)?c:r.call(n,d))!==o)break}catch(t){s=e,a=1,c=t}finally{l=1}}return{value:t,done:h}}}(r,i,s),!0),l}var o={};function a(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(se(t={},n,function(){return this}),t),h=l.prototype=a.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,se(e,i,"GeneratorFunction")),e.prototype=Object.create(h),e}return c.prototype=l,se(h,"constructor",l),se(l,"constructor",c),c.displayName="GeneratorFunction",se(l,i,"GeneratorFunction"),se(h),se(h,i,"Generator"),se(h,n,function(){return this}),se(h,"toString",function(){return"[object Generator]"}),(ie=function(){return{w:s,m:d}})()}function se(e,t,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}se=function(e,t,r,n){function s(t,r){se(e,t,function(e){return this._invoke(t,r,e)})}t?i?i(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(s("next",0),s("throw",1),s("return",2))},se(e,t,r,n)}function oe(e,t,r,n,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,i)}function ae(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var s=e.apply(t,r);function o(e){oe(s,n,i,o,a,"next",e)}function a(e){oe(s,n,i,o,a,"throw",e)}o(void 0)})}}function ce(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,le(n.key),n)}}function le(e){var t=function(e,t){if("object"!=ne(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ne(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ne(t)?t:t+""}var ue=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.app=t,this.state=t.state,this.elements=t.elements,this.ocrService=new re},t=[{key:"initialize",value:function(){this.setupMessageForm(),this.setupOCRFunctionality()}},{key:"setupMessageForm",value:function(){var e=this,t=document.getElementById("adminMessageForm");t&&t.addEventListener("submit",function(t){t.preventDefault(),e.handleMessageSubmit(t)})}},{key:"setupOCRFunctionality",value:function(){var e=this,t=document.getElementById("ocrFileUpload"),r=document.getElementById("menuTypeSelector"),n=(document.getElementById("ocrPreviewContainer"),document.getElementById("ocrResultContainer"),document.getElementById("ocrPreview"),document.getElementById("processOcrButton")),i=document.getElementById("applyOcrButton");this.ocrService.setProgressCallback(function(t){var r=t.percent,n=t.message;e.updateOCRProgress(r,n)}),r&&r.addEventListener("change",function(t){e.handleMenuTypeChange(t)}),t&&t.addEventListener("change",function(t){e.handleFileUpload(t)}),n&&n.addEventListener("click",function(){e.processOCR()}),i&&i.addEventListener("click",function(){e.applyOCRResults()})}},{key:"handleMenuTypeChange",value:function(e){var t=e.target.value,r=document.getElementById("ocrFileUpload"),n=null==r?void 0:r.parentElement;if(n){var i=n.querySelector("p:last-child");i&&(t?(i.textContent="Ready to upload ".concat(this.getMenuTypeDisplayName(t)),i.className="text-xs text-green-400 mt-1"):(i.textContent="Select menu type above first",i.className="text-xs text-gray-400 mt-1"))}}},{key:"getMenuTypeDisplayName",value:function(e){return{wine:"🍷 Wine List",cocktails:"🍸 Cocktail Menu",featured:"⭐ Featured Menu",food:"🍽️ Food Menu",specials:"🎯 Daily Specials"}[e]||"menu"}},{key:"handleFileUpload",value:function(e){var t,r=this,n=e.target.files[0],i=null===(t=document.getElementById("menuTypeSelector"))||void 0===t?void 0:t.value,s=document.getElementById("ocrPreview"),o=document.getElementById("ocrPreviewContainer"),a=document.getElementById("ocrResultContainer");if(!i)return this.showToast("Please select a menu type first!","warning"),void(e.target.value="");n&&s&&o&&a&&(this.currentMenuType=i,this.optimizeImage(n).then(function(e){var t=new FileReader;t.onload=function(e){s.src=e.target.result,o.classList.remove("hidden"),a.classList.add("hidden");var t=document.getElementById("processOcrButton");t&&(t.innerHTML='<i class="fas fa-magic mr-2"></i> Process '.concat(r.getMenuTypeDisplayName(i)))},t.readAsDataURL(e)}))}},{key:"optimizeImage",value:(i=ae(ie().m(function e(t){return ie().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e){var r=document.createElement("canvas"),n=r.getContext("2d"),i=new Image;i.onload=function(){var t=i.width,s=i.height;t>800&&(s=800*s/t,t=800),s>600&&(t=600*t/s,s=600),r.width=t,r.height=s,n.drawImage(i,0,0,t,s),r.toBlob(e,"image/jpeg",.8)},i.src=URL.createObjectURL(t)}))},e)})),function(e){return i.apply(this,arguments)})},{key:"processOCR",value:(n=ae(ie().m(function e(){var t,r,n,i,s,o,a;return ie().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=document.getElementById("ocrFileUpload"),r=document.getElementById("processOcrButton"),n=document.getElementById("ocrResultContainer"),i=document.getElementById("ocrResult"),t.files[0]){e.n=1;break}return this.showToast("Please upload an image first!","warning"),e.a(2);case 1:if(this.currentMenuType){e.n=2;break}return this.showToast("Please select a menu type first!","warning"),e.a(2);case 2:return r.disabled=!0,r.innerHTML='<i class="fas fa-spinner fa-spin mr-2"></i>Processing...',i.innerHTML='<p class="text-center"><i class="fas fa-spinner fa-spin mr-2"></i> Processing '.concat(this.getMenuTypeDisplayName(this.currentMenuType)," with enhanced OCR...</p>"),n.classList.remove("hidden"),s=performance.now(),e.p=3,e.n=4,this.ocrService.processImage(t.files[0],{menuType:this.currentMenuType,specializedProcessing:!0});case 4:o=e.v,a=performance.now()-s,this.app.services.monitor&&this.app.services.monitor.trackOCRProcessing(a,o.confidence),this.state.ocrData={menuType:this.currentMenuType,redWine:o.redWine,whiteWine:o.whiteWine,starters:o.starters||[],entrees:o.entrees||[],cocktail:o.cocktail,specials:o.specials||[],confidence:o.confidence,processedAt:(new Date).toISOString()},this.displayOCRResults(),o.confidence&&this.showConfidenceScore(o.confidence),e.n=6;break;case 5:e.p=5,e.v,i.innerHTML='<p class="text-red-500">OCR processing failed. Please try again.</p>';case 6:return e.p=6,r.disabled=!1,r.innerHTML='<i class="fas fa-magic mr-2"></i> Process Image',e.f(6);case 7:return e.a(2)}},e,this,[[3,5,6,7]])})),function(){return n.apply(this,arguments)})},{key:"simulateOCR",value:function(e){var t=this,r=document.getElementById("ocrResult"),n=document.getElementById("ocrResultContainer");r&&n&&(r.innerHTML='<p class="text-center"><i class="fas fa-spinner fa-spin mr-2"></i> Processing image...</p>',n.classList.remove("hidden"),setTimeout(function(){t.state.ocrData={redWine:{name:"INSIGNIA, JOSEPH PHELPS ESTATE",region:"Napa Valley, CA, 2014",price:"$305",code:"R051"},whiteWine:{name:"RAMEY, RUSSIAN RIVER VALLEY",region:"California, 2021",price:"$120",code:"C016"},starters:["House-Made Charcuterie Board with Artisanal Cheeses","Seared Sea Scallops with Citrus Beurre Blanc"],entrees:["Pan-Seared Duck Breast with Cherry Reduction","Wild Mushroom Risotto with Black Truffle"],cocktail:{name:"Barrel-Aged Manhattan",description:"Aged bourbon, sweet vermouth, bitters",price:"$14"}},t.displayOCRResults()},1500))}},{key:"displayOCRResults",value:function(){var e=document.getElementById("ocrResult");if(e){var t='<div class="space-y-4">';if(this.state.ocrData.menuType){var r=this.getMenuTypeDisplayName(this.state.ocrData.menuType);t+='\n                <div class="bg-blue-600 bg-opacity-20 p-3 rounded-lg mb-4 border-l-4 border-blue-400">\n                    <h4 class="font-bold text-blue-400 mb-1">📋 Menu Type: '.concat(r,'</h4>\n                    <p class="text-sm text-gray-300">Processed with specialized ').concat(this.state.ocrData.menuType," recognition</p>\n                    ").concat(this.state.ocrData.processedAt?'<p class="text-xs text-gray-400 mt-1">Processed: '.concat(new Date(this.state.ocrData.processedAt).toLocaleString(),"</p>"):"","\n                </div>\n            ")}if(this.state.ocrData.redWine||this.state.ocrData.whiteWine){if(t+='<h4 class="font-bold text-yellow-400 mb-2">Featured Wines:</h4>',this.state.ocrData.redWine){var n=Math.round(100*(this.state.ocrData.redWine.confidence||.9)),i=n>=97?"text-green-400":n>=90?"text-yellow-400":"text-red-400";t+='\n                    <div class="bg-black bg-opacity-20 p-3 rounded-lg mb-2">\n                        <p><span class="font-semibold">Red:</span> '.concat(this.state.ocrData.redWine.name," - ").concat(this.state.ocrData.redWine.price,'</p>\n                        <p class="text-sm text-gray-400">').concat(this.state.ocrData.redWine.region," ").concat(this.state.ocrData.redWine.year?"(".concat(this.state.ocrData.redWine.year,")"):"",'</p>\n                        <div class="flex items-center mt-1">\n                            <span class="text-xs ').concat(i,'">Confidence: ').concat(n,"%</span>\n                        </div>\n                    </div>\n                ")}if(this.state.ocrData.whiteWine){var s=Math.round(100*(this.state.ocrData.whiteWine.confidence||.9)),o=s>=97?"text-green-400":s>=90?"text-yellow-400":"text-red-400";t+='\n                    <div class="bg-black bg-opacity-20 p-3 rounded-lg mb-2">\n                        <p><span class="font-semibold">White:</span> '.concat(this.state.ocrData.whiteWine.name," - ").concat(this.state.ocrData.whiteWine.price,'</p>\n                        <p class="text-sm text-gray-400">').concat(this.state.ocrData.whiteWine.region," ").concat(this.state.ocrData.whiteWine.year?"(".concat(this.state.ocrData.whiteWine.year,")"):"",'</p>\n                        <div class="flex items-center mt-1">\n                            <span class="text-xs ').concat(o,'">Confidence: ').concat(s,"%</span>\n                        </div>\n                    </div>\n                ")}}if(this.state.ocrData.starters&&this.state.ocrData.starters.length>0&&(t+='<h4 class="font-bold text-yellow-400 mt-4 mb-2">Starters:</h4>',t+='<ul class="list-disc pl-4 mb-2">',this.state.ocrData.starters.forEach(function(e){var r="string"==typeof e?e:e.name,n="string"==typeof e?.9:e.confidence||.9,i=Math.round(100*n),s=i>=97?"text-green-400":i>=90?"text-yellow-400":"text-red-400";t+='\n                    <li class="mb-1">\n                        '.concat(r,'\n                        <span class="text-xs ').concat(s,' ml-2">(').concat(i,"%)</span>\n                    </li>\n                ")}),t+="</ul>"),this.state.ocrData.entrees&&this.state.ocrData.entrees.length>0&&(t+='<h4 class="font-bold text-yellow-400 mt-4 mb-2">Entrees:</h4>',t+='<ul class="list-disc pl-4 mb-2">',this.state.ocrData.entrees.forEach(function(e){var r="string"==typeof e?e:e.name,n="string"==typeof e?.9:e.confidence||.9,i=Math.round(100*n),s=i>=97?"text-green-400":i>=90?"text-yellow-400":"text-red-400";t+='\n                    <li class="mb-1">\n                        '.concat(r,'\n                        <span class="text-xs ').concat(s,' ml-2">(').concat(i,"%)</span>\n                    </li>\n                ")}),t+="</ul>"),this.state.ocrData.cocktail){t+='<h4 class="font-bold text-yellow-400 mt-4 mb-2">Featured Cocktail:</h4>';var a=Math.round(100*(this.state.ocrData.cocktail.confidence||.9)),c=a>=97?"text-green-400":a>=90?"text-yellow-400":"text-red-400";t+='\n                <div class="bg-black bg-opacity-20 p-3 rounded-lg">\n                    <p>'.concat(this.state.ocrData.cocktail.name," - ").concat(this.state.ocrData.cocktail.price,'</p>\n                    <p class="text-sm text-gray-400">').concat(this.state.ocrData.cocktail.description||"",'</p>\n                    <div class="flex items-center mt-1">\n                        <span class="text-xs ').concat(c,'">Confidence: ').concat(a,"%</span>\n                    </div>\n                </div>\n            ")}t+="</div>",e.innerHTML=t}}},{key:"applyOCRResults",value:function(){var e=document.querySelectorAll(".featured-wine");if(this.state.ocrData.redWine&&e[0]){var t=e[0],r=t.querySelector("p:nth-child(2)"),n=t.querySelector("p:nth-child(3)"),i=t.querySelector("p:nth-child(4)"),s=t.querySelector("p:nth-child(5)");r&&(r.textContent=this.state.ocrData.redWine.name),n&&(n.textContent=this.state.ocrData.redWine.region),i&&(i.textContent=this.state.ocrData.redWine.price),s&&(s.textContent="(".concat(this.state.ocrData.redWine.code||"N/A",")"))}if(this.state.ocrData.whiteWine&&e[1]){var o=e[1],a=o.querySelector("p:nth-child(2)"),c=o.querySelector("p:nth-child(3)"),l=o.querySelector("p:nth-child(4)"),u=o.querySelector("p:nth-child(5)");a&&(a.textContent=this.state.ocrData.whiteWine.name),c&&(c.textContent=this.state.ocrData.whiteWine.region),l&&(l.textContent=this.state.ocrData.whiteWine.price),u&&(u.textContent="(".concat(this.state.ocrData.whiteWine.code||"N/A",")"))}if(this.state.ocrData.starters&&this.state.ocrData.starters.length>=2){var h,d=document.querySelectorAll(".food-special-card .grid div p"),f="string"==typeof this.state.ocrData.starters[0]?this.state.ocrData.starters[0]:this.state.ocrData.starters[0].name,p="string"==typeof this.state.ocrData.starters[1]?this.state.ocrData.starters[1]:(null===(h=this.state.ocrData.starters[1])||void 0===h?void 0:h.name)||"";d[0]&&(d[0].textContent=f),d[1]&&(d[1].textContent=p)}if(this.state.ocrData.entrees&&this.state.ocrData.entrees.length>0){var y=document.querySelectorAll(".food-special-card .grid div p"),m="string"==typeof this.state.ocrData.entrees[0]?this.state.ocrData.entrees[0]:this.state.ocrData.entrees[0].name;y[2]&&(y[2].textContent=m)}var g=this.state.ocrData.confidence||.95,v=Math.round(100*g),b="OCR results applied successfully! (".concat(v,v>=97?"% accuracy)":"% accuracy - please verify)");this.showToast(b,v>=97?"success":"warning")}},{key:"updateOCRProgress",value:function(e,t){var r=document.getElementById("processOcrButton"),n=document.getElementById("ocrResult");r&&(r.innerHTML='<i class="fas fa-spinner fa-spin mr-2"></i>'.concat(t," (").concat(e,"%)")),n&&e<100&&(n.innerHTML='<p class="text-center"><i class="fas fa-spinner fa-spin mr-2"></i> '.concat(t," (").concat(e,"%)</p>"))}},{key:"showConfidenceScore",value:function(e){var t=Math.round(100*e),r=t>=97?"text-green-400":t>=90?"text-yellow-400":"text-red-400",n='\n            <div class="mt-4 p-3 bg-black bg-opacity-30 rounded-lg">\n                <h4 class="font-bold '.concat(r,' mb-2">OCR Confidence Score</h4>\n                <div class="flex items-center">\n                    <div class="flex-1 bg-gray-700 rounded-full h-2 mr-3">\n                        <div class="bg-green-500 h-2 rounded-full" style="width: ').concat(t,'%"></div>\n                    </div>\n                    <span class="text-sm ').concat(r,' font-bold">').concat(t,'%</span>\n                </div>\n                <p class="text-xs text-gray-400 mt-1">\n                    ').concat(t>=97?"Excellent accuracy!":t>=90?"Good accuracy":"Lower accuracy - please verify results","\n                </p>\n            </div>\n        "),i=document.getElementById("ocrResult");i&&(i.innerHTML+=n)}},{key:"showToast",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=document.createElement("div"),n="success"===t?"bg-green-600":"error"===t?"bg-red-600":"bg-blue-600";r.className="fixed bottom-4 right-4 ".concat(n," text-white py-2 px-4 rounded-lg shadow-lg z-50"),r.textContent=e,document.body.appendChild(r),setTimeout(function(){r.remove()},3e3)}},{key:"handleMessageSubmit",value:function(e){var t=document.getElementById("senderName").value,r=document.getElementById("messageSubject").value,n=document.getElementById("messageBody").value,i="mailto:info@table1837.com?subject=".concat(encodeURIComponent(r),"&body=").concat(encodeURIComponent("From: ".concat(t,"\n\n").concat(n)));window.location.href=i,e.target.reset(),alert("Email client opened. Please send the message from your email application.")}},{key:"cleanup",value:function(){}}],t&&ce(e.prototype,t),r&&ce(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,n,i}();function he(e){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},he(e)}function de(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fe(n.key),n)}}function fe(e){var t=function(e,t){if("object"!=he(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=he(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==he(t)?t:t+""}var pe=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.app=t,this.state=t.state,this.elements=t.elements},(t=[{key:"initialize",value:function(){this.setupEventListeners()}},{key:"setupEventListeners",value:function(){var e=this,t=document.getElementById("wineSearch"),r=document.getElementById("wineFilter");t&&t.addEventListener("input",function(){return e.filterWines()}),r&&r.addEventListener("change",function(){return e.filterWines()})}},{key:"filterWines",value:function(){var e=document.getElementById("wineSearch"),t=document.getElementById("wineFilter");if(e&&t){var r=e.value.toLowerCase(),n=t.value;document.querySelectorAll(".wine-category").forEach(function(e){var t=e.classList.contains("red-wine")?"red":e.classList.contains("white-wine")?"white":e.classList.contains("sparkling-wine")?"sparkling":"",i=!0;n&&n!==t&&(i=!1),r&&i&&(i=e.textContent.toLowerCase().includes(r)),e.style.display=i?"block":"none"})}}}])&&de(e.prototype,t),r&&de(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function ye(e){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ye(e)}function me(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ge(n.key),n)}}function ge(e){var t=function(e,t){if("object"!=ye(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ye(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ye(t)?t:t+""}var ve=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.app=t,this.state=t.state,this.elements=t.elements,this.inventory={vodka:["Zyr Vodka","360 Double Chocolate Vodka","Western Sun Blueberry Vodka","Absolut","Smirnoff Vanilla","Smirnoff Citrus","Smirnoff Vodka (Regular)","Holla Vodka","Tito's","Gray Goose","Double Cross Vodka","Kettle One","Kettle One Cucumber and Mint"],gin:["Hendrick's Gin","Bar Hill Gin","Whitley Neill Rhubarb and Ginger Gin","Bombay Sapphire Dry Gin","Nolet's Dry Gin","Blue Coat Dry Gin","Tanqueray Dry Gin","Beef Eater Dry Gin","Aviation American Gin"],rum:["Cruzan Blueberry Lemonade Rum","Gosling's Black Rum","Malibu Coconut Rum","Captain Morgan Spiced Rum","Bacardi"],tequila:["21 Seed Cucumber Jalapeno Tequila","Jose Cuervo Silver","Jose Cuervo Gold","Casamigos Mezcal","Casamigos Blanco","Coramino Reposado","Agavales Blood Orange Blanco Tequila"],whiskey:["Knob Creek","Elijah Craig","Angels Envy","Dublin","Sycamore Rye","Maker's Mark","Bullet Rye","Bullet Bourbon","Basil Hayden's Malted Rye","Basil Hayden's Bourbon","Jack Daniels","Jim Bean","Woodford Reserve","Watershed Distillery Straight Bourbon 4-Year","Dubliner","Canadian Club","Seagrams Seven","Seagram's VO","Southern Comfort","Crown Royal Apple","Crown Royal","Jameson","Red Breast Single Pot Still Irish Whiskey 12-Year","Chivas","Highland Park 12-Year","Glenliet 12-Year","Glenfiddich 12-Year","Balvini Doublewood 12-Year","Glenmorangie 12-Year","Macallen 12 Double Cask","Dewars Scotch Whiskey White Label","Johnnie Walker Red","Johnnie Walker Black"],cordials:["Monin Blackberry","Monin Lavender","Monin Caramel","DeKuyper Sour Apple","Peychaud's Bitters","Aromatic Bitters","Angostura Bitters","Dry Vermouth","Sweet Vermouth","Saint Germain","Drambuie","Blue Curacao","DeKuyper Butterscotch","DeKuyper Melon","DeKuyper Razmataz","DeKuyper Watermelon Pucker","Jaquin's Creme de Cacao","Triple Sec","Middle West Spirits Bourbon Cream","Disaronno Amaretto","Screwball","Kahlua","Bailey's","RumChata","Frangelico","Sambuca","Luxardo","Campari","Aperol","Cream to Violet","Contreau","Pama Pomegranate Liqueur"],juices:["Orange Juice","Cranberry Juice","Lime Juice","Lemon Juice","Grapefruit Juice","Sour Mix"],sodas:["Sprite","Coke","Diet Coke","Ginger Beer"],teas:["Raspberry Tea","Hibiscus Tea","Tea"],fruits:["Oranges","Limes","Lemons","Cherries","Luxardo Cherries"],garnishes:["Olives","Blue Cheese Stuffed Olives"],salts:["Smoked Salt","Salt","Sugar"],bitters:["Angostura Bitters","Peychaud's Bitters","Orange Bitters","Lavender Orange Bitters","Black Walnut Bitters"]}},t=[{key:"initialize",value:function(){this.initializeInventory(),this.displayInventory(),this.initializeVoiceRecognition(),this.setupEventListeners()}},{key:"setupEventListeners",value:function(){var e=this;document.querySelectorAll(".category-filter").forEach(function(t){t.addEventListener("click",function(t){document.querySelectorAll(".category-filter").forEach(function(e){e.classList.remove("active","bg-dark-green"),e.classList.add("bg-gray-700")}),t.target.classList.add("active","bg-dark-green"),t.target.classList.remove("bg-gray-700"),e.filterInventory(t.target.dataset.category)})});var t=document.getElementById("updateInventoryBtn");t&&t.addEventListener("click",function(){e.saveInventory(),alert("Inventory updated successfully!")})}},{key:"initializeInventory",value:function(){var e=this;Object.keys(this.inventory).forEach(function(t){e.inventory[t].forEach(function(r){e.state.inventoryData[r]||(e.state.inventoryData[r]={bottles:0,ounces:0,category:t})})})}},{key:"displayInventory",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",r=document.getElementById("inventoryGrid");if(r){var n=document.createDocumentFragment();Object.keys(this.inventory).forEach(function(r){if("all"===t||t===r){var i=document.createElement("div");i.className="col-span-full",i.innerHTML='<h3 class="text-2xl font-bold mb-4 text-center capitalize text-yellow-400">'.concat(r,"</h3>"),n.appendChild(i),e.inventory[r].forEach(function(t){var i=e.state.inventoryData[t]||{bottles:0,ounces:0,category:r},s=document.createElement("div");s.className="inventory-item",s.innerHTML='\n                    <h4 class="font-semibold mb-3">'.concat(t,'</h4>\n                    <div class="grid grid-cols-2 gap-4">\n                        <div>\n                            <label class="block text-sm text-gray-300 mb-1">Bottles</label>\n                            <input type="number" \n                                   class="w-full px-3 py-2 bg-black bg-opacity-50 border border-gray-600 rounded focus:outline-none focus:border-green-600 text-white" \n                                   value="').concat(i.bottles,'" \n                                   data-item="').concat(t,'" \n                                   data-type="bottles"\n                                   min="0">\n                        </div>\n                        <div>\n                            <label class="block text-sm text-gray-300 mb-1">Ounces</label>\n                            <input type="number" \n                                   class="w-full px-3 py-2 bg-black bg-opacity-50 border border-gray-600 rounded focus:outline-none focus:border-green-600 text-white" \n                                   value="').concat(i.ounces,'" \n                                   data-item="').concat(t,'" \n                                   data-type="ounces"\n                                   min="0"\n                                   step="0.1">\n                        </div>\n                    </div>\n                '),s.querySelectorAll("input").forEach(function(t){t.addEventListener("change",function(t){var n=t.target.dataset.item,i=t.target.dataset.type,s=parseFloat(t.target.value)||0;e.state.inventoryData[n]||(e.state.inventoryData[n]={bottles:0,ounces:0,category:r}),e.state.inventoryData[n][i]=s})}),n.appendChild(s)})}}),r.innerHTML="",r.appendChild(n)}}},{key:"filterInventory",value:function(e){this.displayInventory(e)}},{key:"saveInventory",value:function(){localStorage.setItem("inventoryData",JSON.stringify(this.state.inventoryData))}},{key:"initializeVoiceRecognition",value:function(){var e=this;if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){var t=window.SpeechRecognition||window.webkitSpeechRecognition;this.state.recognition=new t,this.state.recognition.continuous=!0,this.state.recognition.interimResults=!0,this.state.recognition.lang="en-US";var r=document.getElementById("voiceButton");r&&r.addEventListener("click",function(){return e.toggleVoiceRecognition()}),this.state.recognition.onresult=function(t){return e.handleVoiceResult(t)},this.state.recognition.onerror=function(t){return e.handleVoiceError(t)},this.state.recognition.onend=function(){return e.handleVoiceEnd()}}else{var n=document.getElementById("voiceButton");n&&(n.disabled=!0,n.innerHTML='<i class="fas fa-microphone-slash"></i> Voice Not Supported')}}},{key:"toggleVoiceRecognition",value:function(){var e=document.getElementById("voiceButton"),t=document.getElementById("voiceStatus");this.state.isListening?(this.state.recognition.stop(),this.state.isListening=!1,t.classList.add("hidden"),e.innerHTML='<i class="fas fa-microphone"></i> Voice Update',e.classList.remove("bg-red-600")):(this.state.recognition.start(),this.state.isListening=!0,t.classList.remove("hidden"),e.innerHTML='<i class="fas fa-stop"></i> Stop Listening',e.classList.add("bg-red-600"))}},{key:"handleVoiceResult",value:function(e){var t=e.results[e.results.length-1],r=t[0].transcript.trim(),n=document.getElementById("voiceText");n&&(n.textContent=r),t.isFinal&&this.processVoiceInput(r)}},{key:"handleVoiceError",value:function(e){this.state.isListening=!1;var t=document.getElementById("voiceStatus"),r=document.getElementById("voiceButton");t&&t.classList.add("hidden"),r&&(r.innerHTML='<i class="fas fa-microphone"></i> Voice Update',r.classList.remove("bg-red-600")),alert("Voice recognition error: ".concat(e.error,". Please try again."))}},{key:"handleVoiceEnd",value:function(){this.state.isListening&&this.state.recognition.start()}},{key:"processVoiceInput",value:function(e){try{for(var t=e.toLowerCase().split(" "),r=0,n=0,i=0;i<t.length;i++){var s=t[i],o=parseFloat(s);if(!isNaN(o)){var a=t[i+1]||"";a.includes("bottle")||"bottles"===a||"bottle"===a?r=o:(a.includes("ounce")||a.includes("oz")||"ounces"===a)&&(n=o)}}var c=0,l=null;Object.keys(this.state.inventoryData).forEach(function(t){var r=t.toLowerCase().split(" "),n=0,i=0;r.forEach(function(t){t.length>2&&(i++,e.toLowerCase().includes(t)&&n++)});var s=i>0?n/i:0;s>c&&s>.4&&(c=s,l=t)}),l&&(r>0||n>0)?(r>0&&(this.state.inventoryData[l].bottles=r),n>0&&(this.state.inventoryData[l].ounces=n),this.updateInventoryDisplay(l,r,n),this.showToast("Updated ".concat(l,": ").concat(r>0?"".concat(r," bottles"):""," ").concat(n>0?"".concat(n," ounces"):""))):l?this.showToast("Recognized ".concat(l,", but no quantity detected. Please specify bottles or ounces.")):r>0||n>0?this.showToast("Quantity detected (".concat(r>0?"".concat(r," bottles"):""," ").concat(n>0?"".concat(n," ounces"):"","), but could not match a specific item. Please try again.")):this.showToast("Could not recognize inventory update. Please try again with item name and quantity.")}catch(e){this.showToast("Error processing voice input. Please try again.")}}},{key:"updateInventoryDisplay",value:function(e,t,r){document.querySelectorAll('input[data-item="'.concat(e,'"]')).forEach(function(e){"bottles"===e.dataset.type&&t>0?e.value=t:"ounces"===e.dataset.type&&r>0&&(e.value=r)})}},{key:"showToast",value:function(e){var t=document.createElement("div");t.className="fixed bottom-4 right-4 bg-dark-green text-white py-2 px-4 rounded-lg shadow-lg z-50 animate-fade-in-up",t.textContent=e,document.body.appendChild(t),setTimeout(function(){t.classList.add("animate-fade-out"),setTimeout(function(){document.body.contains(t)&&document.body.removeChild(t)},500)},3e3)}},{key:"cleanup",value:function(){this.state.recognition&&this.state.recognition.stop()}}],t&&me(e.prototype,t),r&&me(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function be(e){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},be(e)}function we(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ke(n.key),n)}}function ke(e){var t=function(e,t){if("object"!=be(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=be(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==be(t)?t:t+""}var Se=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.app=t,this.state=t.state,this.elements=t.elements},(t=[{key:"initialize",value:function(){this.createPerformanceDashboard(),this.startRealTimeMonitoring()}},{key:"createPerformanceDashboard",value:function(){var e=document.createElement("div");e.id="performance-dashboard",e.className="fixed top-4 right-4 bg-black bg-opacity-80 p-4 rounded-lg text-xs z-50 max-w-xs",e.innerHTML='\n            <h3 class="font-bold text-yellow-400 mb-2">Performance Monitor</h3>\n            <div id="performance-metrics" class="space-y-1">\n                <div>Load Time: <span id="load-time">-</span></div>\n                <div>Memory: <span id="memory-usage">-</span></div>\n                <div>Errors: <span id="error-count">-</span></div>\n                <div>OCR Avg: <span id="ocr-avg">-</span></div>\n            </div>\n            <button id="performance-toggle" class="mt-2 text-xs bg-gray-700 px-2 py-1 rounded">Hide</button>\n        ',document.body.appendChild(e);var t=document.getElementById("performance-toggle");t.addEventListener("click",function(){var e=document.getElementById("performance-metrics"),r=e.classList.contains("hidden");e.classList.toggle("hidden"),t.textContent=r?"Hide":"Show"})}},{key:"startRealTimeMonitoring",value:function(){var e=this;setInterval(function(){e.updateMetrics()},2e3)}},{key:"updateMetrics",value:function(){if(this.app.services.monitor){var e=this.app.services.monitor.getMetrics(),t=document.getElementById("load-time"),r=document.getElementById("memory-usage"),n=document.getElementById("error-count"),i=document.getElementById("ocr-avg");t&&(t.textContent="".concat(e.loadTime.toFixed(0),"ms")),r&&(r.textContent="".concat(e.memoryUsage.toFixed(1),"MB")),n&&(n.textContent=e.errors.length),i&&(i.textContent="".concat(e.averageOCRTime.toFixed(0),"ms"))}}},{key:"cleanup",value:function(){var e=document.getElementById("performance-dashboard");e&&e.remove()}}])&&we(e.prototype,t),r&&we(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();class _e extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Te extends _e{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Ee extends _e{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class je extends _e{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var xe;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(xe||(xe={}));var Oe=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};class Ce{constructor(e,{headers:t={},customFetch:n,region:i=xe.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=(e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.bind(r,907)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)})(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return Oe(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:s}=t;let o={},{region:a}=t;a||(a=this.region);const c=new URL(`${this.url}/${e}`);let l;a&&"any"!==a&&(o["x-region"]=a,c.searchParams.set("forceFunctionRegion",a)),s&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&("undefined"!=typeof Blob&&s instanceof Blob||s instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",l=s):"string"==typeof s?(o["Content-Type"]="text/plain",l=s):"undefined"!=typeof FormData&&s instanceof FormData?l=s:(o["Content-Type"]="application/json",l=JSON.stringify(s)));const u=yield this.fetch(c.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),n),body:l}).catch(e=>{throw new Te(e)}),h=u.headers.get("x-relay-error");if(h&&"true"===h)throw new Ee(u);if(!u.ok)throw new je(u);let d,f=(null!==(r=u.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return d="application/json"===f?yield u.json():"application/octet-stream"===f?yield u.blob():"text/event-stream"===f?u:"multipart/form-data"===f?yield u.formData():yield u.text(),{data:d,error:null,response:u}}catch(e){return{data:null,error:e,response:e instanceof je||e instanceof Ee?e.context:void 0}}})}}var Pe=r(279);const{PostgrestClient:Ie,PostgrestQueryBuilder:Ae,PostgrestFilterBuilder:Le,PostgrestTransformBuilder:Re,PostgrestBuilder:De,PostgrestError:$e}=Pe;const Me=function(){if("undefined"!=typeof WebSocket)return WebSocket;if(void 0!==global.WebSocket)return global.WebSocket;if(void 0!==window.WebSocket)return window.WebSocket;if(void 0!==self.WebSocket)return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}();var Be,Ne,Ue,We,Fe,ze;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(Be||(Be={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(Ne||(Ne={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(Ue||(Ue={})),function(e){e.websocket="websocket"}(We||(We={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(Fe||(Fe={}));class qe{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"==typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const n=t.getUint8(1),i=t.getUint8(2);let s=this.HEADER_LENGTH+2;const o=r.decode(e.slice(s,s+n));s+=n;const a=r.decode(e.slice(s,s+i));s+=i;return{ref:null,topic:o,event:a,payload:JSON.parse(r.decode(e.slice(s,e.byteLength)))}}}class Ge{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(ze||(ze={}));const He=(e,t,r={})=>{var n;const i=null!==(n=r.skipTypes)&&void 0!==n?n:[];return Object.keys(t).reduce((r,n)=>(r[n]=Ke(n,e,t,i),r),{})},Ke=(e,t,r,n)=>{const i=t.find(t=>t.name===e),s=null==i?void 0:i.type,o=r[e];return s&&!n.includes(s)?Je(s,o):Ve(o)},Je=(e,t)=>{if("_"===e.charAt(0)){const r=e.slice(1,e.length);return Xe(t,r)}switch(e){case ze.bool:return Ye(t);case ze.float4:case ze.float8:case ze.int2:case ze.int4:case ze.int8:case ze.numeric:case ze.oid:return Qe(t);case ze.json:case ze.jsonb:return Ze(t);case ze.timestamp:return et(t);case ze.abstime:case ze.date:case ze.daterange:case ze.int4range:case ze.int8range:case ze.money:case ze.reltime:case ze.text:case ze.time:case ze.timestamptz:case ze.timetz:case ze.tsrange:case ze.tstzrange:default:return Ve(t)}},Ve=e=>e,Ye=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Qe=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Ze=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e}return e},Xe=(e,t)=>{if("string"!=typeof e)return e;const r=e.length-1,n=e[r];if("{"===e[0]&&"}"===n){let n;const i=e.slice(1,r);try{n=JSON.parse("["+i+"]")}catch(e){n=i?i.split(","):[]}return n.map(e=>Je(t,e))}return e},et=e=>"string"==typeof e?e.replace(" ","T"):e,tt=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class rt{constructor(e,t,r={},n=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var nt,it,st,ot;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(nt||(nt={}));class at{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{const{onJoin:t,onLeave:r,onSync:n}=this.caller;this.joinRef=this.channel._joinRef(),this.state=at.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=at.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],n()}),this.channel._on(r.diff,{},e=>{const{onJoin:t,onLeave:r,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=at.syncDiff(this.state,e,t,r),n())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,n){const i=this.cloneDeep(e),s=this.transformState(t),o={},a={};return this.map(i,(e,t)=>{s[e]||(a[e]=t)}),this.map(s,(e,t)=>{const r=i[e];if(r){const n=t.map(e=>e.presence_ref),i=r.map(e=>e.presence_ref),s=t.filter(e=>i.indexOf(e.presence_ref)<0),c=r.filter(e=>n.indexOf(e.presence_ref)<0);s.length>0&&(o[e]=s),c.length>0&&(a[e]=c)}else o[e]=t}),this.syncDiff(i,{joins:o,leaves:a},r,n)}static syncDiff(e,t,r,n){const{joins:i,leaves:s}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(i,(t,n)=>{var i;const s=null!==(i=e[t])&&void 0!==i?i:[];if(e[t]=this.cloneDeep(n),s.length>0){const r=e[t].map(e=>e.presence_ref),n=s.filter(e=>r.indexOf(e.presence_ref)<0);e[t].unshift(...n)}r(t,s,n)}),this.map(s,(t,r)=>{let i=e[t];if(!i)return;const s=r.map(e=>e.presence_ref);i=i.filter(e=>s.indexOf(e.presence_ref)<0),e[t]=i,n(t,i,r),0===i.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const n=e[r];return t[r]="metas"in n?n.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(it||(it={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(st||(st={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(ot||(ot={}));class ct{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Ne.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new rt(this,Ue.join,this.params,this.timeout),this.rejoinTimer=new Ge(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ne.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ne.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=Ne.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ne.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ue.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new at(this),this.broadcastEndpointURL=tt(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,n;if(this.socket.isConnected()||this.socket.connect(),this.state==Ne.closed){const{config:{broadcast:i,presence:s,private:o}}=this.params;this._onError(t=>null==e?void 0:e(ot.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(ot.CLOSED));const a={},c={broadcast:i,presence:s,postgres_changes:null!==(n=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map(e=>e.filter))&&void 0!==n?n:[],private:o};this.socket.accessTokenValue&&(a.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},a)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var r;if(this.socket.setAuth(),void 0!==t){const n=this.bindings.postgres_changes,i=null!==(r=null==n?void 0:n.length)&&void 0!==r?r:0,s=[];for(let r=0;r<i;r++){const i=n[r],{filter:{event:o,schema:a,table:c,filter:l}}=i,u=t&&t[r];if(!u||u.event!==o||u.schema!==a||u.table!==c||u.filter!==l)return this.unsubscribe(),this.state=Ne.errored,void(null==e||e(ot.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));s.push(Object.assign(Object.assign({},i),{id:u.id}))}return this.bindings.postgres_changes=s,void(e&&e(ot.SUBSCRIBED))}null==e||e(ot.SUBSCRIBED)}).receive("error",t=>{this.state=Ne.errored,null==e||e(ot.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(ot.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,n;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var n,i,s;const o=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(s=null===(i=null===(n=this.params)||void 0===n?void 0:n.config)||void 0===i?void 0:i.broadcast)||void 0===s?void 0:s.ack)||r("ok"),o.receive("ok",()=>r("ok")),o.receive("error",()=>r("error")),o.receive("timeout",()=>r("timed out"))});{const{event:i,payload:s}=e,o={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:s,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!==(r=t.timeout)&&void 0!==r?r:this.timeout);return await(null===(n=e.body)||void 0===n?void 0:n.cancel()),e.ok?"ok":"error"}catch(e){return"AbortError"===e.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ne.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ue.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(n=>{r=new rt(this,Ue.leave,{},e),r.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{null==r||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,r){const n=new AbortController,i=setTimeout(()=>n.abort(),r),s=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(i),s}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new rt(this,e,t,r);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var n,i;const s=e.toLocaleLowerCase(),{close:o,error:a,leave:c,join:l}=Ue;if(r&&[o,a,c,l].indexOf(s)>=0&&r!==this._joinRef())return;let u=this._onMessage(s,t,r);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?null===(n=this.bindings.postgres_changes)||void 0===n||n.filter(e=>{var t,r,n;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(n=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===n?void 0:n.toLocaleLowerCase())===s}).map(e=>e.callback(u,r)):null===(i=this.bindings[s])||void 0===i||i.filter(e=>{var r,n,i,o,a,c;if(["broadcast","presence","postgres_changes"].includes(s)){if("id"in e){const s=e.id,o=null===(r=e.filter)||void 0===r?void 0:r.event;return s&&(null===(n=t.ids)||void 0===n?void 0:n.includes(s))&&("*"===o||(null==o?void 0:o.toLocaleLowerCase())===(null===(i=t.data)||void 0===i?void 0:i.type.toLocaleLowerCase()))}{const r=null===(a=null===(o=null==e?void 0:e.filter)||void 0===o?void 0:o.event)||void 0===a?void 0:a.toLocaleLowerCase();return"*"===r||r===(null===(c=null==t?void 0:t.event)||void 0===c?void 0:c.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===s}).map(e=>{if("object"==typeof u&&"ids"in u){const e=u.data,{schema:t,table:r,commit_timestamp:n,type:i,errors:s}=e,o={schema:t,table:r,commit_timestamp:n,eventType:i,new:{},old:{},errors:s};u=Object.assign(Object.assign({},o),this._getPayloadRecords(e))}e.callback(u,r)})}_isClosed(){return this.state===Ne.closed}_isJoined(){return this.state===Ne.joined}_isJoining(){return this.state===Ne.joining}_isLeaving(){return this.state===Ne.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const n=e.toLocaleLowerCase(),i={type:n,filter:t,callback:r};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(e=>{var n;return!((null===(n=e.type)||void 0===n?void 0:n.toLocaleLowerCase())===r&&ct.isEqual(e.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ue.close,{},e)}_onError(e){this._on(Ue.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ne.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=He(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=He(e.columns,e.old_record)),t}}const lt=()=>{};class ut{constructor(e,t){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=1e4,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=lt,this.ref=0,this.logger=lt,this.conn=null,this.sendBuffer=[],this.serializer=new qe,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.bind(r,907)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},this.endPoint=`${e}/${We.websocket}`,this.httpEndpoint=tt(e),(null==t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null==t?void 0:t.params)&&(this.params=t.params),(null==t?void 0:t.timeout)&&(this.timeout=t.timeout),(null==t?void 0:t.logger)&&(this.logger=t.logger),((null==t?void 0:t.logLevel)||(null==t?void 0:t.log_level))&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),(null==t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const i=null===(n=null==t?void 0:t.params)||void 0===n?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=(null==t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Ge(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(null==t?void 0:t.fetch),null==t?void 0:t.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null==t?void 0:t.worker)||!1,this.workerUrl=null==t?void 0:t.workerUrl}this.accessToken=(null==t?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Me),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(e=>e.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Be.connecting:return Fe.Connecting;case Be.open:return Fe.Open;case Be.closing:return Fe.Closing;default:return Fe.Closed}}isConnected(){return this.connectionState()===Fe.Open}channel(e,t={config:{}}){const r=`realtime:${e}`,n=this.getChannels().find(e=>e.topic===r);if(n)return n;{const r=new ct(`realtime:${e}`,t,this);return this.channels.push(r),r}}push(e){const{topic:t,event:r,payload:n,ref:i}=e,s=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${r} (${i})`,n),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{const r={access_token:t,version:"realtime-js/2.11.15"};t&&e.updateJoinPayload(r),e.joinedOnce&&e._isJoined()&&e._push(Ue.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}else this.heartbeatCallback("disconnected")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,e=>{let{topic:t,event:r,payload:n,ref:i}=e;"phoenix"===t&&"phx_reply"===r&&this.heartbeatCallback("ok"==e.payload.status?"ok":"error"),i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${n.status||""} ${t} ${r} ${i&&"("+i+")"||""}`,n),Array.from(this.channels).filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,n,i)),this.stateChangeCallbacks.message.forEach(t=>t(e))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ue.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const r=e.match(/\?/)?"&":"?";return`${e}${r}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class ht extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function dt(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class ft extends ht{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class pt extends ht{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var yt=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};const mt=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.bind(r,907)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},gt=e=>{if(Array.isArray(e))return e.map(e=>gt(e));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([e,r])=>{const n=e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[n]=gt(r)}),t};var vt=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};const bt=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),wt=(e,t,n)=>vt(void 0,void 0,void 0,function*(){const i=yield yt(void 0,void 0,void 0,function*(){return"undefined"==typeof Response?(yield Promise.resolve().then(r.bind(r,907))).Response:Response});e instanceof i&&!(null==n?void 0:n.noResolveJson)?e.json().then(r=>{const n=e.status||500,i=(null==r?void 0:r.statusCode)||n+"";t(new ft(bt(r),n,i))}).catch(e=>{t(new pt(bt(e),e))}):t(new pt(bt(e),e))}),kt=(e,t,r,n)=>{const i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&n?((e=>{if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)})(n)?(i.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,Object.assign(Object.assign({},i),r)):i};function St(e,t,r,n,i,s){return vt(this,void 0,void 0,function*(){return new Promise((o,a)=>{e(r,kt(t,n,i,s)).then(e=>{if(!e.ok)throw e;return(null==n?void 0:n.noResolveJson)?e:e.json()}).then(e=>o(e)).catch(e=>wt(e,a,n))})})}function _t(e,t,r,n){return vt(this,void 0,void 0,function*(){return St(e,"GET",t,r,n)})}function Tt(e,t,r,n,i){return vt(this,void 0,void 0,function*(){return St(e,"POST",t,n,i,r)})}function Et(e,t,r,n,i){return vt(this,void 0,void 0,function*(){return St(e,"PUT",t,n,i,r)})}function jt(e,t,r,n,i){return vt(this,void 0,void 0,function*(){return St(e,"DELETE",t,n,i,r)})}var xt=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};const Ot={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ct={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Pt{constructor(e,t={},r,n){this.url=e,this.headers=t,this.bucketId=r,this.fetch=mt(n)}uploadOrUpdate(e,t,r,n){return xt(this,void 0,void 0,function*(){try{let i;const s=Object.assign(Object.assign({},Ct),n);let o=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(s.upsert)});const a=s.metadata;"undefined"!=typeof Blob&&r instanceof Blob?(i=new FormData,i.append("cacheControl",s.cacheControl),a&&i.append("metadata",this.encodeMetadata(a)),i.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(i=r,i.append("cacheControl",s.cacheControl),a&&i.append("metadata",this.encodeMetadata(a))):(i=r,o["cache-control"]=`max-age=${s.cacheControl}`,o["content-type"]=s.contentType,a&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(a)))),(null==n?void 0:n.headers)&&(o=Object.assign(Object.assign({},o),n.headers));const c=this._removeEmptyFolders(t),l=this._getFinalPath(c),u=yield("PUT"==e?Et:Tt)(this.fetch,`${this.url}/object/${l}`,i,Object.assign({headers:o},(null==s?void 0:s.duplex)?{duplex:s.duplex}:{}));return{data:{path:c,id:u.Id,fullPath:u.Key},error:null}}catch(e){if(dt(e))return{data:null,error:e};throw e}})}upload(e,t,r){return xt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,n){return xt(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),s=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${s}`);o.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:Ct.upsert},n),s=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&r instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r,e.append("cacheControl",t.cacheControl)):(e=r,s["cache-control"]=`max-age=${t.cacheControl}`,s["content-type"]=t.contentType);return{data:{path:i,fullPath:(yield Et(this.fetch,o.toString(),e,{headers:s})).Key},error:null}}catch(e){if(dt(e))return{data:null,error:e};throw e}})}createSignedUploadUrl(e,t){return xt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const n=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(n["x-upsert"]="true");const i=yield Tt(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:n}),s=new URL(this.url+i.url),o=s.searchParams.get("token");if(!o)throw new ht("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:o},error:null}}catch(e){if(dt(e))return{data:null,error:e};throw e}})}update(e,t,r){return xt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return xt(this,void 0,void 0,function*(){try{return{data:yield Tt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(e){if(dt(e))return{data:null,error:e};throw e}})}copy(e,t,r){return xt(this,void 0,void 0,function*(){try{return{data:{path:(yield Tt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(e){if(dt(e))return{data:null,error:e};throw e}})}createSignedUrl(e,t,r){return xt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield Tt(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers});const s=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${s}`)},{data:i,error:null}}catch(e){if(dt(e))return{data:null,error:e};throw e}})}createSignedUrls(e,t,r){return xt(this,void 0,void 0,function*(){try{const n=yield Tt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:n.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${i}`):null})),error:null}}catch(e){if(dt(e))return{data:null,error:e};throw e}})}download(e,t){return xt(this,void 0,void 0,function*(){const r=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",n=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),i=n?`?${n}`:"";try{const t=this._getFinalPath(e),n=yield _t(this.fetch,`${this.url}/${r}/${t}${i}`,{headers:this.headers,noResolveJson:!0});return{data:yield n.blob(),error:null}}catch(e){if(dt(e))return{data:null,error:e};throw e}})}info(e){return xt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const e=yield _t(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:gt(e),error:null}}catch(e){if(dt(e))return{data:null,error:e};throw e}})}exists(e){return xt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield function(e,t,r,n){return vt(this,void 0,void 0,function*(){return St(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(e){if(dt(e)&&e instanceof pt){const t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}})}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],i=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==i&&n.push(i);const s=void 0!==(null==t?void 0:t.transform)?"render/image":"object",o=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==o&&n.push(o);let a=n.join("&");return""!==a&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${r}${a}`)}}}remove(e){return xt(this,void 0,void 0,function*(){try{return{data:yield jt(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(e){if(dt(e))return{data:null,error:e};throw e}})}list(e,t,r){return xt(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Ot),t),{prefix:e||""});return{data:yield Tt(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(e){if(dt(e))return{data:null,error:e};throw e}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const It={"X-Client-Info":"storage-js/2.10.4"};var At=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};class Lt{constructor(e,t={},r,n){const i=new URL(e);if(null==n?void 0:n.useNewHostname){/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase."))}this.url=i.href,this.headers=Object.assign(Object.assign({},It),t),this.fetch=mt(r)}listBuckets(){return At(this,void 0,void 0,function*(){try{return{data:yield _t(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(dt(e))return{data:null,error:e};throw e}})}getBucket(e){return At(this,void 0,void 0,function*(){try{return{data:yield _t(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(e){if(dt(e))return{data:null,error:e};throw e}})}createBucket(e,t={public:!1}){return At(this,void 0,void 0,function*(){try{return{data:yield Tt(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(dt(e))return{data:null,error:e};throw e}})}updateBucket(e,t){return At(this,void 0,void 0,function*(){try{return{data:yield Et(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(dt(e))return{data:null,error:e};throw e}})}emptyBucket(e){return At(this,void 0,void 0,function*(){try{return{data:yield Tt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(dt(e))return{data:null,error:e};throw e}})}deleteBucket(e){return At(this,void 0,void 0,function*(){try{return{data:yield jt(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(e){if(dt(e))return{data:null,error:e};throw e}})}}class Rt extends Lt{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new Pt(this.url,this.headers,e,this.fetch)}}let Dt="";Dt="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const $t={headers:{"X-Client-Info":`supabase-js-${Dt}/2.53.0`}},Mt={schema:"public"},Bt={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Nt={};var Ut=r(907),Wt=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};const Ft=e=>{let t;return t=e||("undefined"==typeof fetch?Ut.default:fetch),(...e)=>t(...e)},zt=(e,t,r)=>{const n=Ft(r),i="undefined"==typeof Headers?Ut.Headers:Headers;return(r,s)=>Wt(void 0,void 0,void 0,function*(){var o;const a=null!==(o=yield t())&&void 0!==o?o:e;let c=new i(null==s?void 0:s.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${a}`),n(r,Object.assign(Object.assign({},s),{headers:c}))})};var qt=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};const Gt="2.71.1",Ht=3e4,Kt=9e4,Jt={"X-Client-Info":`gotrue-js/${Gt}`},Vt="X-Supabase-Api-Version",Yt={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},Qt=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class Zt extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function Xt(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class er extends Zt{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class tr extends Zt{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class rr extends Zt{constructor(e,t,r,n){super(e,r,n),this.name=t,this.status=r}}class nr extends rr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class ir extends rr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class sr extends rr{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class or extends rr{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ar extends rr{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class cr extends rr{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function lr(e){return Xt(e)&&"AuthRetryableFetchError"===e.name}class ur extends rr{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class hr extends rr{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const dr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),fr=" \t\n\r=".split(""),pr=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<fr.length;t+=1)e[fr[t].charCodeAt(0)]=-2;for(let t=0;t<dr.length;t+=1)e[dr[t].charCodeAt(0)]=t;return e})();function yr(e,t,r){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;r(dr[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;r(dr[e]),t.queuedBits-=6}}function mr(e,t,r){const n=pr[e];if(!(n>-1)){if(-2===n)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function gr(e){const t=[],r=e=>{t.push(String.fromCodePoint(e))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=e=>{!function(e,t,r){if(0===t.utf8seq){if(e<=127)return void r(e);for(let r=1;r<6;r+=1)if(!(e>>7-r&1)){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}}(e,n,r)};for(let t=0;t<e.length;t+=1)mr(e.charCodeAt(t),i,s);return t.join("")}function vr(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}t(e)}function br(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const t=1024*(n-55296)&65535;n=65536+(e.charCodeAt(r+1)-56320&65535|t),r+=1}vr(n,t)}}function wr(e){const t=[],r={queue:0,queuedBits:0},n=e=>{t.push(e)};for(let t=0;t<e.length;t+=1)mr(e.charCodeAt(t),r,n);return new Uint8Array(t)}function kr(e){const t=[],r={queue:0,queuedBits:0},n=e=>{t.push(e)};return e.forEach(e=>yr(e,r,n)),yr(null,r,n),t.join("")}const Sr=()=>"undefined"!=typeof window&&"undefined"!=typeof document,_r={tested:!1,writable:!1},Tr=()=>{if(!Sr())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(_r.tested)return _r.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),_r.tested=!0,_r.writable=!0}catch(e){_r.tested=!0,_r.writable=!1}return _r.writable};const Er=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.bind(r,907)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},jr=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},xr=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(e){return r}},Or=async(e,t)=>{await e.removeItem(t)};class Cr{constructor(){this.promise=new Cr.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function Pr(e){const t=e.split(".");if(3!==t.length)throw new hr("Invalid JWT structure");for(let e=0;e<t.length;e++)if(!Qt.test(t[e]))throw new hr("JWT not in base64url format");return{header:JSON.parse(gr(t[0])),payload:JSON.parse(gr(t[1])),signature:wr(t[2]),raw:{header:t[0],payload:t[1]}}}function Ir(e){return("0"+e.toString(16)).substr(-2)}async function Ar(e){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return e;const t=await async function(e){const t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(r);return Array.from(n).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Lr(e,t,r=!1){const n=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let r="";for(let n=0;n<56;n++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,Ir).join("")}();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await jr(e,`${t}-code-verifier`,i);const s=await Ar(n);return[s,n===s?"plain":"s256"]}Cr.promiseConstructor=Promise;const Rr=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const Dr=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function $r(e){if(!Dr.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Mr(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"==typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Br(e){return JSON.parse(JSON.stringify(e))}var Nr=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};const Ur=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Wr=[502,503,504];async function Fr(e){var t,r;if(!("object"==typeof(r=e)&&null!==r&&"status"in r&&"ok"in r&&"json"in r&&"function"==typeof r.json))throw new cr(Ur(e),0);if(Wr.includes(e.status))throw new cr(Ur(e),e.status);let n,i;try{n=await e.json()}catch(e){throw new tr(Ur(e),e)}const s=function(e){const t=e.headers.get(Vt);if(!t)return null;if(!t.match(Rr))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}(e);if(s&&s.getTime()>=Yt.timestamp&&"object"==typeof n&&n&&"string"==typeof n.code?i=n.code:"object"==typeof n&&n&&"string"==typeof n.error_code&&(i=n.error_code),i){if("weak_password"===i)throw new ur(Ur(n),e.status,(null===(t=n.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===i)throw new nr}else if("object"==typeof n&&n&&"object"==typeof n.weak_password&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new ur(Ur(n),e.status,n.weak_password.reasons);throw new er(Ur(n),e.status||500,i)}async function zr(e,t,r,n){var i;const s=Object.assign({},null==n?void 0:n.headers);s[Vt]||(s[Vt]=Yt.name),(null==n?void 0:n.jwt)&&(s.Authorization=`Bearer ${n.jwt}`);const o=null!==(i=null==n?void 0:n.query)&&void 0!==i?i:{};(null==n?void 0:n.redirectTo)&&(o.redirect_to=n.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await async function(e,t,r,n,i,s){const o=((e,t,r,n)=>{const i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))})(t,n,i,s);let a;try{a=await e(r,Object.assign({},o))}catch(e){throw new cr(Ur(e),0)}a.ok||await Fr(a);if(null==n?void 0:n.noResolveJson)return a;try{return await a.json()}catch(e){await Fr(e)}}(e,t,r+a,{headers:s,noResolveJson:null==n?void 0:n.noResolveJson},{},null==n?void 0:n.body);return(null==n?void 0:n.xform)?null==n?void 0:n.xform(c):{data:Object.assign({},c),error:null}}function qr(e){var t;let r=null;var n;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=(n=e.expires_in,Math.round(Date.now()/1e3)+n)));return{data:{session:r,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function Gr(e){const t=qr(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function Hr(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function Kr(e){return{data:e,error:null}}function Jr(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,o=Nr(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},user:Object.assign({},o)},error:null}}function Vr(e){return e}const Yr=["global","local","others"];var Qr=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};class Zr{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=Er(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Yr[0]){if(Yr.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Yr.join(", ")}`);try{return await zr(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(Xt(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await zr(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Hr})}catch(e){if(Xt(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{const{options:t}=e,r=Qr(e,["options"]),n=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(n.new_email=null==r?void 0:r.newEmail,delete n.newEmail),await zr(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Jr,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(Xt(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await zr(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Hr})}catch(e){if(Xt(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,r,n,i,s,o,a;try{const c={nextPage:null,lastPage:0,total:0},l=await zr(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(i=null===(n=null==e?void 0:e.perPage)||void 0===n?void 0:n.toString())&&void 0!==i?i:""},xform:Vr});if(l.error)throw l.error;const u=await l.json(),h=null!==(s=l.headers.get("x-total-count"))&&void 0!==s?s:0,d=null!==(a=null===(o=l.headers.get("link"))||void 0===o?void 0:o.split(","))&&void 0!==a?a:[];return d.length>0&&(d.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);c[`${r}Page`]=t}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},u),c),error:null}}catch(e){if(Xt(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){$r(e);try{return await zr(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Hr})}catch(e){if(Xt(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){$r(e);try{return await zr(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Hr})}catch(e){if(Xt(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){$r(e);try{return await zr(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Hr})}catch(e){if(Xt(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){$r(e.userId);try{const{data:t,error:r}=await zr(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(e){if(Xt(e))return{data:null,error:e};throw e}}async _deleteFactor(e){$r(e.userId),$r(e.id);try{return{data:await zr(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(Xt(e))return{data:null,error:e};throw e}}}function Xr(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const en=!!(globalThis&&Tr()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class tn extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class rn extends tn{}async function nn(e,t,r){const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort()},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async n=>{if(!n){if(0===t)throw new rn(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(en)try{await globalThis.navigator.locks.query()}catch(e){}return await r()}try{return await r()}finally{}}))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const sn={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Jt,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function on(e,t,r){return await r()}const an={};class cn{constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=cn.nextInstanceID,cn.nextInstanceID+=1,this.instanceID>0&&Sr();const n=Object.assign(Object.assign({},sn),e);if(this.logDebugMessages=!!n.debug,"function"==typeof n.debug&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Zr({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Er(n.fetch),this.lock=n.lock||on,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:Sr()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=nn:this.lock=on,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:Tr()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Xr(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=Xr(this.memoryStorage)),Sr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){}null===(r=this.broadcastChannel)||void 0===r||r.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}get jwks(){var e,t;return null!==(t=null===(e=an[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){an[this.storageKey]=Object.assign(Object.assign({},an[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=an[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){an[this.storageKey]=Object.assign(Object.assign({},an[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Gt}) ${(new Date).toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(e){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),Sr()&&this.detectSessionInUrl&&"none"!==r){const{data:n,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),function(e){return Xt(e)&&"AuthImplicitGrantRedirectError"===e.name}(i)){const t=null===(e=i.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:i}}return await this._removeSession(),{error:i}}const{session:s,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",s,"redirect type",o),await this._saveSession(s),setTimeout(async()=>{"recovery"===o?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return Xt(e)?{error:e}:{error:new tr("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,n;try{const i=await zr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(r=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==r?r:{},gotrue_meta_security:{captcha_token:null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.captchaToken}},xform:qr}),{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const a=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:c,session:a},error:null}}catch(e){if(Xt(e))return{data:{user:null,session:null},error:e};throw e}}async signUp(e){var t,r,n;try{let i;if("email"in e){const{email:r,password:n,options:s}=e;let o=null,a=null;"pkce"===this.flowType&&([o,a]=await Lr(this.storage,this.storageKey)),i=await zr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==s?void 0:s.emailRedirectTo,body:{email:r,password:n,data:null!==(t=null==s?void 0:s.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},code_challenge:o,code_challenge_method:a},xform:qr})}else{if(!("phone"in e))throw new sr("You must provide either an email or phone number and a password");{const{phone:t,password:s,options:o}=e;i=await zr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:s,data:null!==(r=null==o?void 0:o.data)&&void 0!==r?r:{},channel:null!==(n=null==o?void 0:o.channel)&&void 0!==n?n:"sms",gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}},xform:qr})}}const{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const a=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:c,session:a},error:null}}catch(e){if(Xt(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithPassword(e){try{let t;if("email"in e){const{email:r,password:n,options:i}=e;t=await zr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:Gr})}else{if(!("phone"in e))throw new sr("You must provide either an email or phone number and a password");{const{phone:r,password:n,options:i}=e;t=await zr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:Gr})}}const{data:r,error:n}=t;return n?{data:{user:null,session:null},error:n}:r&&r.session&&r.user?(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n}):{data:{user:null,session:null},error:new ir}}catch(e){if(Xt(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(e){var t,r,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:null===(i=e.options)||void 0===i?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if("solana"===t)return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,r,n,i,s,o,a,c,l,u,h,d;let f,p;if("message"in e)f=e.message,p=e.signature;else{const{chain:h,wallet:d,statement:y,options:m}=e;let g;if(Sr())if("object"==typeof d)g=d;else{const e=window;if(!("solana"in e)||"object"!=typeof e.solana||!("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");g=e.solana}else{if("object"!=typeof d||!(null==m?void 0:m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=d}const v=new URL(null!==(t=null==m?void 0:m.url)&&void 0!==t?t:window.location.href);if("signIn"in g&&g.signIn){const e=await g.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null==m?void 0:m.signInWithSolana),{version:"1",domain:v.host,uri:v.href}),y?{statement:y}:null));let t;if(Array.isArray(e)&&e[0]&&"object"==typeof e[0])t=e[0];else{if(!(e&&"object"==typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"==typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");f="string"==typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),p=t.signature}else{if(!("signMessage"in g&&"function"==typeof g.signMessage&&"publicKey"in g&&"object"==typeof g&&g.publicKey&&"toBase58"in g.publicKey&&"function"==typeof g.publicKey.toBase58))throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");f=[`${v.host} wants you to sign in with your Solana account:`,g.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${v.href}`,`Issued At: ${null!==(n=null===(r=null==m?void 0:m.signInWithSolana)||void 0===r?void 0:r.issuedAt)&&void 0!==n?n:(new Date).toISOString()}`,...(null===(i=null==m?void 0:m.signInWithSolana)||void 0===i?void 0:i.notBefore)?[`Not Before: ${m.signInWithSolana.notBefore}`]:[],...(null===(s=null==m?void 0:m.signInWithSolana)||void 0===s?void 0:s.expirationTime)?[`Expiration Time: ${m.signInWithSolana.expirationTime}`]:[],...(null===(o=null==m?void 0:m.signInWithSolana)||void 0===o?void 0:o.chainId)?[`Chain ID: ${m.signInWithSolana.chainId}`]:[],...(null===(a=null==m?void 0:m.signInWithSolana)||void 0===a?void 0:a.nonce)?[`Nonce: ${m.signInWithSolana.nonce}`]:[],...(null===(c=null==m?void 0:m.signInWithSolana)||void 0===c?void 0:c.requestId)?[`Request ID: ${m.signInWithSolana.requestId}`]:[],...(null===(u=null===(l=null==m?void 0:m.signInWithSolana)||void 0===l?void 0:l.resources)||void 0===u?void 0:u.length)?["Resources",...m.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join("\n");const e=await g.signMessage((new TextEncoder).encode(f),"utf8");if(!(e&&e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=e}}try{const{data:t,error:r}=await zr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:f,signature:kr(p)},(null===(h=e.options)||void 0===h?void 0:h.captchaToken)?{gotrue_meta_security:{captcha_token:null===(d=e.options)||void 0===d?void 0:d.captchaToken}}:null),xform:qr});if(r)throw r;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:r}):{data:{user:null,session:null},error:new ir}}catch(e){if(Xt(e))return{data:{user:null,session:null},error:e};throw e}}async _exchangeCodeForSession(e){const t=await xr(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(null!=t?t:"").split("/");try{const{data:t,error:i}=await zr(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:qr});if(await Or(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=n?n:null}),error:i}):{data:{user:null,session:null,redirectType:null},error:new ir}}catch(e){if(Xt(e))return{data:{user:null,session:null,redirectType:null},error:e};throw e}}async signInWithIdToken(e){try{const{options:t,provider:r,token:n,access_token:i,nonce:s}=e,o=await zr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:i,nonce:s,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:qr}),{data:a,error:c}=o;return c?{data:{user:null,session:null},error:c}:a&&a.session&&a.user?(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:c}):{data:{user:null,session:null},error:new ir}}catch(e){if(Xt(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(e){var t,r,n,i,s;try{if("email"in e){const{email:n,options:i}=e;let s=null,o=null;"pkce"===this.flowType&&([s,o]=await Lr(this.storage,this.storageKey));const{error:a}=await zr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:n,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},create_user:null===(r=null==i?void 0:i.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:s,code_challenge_method:o},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){const{phone:t,options:r}=e,{data:o,error:a}=await zr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(n=null==r?void 0:r.data)&&void 0!==n?n:{},create_user:null===(i=null==r?void 0:r.shouldCreateUser)||void 0===i||i,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!==(s=null==r?void 0:r.channel)&&void 0!==s?s:"sms"}});return{data:{user:null,session:null,messageId:null==o?void 0:o.message_id},error:a}}throw new sr("You must provide either an email or phone number.")}catch(e){if(Xt(e))return{data:{user:null,session:null},error:e};throw e}}async verifyOtp(e){var t,r;try{let n,i;"options"in e&&(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo,i=null===(r=e.options)||void 0===r?void 0:r.captchaToken);const{data:s,error:o}=await zr(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:qr});if(o)throw o;if(!s)throw new Error("An error occurred on token verification.");const a=s.session,c=s.user;return(null==a?void 0:a.access_token)&&(await this._saveSession(a),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:c,session:a},error:null}}catch(e){if(Xt(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithSSO(e){var t,r,n;try{let i=null,s=null;return"pkce"===this.flowType&&([i,s]=await Lr(this.storage,this.storageKey)),await zr(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:s}),headers:this.headers,xform:Kr})}catch(e){if(Xt(e))return{data:null,error:e};throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new nr;const{error:n}=await zr(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(Xt(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:n,options:i}=e,{error:s}=await zr(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:s}}if("phone"in e){const{phone:r,type:n,options:i}=e,{data:s,error:o}=await zr(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:null==s?void 0:s.message_id},error:o}}throw new sr("You must provide either an email or phone number and a type")}catch(e){if(Xt(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await xr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=!!e.expires_at&&1e3*e.expires_at-Date.now()<Kt;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const t=await xr(this.userStorage,this.storageKey+"-user");(null==t?void 0:t.user)?e.user=t.user:e.user=Mr()}if(this.storage.isServer&&e.user){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,r,n)=>(t||"user"!==r||(t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,r,n))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,async()=>await this._getUser())}async _getUser(e){try{return e?await zr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Hr}):await this._useSession(async e=>{var t,r,n;const{data:i,error:s}=e;if(s)throw s;return(null===(t=i.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await zr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(n=null===(r=i.session)||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0,xform:Hr}):{data:{user:null},error:new nr}})}catch(e){if(Xt(e))return function(e){return Xt(e)&&"AuthSessionMissingError"===e.name}(e)&&(await this._removeSession(),await Or(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:n,error:i}=r;if(i)throw i;if(!n.session)throw new nr;const s=n.session;let o=null,a=null;"pkce"===this.flowType&&null!=e.email&&([o,a]=await Lr(this.storage,this.storageKey));const{data:c,error:l}=await zr(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:a}),jwt:s.access_token,xform:Hr});if(l)throw l;return s.user=c.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(e){if(Xt(e))return{data:{user:null},error:e};throw e}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new nr;const t=Date.now()/1e3;let r=t,n=!0,i=null;const{payload:s}=Pr(e.access_token);if(s.exp&&(r=s.exp,n=r<=t),n){const{session:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};i=t}else{const{data:n,error:s}=await this._getUser(e.access_token);if(s)throw s;i={access_token:e.access_token,refresh_token:e.refresh_token,user:n.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(e){if(Xt(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:n,error:i}=t;if(i)throw i;e=null!==(r=n.session)&&void 0!==r?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new nr;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(Xt(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(e,t){try{if(!Sr())throw new or("No browser detected.");if(e.error||e.error_description||e.error_code)throw new or(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new ar("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new or("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ar("No code detected.");const{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;const n=new URL(window.location.href);return n.searchParams.delete("code"),window.history.replaceState(window.history.state,"",n.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:n,access_token:i,refresh_token:s,expires_in:o,expires_at:a,token_type:c}=e;if(!(i&&o&&s&&c))throw new or("No session defined in URL");const l=Math.round(Date.now()/1e3),u=parseInt(o);let h=l+u;a&&(h=parseInt(a));const{data:d,error:f}=await this._getUser(i);if(f)throw f;const p={provider_token:r,provider_refresh_token:n,access_token:i,expires_in:u,expires_at:h,refresh_token:s,token_type:c,user:d.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:p,redirectType:e.type},error:null}}catch(e){if(Xt(e))return{data:{session:null,redirectType:null},error:e};throw e}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await xr(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:n,error:i}=t;if(i)return{error:i};const s=null===(r=n.session)||void 0===r?void 0:r.access_token;if(s){const{error:t}=await this.admin.signOut(s,e);if(t&&(!function(e){return Xt(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await Or(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,n;try{const{data:{session:n},error:i}=t;if(i)throw i;await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(t){await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t)}})}async resetPasswordForEmail(e,t={}){let r=null,n=null;"pkce"===this.flowType&&([r,n]=await Lr(this.storage,this.storageKey,!0));try{return await zr(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(Xt(e))return{data:null,error:e};throw e}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(e){if(Xt(e))return{data:null,error:e};throw e}}async linkIdentity(e){var t;try{const{data:r,error:n}=await this._useSession(async t=>{var r,n,i,s,o;const{data:a,error:c}=t;if(c)throw c;const l=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(i=e.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:!0});return await zr(this.fetch,"GET",l,{headers:this.headers,jwt:null!==(o=null===(s=a.session)||void 0===s?void 0:s.access_token)&&void 0!==o?o:void 0})});if(n)throw n;return Sr()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==r?void 0:r.url),{data:{provider:e.provider,url:null==r?void 0:r.url},error:null}}catch(t){if(Xt(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,n;const{data:i,error:s}=t;if(s)throw s;return await zr(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(n=null===(r=i.session)||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0})})}catch(e){if(Xt(e))return{data:null,error:e};throw e}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await(r=async r=>(r>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await zr(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:qr})),n=(e,t)=>{const r=200*Math.pow(2,e);return t&&lr(t)&&Date.now()+r-i<Ht},new Promise((e,t)=>{(async()=>{for(let i=0;i<1/0;i++)try{const t=await r(i);if(!n(i,null,t))return void e(t)}catch(e){if(!n(i,e))return void t(e)}})()}))}catch(e){if(this._debug(t,"error",e),Xt(e))return{data:{session:null,user:null},error:e};throw e}finally{this._debug(t,"end")}var r,n}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Sr()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await xr(this.storage,this.storageKey);if(n&&this.userStorage){let t=await xr(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:n.user},await jr(this.userStorage,this.storageKey+"-user",t)),n.user=null!==(e=null==t?void 0:t.user)&&void 0!==e?e:Mr()}else if(n&&!n.user&&!n.user){const e=await xr(this.storage,this.storageKey+"-user");e&&(null==e?void 0:e.user)?(n.user=e.user,await Or(this.storage,this.storageKey+"-user"),await jr(this.storage,this.storageKey,n)):n.user=Mr()}if(this._debug(r,"session from storage",n),!this._isValidSession(n))return this._debug(r,"session is not valid"),void(null!==n&&await this._removeSession());const i=1e3*(null!==(t=n.expires_at)&&void 0!==t?t:1/0)-Date.now()<Kt;if(this._debug(r,`session has${i?"":" not"} expired with margin of 90000s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:e}=await this._callRefreshToken(n.refresh_token);e&&(lr(e)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(n.user&&!0===n.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(n.access_token);!t&&(null==e?void 0:e.user)?(n.user=e.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(e){this._debug(r,"error getting user data, skipping SIGNED_IN notification",e)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(e){return void this._debug(r,"error",e)}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new nr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Cr;const{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new nr;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const n={session:t.session,error:null};return this.refreshingDeferred.resolve(n),n}catch(e){if(this._debug(n,"error",e),Xt(e)){const r={session:null,error:e};return lr(e)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(r),r}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(e),e}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,r=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const n=[],i=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(e){n.push(e)}});if(await Promise.all(i),n.length>0){for(let e=0;e<n.length;e+=1);throw n[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!r&&t.user&&await jr(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const n=Br(e);await jr(this.storage,this.storageKey,n)}else{const e=Br(t);await jr(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),await Or(this.storage,this.storageKey),await Or(this.storage,this.storageKey+"-code-verifier"),await Or(this.storage,this.storageKey+"-user"),this.userStorage&&await Or(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Sr()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ht);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const n=Math.floor((1e3*r.expires_at-e)/Ht);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),n<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(!(e.isAcquireTimeout||e instanceof tn))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Sr()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const n=[`provider=${encodeURIComponent(t)}`];if((null==r?void 0:r.redirectTo)&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null==r?void 0:r.scopes)&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){const[e,t]=await Lr(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});n.push(r.toString())}if(null==r?void 0:r.queryParams){const e=new URLSearchParams(r.queryParams);n.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:n,error:i}=t;return i?{data:null,error:i}:await zr(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token})})}catch(e){if(Xt(e))return{data:null,error:e};throw e}}async _enroll(e){try{return await this._useSession(async t=>{var r,n;const{data:i,error:s}=t;if(s)return{data:null,error:s};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:a,error:c}=await zr(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:null===(r=null==i?void 0:i.session)||void 0===r?void 0:r.access_token});return c?{data:null,error:c}:("totp"===e.factorType&&(null===(n=null==a?void 0:a.totp)||void 0===n?void 0:n.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(e){if(Xt(e))return{data:null,error:e};throw e}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:i}=t;if(i)return{data:null,error:i};const{data:s,error:o}=await zr(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:o})})}catch(e){if(Xt(e))return{data:null,error:e};throw e}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:i}=t;return i?{data:null,error:i}:await zr(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token})})}catch(e){if(Xt(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(null==e?void 0:e.factors)||[],n=r.filter(e=>"totp"===e.factor_type&&"verified"===e.status),i=r.filter(e=>"phone"===e.factor_type&&"verified"===e.status);return{data:{all:r,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=Pr(n.access_token);let o=null;s.aal&&(o=s.aal);let a=o;(null!==(r=null===(t=n.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==r?r:[]).length>0&&(a="aal2");return{data:{currentLevel:o,nextLevel:a,currentAuthenticationMethods:s.amr||[]},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(t=>t.kid===e);if(r)return r;const n=Date.now();if(r=this.jwks.keys.find(t=>t.kid===e),r&&this.jwks_cached_at+6e5>n)return r;const{data:i,error:s}=await zr(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;return i.keys&&0!==i.keys.length?(this.jwks=i,this.jwks_cached_at=n,r=i.keys.find(t=>t.kid===e),r||null):null}async getClaims(e,t={}){try{let r=e;if(!r){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};r=e.session.access_token}const{header:n,payload:i,signature:s,raw:{header:o,payload:a}}=Pr(r);(null==t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(i.exp);const c=n.alg&&!n.alg.startsWith("HS")&&n.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(n.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks):null;if(!c){const{error:e}=await this.getUser(r);if(e)throw e;return{data:{claims:i,header:n,signature:s},error:null}}const l=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(n.alg),u=await crypto.subtle.importKey("jwk",c,l,!0,["verify"]);if(!await crypto.subtle.verify(l,u,s,function(e){const t=[];return br(e,e=>t.push(e)),new Uint8Array(t)}(`${o}.${a}`)))throw new hr("Invalid JWT signature");return{data:{claims:i,header:n,signature:s},error:null}}catch(e){if(Xt(e))return{data:null,error:e};throw e}}}cn.nextInstanceID=0;const ln=cn;class un extends ln{constructor(e){super(e)}}var hn=function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})};class dn{constructor(e,t,r){var n,i,s;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=(a=e).endsWith("/")?a:a+"/";var a;const c=new URL(o);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const l=`sb-${c.hostname.split(".")[0]}-auth-token`,u=function(e,t){var r,n;const{db:i,auth:s,realtime:o,global:a}=e,{db:c,auth:l,realtime:u,global:h}=t,d={db:Object.assign(Object.assign({},c),i),auth:Object.assign(Object.assign({},l),s),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},null!==(r=null==h?void 0:h.headers)&&void 0!==r?r:{}),null!==(n=null==a?void 0:a.headers)&&void 0!==n?n:{})}),accessToken:()=>qt(this,void 0,void 0,function*(){return""})};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}(null!=r?r:{},{db:Mt,realtime:Nt,auth:Object.assign(Object.assign({},Bt),{storageKey:l}),global:$t});this.storageKey=null!==(n=u.auth.storageKey)&&void 0!==n?n:"",this.headers=null!==(i=u.global.headers)&&void 0!==i?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(s=u.auth)&&void 0!==s?s:{},this.headers,u.global.fetch),this.fetch=zt(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new Ie(new URL("rest/v1",c).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new Rt(this.storageUrl.href,this.headers,this.fetch,null==r?void 0:r.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new Ce(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return hn(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return null!==(t=null===(e=r.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,storageKey:i,flowType:s,lock:o,debug:a},c,l){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new un({url:this.authUrl.href,headers:Object.assign(Object.assign({},u),c),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,flowType:s,lock:o,debug:a,fetch:l,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new ut(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===r?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=r}}function fn(e){return fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fn(e)}function pn(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}throw new TypeError(fn(e)+" is not iterable")}function yn(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function s(r,n,i,s){var c=n&&n.prototype instanceof a?n:a,l=Object.create(c.prototype);return mn(l,"_invoke",function(r,n,i){var s,a,c,l=0,u=i||[],h=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,r){return s=t,a=0,c=e,d.n=r,o}};function f(r,n){for(a=r,c=n,t=0;!h&&l&&!i&&t<u.length;t++){var i,s=u[t],f=d.p,p=s[2];r>3?(i=p===n)&&(c=s[(a=s[4])?5:(a=3,3)],s[4]=s[5]=e):s[0]<=f&&((i=r<2&&f<s[1])?(a=0,d.v=n,d.n=s[1]):f<p&&(i=r<3||s[0]>n||n>p)&&(s[4]=r,s[5]=n,d.n=p,a=0))}if(i||r>1)return o;throw h=!0,n}return function(i,u,p){if(l>1)throw TypeError("Generator is already running");for(h&&1===u&&f(u,p),a=u,c=p;(t=a<2?e:c)||!h;){s||(a?a<3?(a>1&&(d.n=-1),f(a,c)):d.n=c:d.v=c);try{if(l=2,s){if(a||(i="next"),t=s[i]){if(!(t=t.call(s,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,a<2&&(a=0)}else 1===a&&(t=s.return)&&t.call(s),a<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),a=1);s=e}else if((t=(h=d.n<0)?c:r.call(n,d))!==o)break}catch(t){s=e,a=1,c=t}finally{l=1}}return{value:t,done:h}}}(r,i,s),!0),l}var o={};function a(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(mn(t={},n,function(){return this}),t),h=l.prototype=a.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,mn(e,i,"GeneratorFunction")),e.prototype=Object.create(h),e}return c.prototype=l,mn(h,"constructor",l),mn(l,"constructor",c),c.displayName="GeneratorFunction",mn(l,i,"GeneratorFunction"),mn(h),mn(h,i,"Generator"),mn(h,n,function(){return this}),mn(h,"toString",function(){return"[object Generator]"}),(yn=function(){return{w:s,m:d}})()}function mn(e,t,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}mn=function(e,t,r,n){function s(t,r){mn(e,t,function(e){return this._invoke(t,r,e)})}t?i?i(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(s("next",0),s("throw",1),s("return",2))},mn(e,t,r,n)}function gn(e,t,r,n,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,i)}function vn(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var s=e.apply(t,r);function o(e){gn(s,n,i,o,a,"next",e)}function a(e){gn(s,n,i,o,a,"throw",e)}o(void 0)})}}function bn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wn(n.key),n)}}function wn(e){var t=function(e,t){if("object"!=fn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=fn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==fn(t)?t:t+""}!function(){if("undefined"!=typeof window||"undefined"==typeof process||void 0===process.version||null===process.version)return!1;const e=process.version.match(/^v(\d+)\./);!!e&&parseInt(e[1],10)}();var kn=function(){return e=function e(){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.supabase=new dn("https://your-project-url.supabase.co","your-anon-key",t),this.isConnected=!1,this.realtimeSubscription=null,this.retryCount=0,this.maxRetries=3},t=[{key:"initialize",value:(h=vn(yn().m(function e(){var t;return yn().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.supabase.from("cocktails").select("count").limit(1);case 1:if((t=e.v).data,!t.error){e.n=2;break}return e.a(2,!1);case 2:return this.isConnected=!0,e.a(2,!0);case 3:return e.p=3,e.v,e.a(2,!1)}},e,this,[[0,3]])})),function(){return h.apply(this,arguments)})},{key:"getCocktails",value:(u=vn(yn().m(function e(){var t,r,n;return yn().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.supabase.from("cocktails").select("*").order("name");case 1:if(t=e.v,r=t.data,!(n=t.error)){e.n=2;break}throw n;case 2:return e.a(2,r||[]);case 3:return e.p=3,e.v,e.a(2,this.getFallbackCocktails())}},e,this,[[0,3]])})),function(){return u.apply(this,arguments)})},{key:"addCocktail",value:(l=vn(yn().m(function e(t){var r,n,i;return yn().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.supabase.from("cocktails").insert([{name:t.name,ingredients:t.ingredients,recipe:t.recipe,category:t.category||"classic",difficulty:t.difficulty||"medium",prep_time:t.prepTime||5,glass_type:t.glassType||"rocks",garnish:t.garnish||"",notes:t.notes||"",created_at:(new Date).toISOString()}]).select();case 1:if(r=e.v,n=r.data,!(i=r.error)){e.n=2;break}throw i;case 2:return e.a(2,n[0]);case 3:throw e.p=3,e.v;case 4:return e.a(2)}},e,this,[[0,3]])})),function(e){return l.apply(this,arguments)})},{key:"updateCocktail",value:(c=vn(yn().m(function e(t,r){var n,i,s;return yn().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.supabase.from("cocktails").update(r).eq("id",t).select();case 1:if(n=e.v,i=n.data,!(s=n.error)){e.n=2;break}throw s;case 2:return e.a(2,i[0]);case 3:throw e.p=3,e.v;case 4:return e.a(2)}},e,this,[[0,3]])})),function(e,t){return c.apply(this,arguments)})},{key:"deleteCocktail",value:(a=vn(yn().m(function e(t){var r,n;return yn().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.supabase.from("cocktails").delete().eq("id",t);case 1:if(r=e.v,!(n=r.error)){e.n=2;break}throw n;case 2:return e.a(2,!0);case 3:throw e.p=3,e.v;case 4:return e.a(2)}},e,this,[[0,3]])})),function(e){return a.apply(this,arguments)})},{key:"searchCocktails",value:(o=vn(yn().m(function e(t){var r,n,i;return yn().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.supabase.from("cocktails").select("*").or("name.ilike.%".concat(t,"%,ingredients.ilike.%").concat(t,"%,recipe.ilike.%").concat(t,"%")).order("name");case 1:if(r=e.v,n=r.data,!(i=r.error)){e.n=2;break}throw i;case 2:return e.a(2,n||[]);case 3:return e.p=3,e.v,e.a(2,[])}},e,this,[[0,3]])})),function(e){return o.apply(this,arguments)})},{key:"getCocktailsByCategory",value:(s=vn(yn().m(function e(t){var r,n,i;return yn().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.supabase.from("cocktails").select("*").eq("category",t).order("name");case 1:if(r=e.v,n=r.data,!(i=r.error)){e.n=2;break}throw i;case 2:return e.a(2,n||[]);case 3:return e.p=3,e.v,e.a(2,[])}},e,this,[[0,3]])})),function(e){return s.apply(this,arguments)})},{key:"subscribeToCocktails",value:function(e){return this.realtimeSubscription&&this.supabase.removeChannel(this.realtimeSubscription),this.realtimeSubscription=this.supabase.channel("cocktails_changes").on("postgres_changes",{event:"*",schema:"public",table:"cocktails"},function(t){e(t)}).subscribe(),this.realtimeSubscription}},{key:"unsubscribeFromCocktails",value:function(){this.realtimeSubscription&&(this.supabase.removeChannel(this.realtimeSubscription),this.realtimeSubscription=null)}},{key:"getFallbackCocktails",value:function(){return[{id:1,name:"Old Fashioned",ingredients:["2 oz Bourbon or Rye Whiskey","1/2 oz Simple Syrup","2 dashes Angostura Bitters","Orange peel for garnish"],recipe:"Combine whiskey, simple syrup, and bitters in a mixing glass with ice. Stir until well-chilled. Strain into a rocks glass over a large ice cube. Express the oil from an orange peel over the drink and drop it in.",category:"classic",difficulty:"easy",prep_time:5,glass_type:"rocks",garnish:"Orange peel",notes:"A timeless classic that showcases the whiskey",created_at:(new Date).toISOString()},{id:2,name:"Margarita",ingredients:["2 oz Tequila (Blanco or Reposado)","1 oz Fresh Lime Juice","3/4 oz Orange Liqueur (Cointreau or Triple Sec)","Salt for rim (optional)","Lime wedge for garnish"],recipe:"If desired, salt the rim of a chilled margarita glass. Combine tequila, lime juice, and orange liqueur in a shaker with ice. Shake well until thoroughly chilled. Strain into the prepared glass. Garnish with a lime wedge.",category:"classic",difficulty:"medium",prep_time:4,glass_type:"margarita",garnish:"Lime wedge",notes:"Perfect balance of sweet, sour, and tequila",created_at:(new Date).toISOString()},{id:3,name:"Mojito",ingredients:["2 oz White Rum","1 oz Fresh Lime Juice","2 tsp Granulated Sugar","6-8 Fresh Mint Leaves","Soda Water","Mint sprig and lime wedge for garnish"],recipe:"In a sturdy glass, gently muddle the mint leaves with lime juice and sugar. Add rum and fill the glass with crushed ice. Top with soda water and stir gently. Garnish with a mint sprig and lime wedge.",category:"refreshing",difficulty:"medium",prep_time:6,glass_type:"collins",garnish:"Mint sprig, lime wedge",notes:"Refreshing and perfect for warm weather",created_at:(new Date).toISOString()},{id:4,name:"Negroni",ingredients:["1 oz Gin","1 oz Campari","1 oz Sweet Vermouth","Orange slice for garnish"],recipe:"Combine gin, Campari, and sweet vermouth in a mixing glass with ice. Stir until well-chilled. Strain into a rocks glass over a large ice cube. Garnish with an orange slice.",category:"classic",difficulty:"easy",prep_time:3,glass_type:"rocks",garnish:"Orange slice",notes:"Bitter, complex, and sophisticated",created_at:(new Date).toISOString()},{id:5,name:"Espresso Martini",ingredients:["1.5 oz Vodka","1 oz Coffee Liqueur","1 oz Freshly Brewed Espresso (chilled)","0.5 oz Simple Syrup (optional, to taste)","Coffee beans for garnish"],recipe:"Combine vodka, coffee liqueur, espresso, and simple syrup (if using) in a shaker with ice. Shake vigorously until well-chilled and a frothy layer forms. Double strain into a chilled coupe or martini glass. Garnish with three coffee beans.",category:"modern",difficulty:"hard",prep_time:8,glass_type:"coupe",garnish:"Coffee beans",notes:"Perfect after-dinner cocktail with a caffeine kick",created_at:(new Date).toISOString()}]}},{key:"testConnection",value:(i=vn(yn().m(function e(){var t,r;return yn().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.supabase.from("cocktails").select("count").limit(1);case 1:return(t=e.v).data,r=t.error,e.a(2,!r);case 2:return e.p=2,e.v,e.a(2,!1)}},e,this,[[0,2]])})),function(){return i.apply(this,arguments)})},{key:"getConnectionStatus",value:function(){return this.isConnected}},{key:"retryOperation",value:(n=vn(yn().m(function e(t){var r,n,i,s,o=arguments;return yn().w(function(e){for(;;)switch(e.n){case 0:r=o.length>1&&void 0!==o[1]?o[1]:3,n=yn().m(function e(n){var i,s;return yn().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,t();case 1:return i=e.v,e.a(2,{v:i});case 2:if(e.p=2,s=e.v,n!==r-1){e.n=3;break}throw s;case 3:return e.n=4,new Promise(function(e){return setTimeout(e,1e3*(n+1))});case 4:return e.a(2)}},e,null,[[0,2]])}),s=0;case 1:if(!(s<r)){e.n=4;break}return e.d(pn(n(s)),2);case 2:if(!(i=e.v)){e.n=3;break}return e.a(2,i.v);case 3:s++,e.n=1;break;case 4:return e.a(2)}},e)})),function(e){return n.apply(this,arguments)})}],t&&bn(e.prototype,t),r&&bn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,n,i,s,o,a,c,l,u,h}();function Sn(e){return Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sn(e)}function _n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Tn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_n(Object(r),!0).forEach(function(t){En(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function En(e,t,r){return(t=Ln(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jn(e){return function(e){if(Array.isArray(e))return xn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return xn(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xn(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function On(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function s(r,n,i,s){var c=n&&n.prototype instanceof a?n:a,l=Object.create(c.prototype);return Cn(l,"_invoke",function(r,n,i){var s,a,c,l=0,u=i||[],h=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,r){return s=t,a=0,c=e,d.n=r,o}};function f(r,n){for(a=r,c=n,t=0;!h&&l&&!i&&t<u.length;t++){var i,s=u[t],f=d.p,p=s[2];r>3?(i=p===n)&&(c=s[(a=s[4])?5:(a=3,3)],s[4]=s[5]=e):s[0]<=f&&((i=r<2&&f<s[1])?(a=0,d.v=n,d.n=s[1]):f<p&&(i=r<3||s[0]>n||n>p)&&(s[4]=r,s[5]=n,d.n=p,a=0))}if(i||r>1)return o;throw h=!0,n}return function(i,u,p){if(l>1)throw TypeError("Generator is already running");for(h&&1===u&&f(u,p),a=u,c=p;(t=a<2?e:c)||!h;){s||(a?a<3?(a>1&&(d.n=-1),f(a,c)):d.n=c:d.v=c);try{if(l=2,s){if(a||(i="next"),t=s[i]){if(!(t=t.call(s,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,a<2&&(a=0)}else 1===a&&(t=s.return)&&t.call(s),a<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),a=1);s=e}else if((t=(h=d.n<0)?c:r.call(n,d))!==o)break}catch(t){s=e,a=1,c=t}finally{l=1}}return{value:t,done:h}}}(r,i,s),!0),l}var o={};function a(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(Cn(t={},n,function(){return this}),t),h=l.prototype=a.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,Cn(e,i,"GeneratorFunction")),e.prototype=Object.create(h),e}return c.prototype=l,Cn(h,"constructor",l),Cn(l,"constructor",c),c.displayName="GeneratorFunction",Cn(l,i,"GeneratorFunction"),Cn(h),Cn(h,i,"Generator"),Cn(h,n,function(){return this}),Cn(h,"toString",function(){return"[object Generator]"}),(On=function(){return{w:s,m:d}})()}function Cn(e,t,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}Cn=function(e,t,r,n){function s(t,r){Cn(e,t,function(e){return this._invoke(t,r,e)})}t?i?i(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(s("next",0),s("throw",1),s("return",2))},Cn(e,t,r,n)}function Pn(e,t,r,n,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,i)}function In(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var s=e.apply(t,r);function o(e){Pn(s,n,i,o,a,"next",e)}function a(e){Pn(s,n,i,o,a,"throw",e)}o(void 0)})}}function An(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ln(n.key),n)}}function Ln(e){var t=function(e,t){if("object"!=Sn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Sn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Sn(t)?t:t+""}var Rn=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.supabaseService=new kn,this.currentCocktails=[],this.filteredCocktails=[],this.currentFilter="all",this.currentSearch="",this.isInitialized=!1,this.realtimeSubscription=null},t=[{key:"initialize",value:(h=In(On().m(function e(){return On().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.supabaseService.initialize();case 1:return e.v&&this.setupRealtimeUpdates(),e.n=2,this.loadCocktails();case 2:this.setupEventListeners(),this.isInitialized=!0,e.n=4;break;case 3:return e.p=3,e.v,e.n=4,this.loadFallbackCocktails();case 4:return e.a(2)}},e,this,[[0,3]])})),function(){return h.apply(this,arguments)})},{key:"loadCocktails",value:(u=In(On().m(function e(){return On().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.supabaseService.getCocktails();case 1:this.currentCocktails=e.v,this.filteredCocktails=jn(this.currentCocktails),this.renderCocktails(),e.n=3;break;case 2:return e.p=2,e.v,e.n=3,this.loadFallbackCocktails();case 3:return e.a(2)}},e,this,[[0,2]])})),function(){return u.apply(this,arguments)})},{key:"loadFallbackCocktails",value:(l=In(On().m(function e(){return On().w(function(e){for(;;)switch(e.n){case 0:this.currentCocktails=this.supabaseService.getFallbackCocktails(),this.filteredCocktails=jn(this.currentCocktails),this.renderCocktails();case 1:return e.a(2)}},e,this)})),function(){return l.apply(this,arguments)})},{key:"setupRealtimeUpdates",value:function(){var e=this;this.realtimeSubscription=this.supabaseService.subscribeToCocktails(function(t){e.handleRealtimeUpdate(t)})}},{key:"handleRealtimeUpdate",value:function(e){switch(e.eventType){case"INSERT":this.currentCocktails.push(e.new);break;case"UPDATE":var t=this.currentCocktails.findIndex(function(t){return t.id===e.new.id});-1!==t&&(this.currentCocktails[t]=e.new);break;case"DELETE":this.currentCocktails=this.currentCocktails.filter(function(t){return t.id!==e.old.id})}this.applyFiltersAndSearch(),this.renderCocktails(),this.showNotification("Cocktail menu updated in real-time!","success")}},{key:"setupEventListeners",value:function(){var e=this,t=document.getElementById("cocktailSearch");t&&t.addEventListener("input",function(t){e.currentSearch=t.target.value.toLowerCase(),e.applyFiltersAndSearch(),e.renderCocktails()});var r=document.querySelectorAll(".cocktail-filter");r.forEach(function(t){t.addEventListener("click",function(t){r.forEach(function(e){return e.classList.remove("active")}),t.target.classList.add("active"),e.currentFilter=t.target.dataset.filter,e.applyFiltersAndSearch(),e.renderCocktails()})});var n=document.getElementById("addCocktailBtn");n&&n.addEventListener("click",function(){e.showAddCocktailModal()})}},{key:"applyFiltersAndSearch",value:function(){var e=this,t=jn(this.currentCocktails);"all"!==this.currentFilter&&(t=t.filter(function(t){return t.category===e.currentFilter})),this.currentSearch&&(t=t.filter(function(t){return t.name.toLowerCase().includes(e.currentSearch)||t.ingredients.some(function(t){return t.toLowerCase().includes(e.currentSearch)})||t.recipe.toLowerCase().includes(e.currentSearch)})),this.filteredCocktails=t}},{key:"renderCocktails",value:function(){var e=this,t=document.getElementById("cocktailList");t&&(t.innerHTML="",0!==this.filteredCocktails.length?(this.filteredCocktails.forEach(function(r){var n=e.createCocktailCard(r);t.appendChild(n)}),this.updateCocktailCounter()):t.innerHTML='\n                <div class="col-span-full text-center py-12">\n                    <i class="fas fa-cocktail text-6xl text-gray-500 mb-4"></i>\n                    <h3 class="text-xl font-semibold text-gray-400 mb-2">No cocktails found</h3>\n                    <p class="text-gray-500">Try adjusting your search or filter criteria</p>\n                </div>\n            ')}},{key:"createCocktailCard",value:function(e){var t=document.createElement("div");t.className="glass-panel p-6 rounded-lg hover:bg-opacity-80 transition-all duration-300";var r=this.getDifficultyColor(e.difficulty),n=this.getCategoryColor(e.category);return t.innerHTML='\n            <div class="flex justify-between items-start mb-4">\n                <h3 class="text-2xl font-bold text-yellow-400">'.concat(e.name,'</h3>\n                <div class="flex gap-2">\n                    <span class="px-2 py-1 text-xs rounded-full ').concat(n,'">').concat(e.category,'</span>\n                    <span class="px-2 py-1 text-xs rounded-full ').concat(r,'">').concat(e.difficulty,'</span>\n                </div>\n            </div>\n            \n            <div class="grid md:grid-cols-2 gap-6">\n                <div>\n                    <h4 class="font-semibold mb-2 text-green-400">\n                        <i class="fas fa-list-ul mr-2"></i>Ingredients:\n                    </h4>\n                    <ul class="list-disc list-inside text-gray-300 mb-4 space-y-1">\n                        ').concat(e.ingredients.map(function(e){return"<li>".concat(e,"</li>")}).join(""),'\n                    </ul>\n                    \n                    <div class="flex items-center gap-4 text-sm text-gray-400 mb-4">\n                        <span><i class="fas fa-clock mr-1"></i>').concat(e.prep_time,' min</span>\n                        <span><i class="fas fa-glass-martini mr-1"></i>').concat(e.glass_type,"</span>\n                        ").concat(e.garnish?'<span><i class="fas fa-leaf mr-1"></i>'.concat(e.garnish,"</span>"):"",'\n                    </div>\n                </div>\n                \n                <div>\n                    <h4 class="font-semibold mb-2 text-blue-400">\n                        <i class="fas fa-magic mr-2"></i>Recipe:\n                    </h4>\n                    <p class="text-gray-300 text-sm leading-relaxed">').concat(e.recipe,"</p>\n                    \n                    ").concat(e.notes?'\n                        <div class="mt-4 p-3 bg-black bg-opacity-30 rounded-lg">\n                            <h5 class="font-semibold text-purple-400 mb-1">\n                                <i class="fas fa-lightbulb mr-1"></i>Notes:\n                            </h5>\n                            <p class="text-gray-300 text-sm">'.concat(e.notes,"</p>\n                        </div>\n                    "):"",'\n                </div>\n            </div>\n            \n            <div class="flex justify-end gap-2 mt-4 pt-4 border-t border-gray-700">\n                <button onclick="cocktailsManager.editCocktail(').concat(e.id,')" \n                        class="btn-secondary px-3 py-1 text-sm">\n                    <i class="fas fa-edit mr-1"></i>Edit\n                </button>\n                <button onclick="cocktailsManager.deleteCocktail(').concat(e.id,')" \n                        class="btn-danger px-3 py-1 text-sm">\n                    <i class="fas fa-trash mr-1"></i>Delete\n                </button>\n            </div>\n        '),t}},{key:"getDifficultyColor",value:function(e){return{easy:"bg-green-600 text-white",medium:"bg-yellow-600 text-white",hard:"bg-red-600 text-white"}[e]||"bg-gray-600 text-white"}},{key:"getCategoryColor",value:function(e){return{classic:"bg-blue-600 text-white",modern:"bg-purple-600 text-white",refreshing:"bg-green-600 text-white",tropical:"bg-orange-600 text-white",spirit_forward:"bg-red-600 text-white"}[e]||"bg-gray-600 text-white"}},{key:"updateCocktailCounter",value:function(){var e=document.getElementById("cocktailCounter");if(e){var t=this.currentCocktails.length,r=this.filteredCocktails.length;e.textContent="".concat(r," of ").concat(t," cocktails")}}},{key:"addCocktail",value:(c=In(On().m(function e(t){var r,n;return On().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.supabaseService.addCocktail(t);case 1:return r=e.v,this.currentCocktails.push(r),this.applyFiltersAndSearch(),this.renderCocktails(),this.showNotification("Cocktail added successfully!","success"),e.a(2,r);case 2:throw e.p=2,n=e.v,this.showNotification("Failed to add cocktail","error"),n;case 3:return e.a(2)}},e,this,[[0,2]])})),function(e){return c.apply(this,arguments)})},{key:"editCocktail",value:(a=In(On().m(function e(t){var r;return On().w(function(e){for(;;)switch(e.n){case 0:if(r=this.currentCocktails.find(function(e){return e.id===t})){e.n=1;break}return e.a(2);case 1:this.showEditCocktailModal(r);case 2:return e.a(2)}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"updateCocktail",value:(o=In(On().m(function e(t,r){var n,i,s;return On().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.supabaseService.updateCocktail(t,r);case 1:return n=e.v,-1!==(i=this.currentCocktails.findIndex(function(e){return e.id===t}))&&(this.currentCocktails[i]=n),this.applyFiltersAndSearch(),this.renderCocktails(),this.showNotification("Cocktail updated successfully!","success"),e.a(2,n);case 2:throw e.p=2,s=e.v,this.showNotification("Failed to update cocktail","error"),s;case 3:return e.a(2)}},e,this,[[0,2]])})),function(e,t){return o.apply(this,arguments)})},{key:"deleteCocktail",value:(s=In(On().m(function e(t){return On().w(function(e){for(;;)switch(e.p=e.n){case 0:if(confirm("Are you sure you want to delete this cocktail?")){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,this.supabaseService.deleteCocktail(t);case 2:this.currentCocktails=this.currentCocktails.filter(function(e){return e.id!==t}),this.applyFiltersAndSearch(),this.renderCocktails(),this.showNotification("Cocktail deleted successfully!","success"),e.n=4;break;case 3:e.p=3,e.v,this.showNotification("Failed to delete cocktail","error");case 4:return e.a(2)}},e,this,[[1,3]])})),function(e){return s.apply(this,arguments)})},{key:"showAddCocktailModal",value:function(){var e=this;this.showCocktailModal({title:"Add New Cocktail",cocktail:{name:"",ingredients:[""],recipe:"",category:"classic",difficulty:"medium",prepTime:5,glassType:"rocks",garnish:"",notes:""},onSave:function(t){return e.addCocktail(t)}})}},{key:"showEditCocktailModal",value:function(e){var t=this;this.showCocktailModal({title:"Edit Cocktail",cocktail:Tn({},e),onSave:function(r){return t.updateCocktail(e.id,r)}})}},{key:"showCocktailModal",value:function(e){var t=e.title,r=e.cocktail,n=e.onSave,i=document.createElement("div");i.className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",i.innerHTML='\n            <div class="glass-panel p-8 rounded-lg w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto">\n                <div class="flex justify-between items-center mb-6">\n                    <h2 class="text-2xl font-bold">'.concat(t,'</h2>\n                    <button onclick="this.closest(\'.fixed\').remove()" class="text-gray-400 hover:text-white">\n                        <i class="fas fa-times text-xl"></i>\n                    </button>\n                </div>\n                \n                <form id="cocktailForm" class="space-y-6">\n                    <div class="grid md:grid-cols-2 gap-4">\n                        <div>\n                            <label class="block text-sm font-medium mb-2">Name</label>\n                            <input type="text" name="name" value="').concat(r.name,'" \n                                   class="w-full px-4 py-3 bg-black bg-opacity-50 border border-gray-600 rounded-lg focus:outline-none focus:border-green-600 text-white" required>\n                        </div>\n                        \n                        <div>\n                            <label class="block text-sm font-medium mb-2">Category</label>\n                            <select name="category" class="w-full px-4 py-3 bg-black bg-opacity-50 border border-gray-600 rounded-lg focus:outline-none focus:border-green-600 text-white">\n                                <option value="classic" ').concat("classic"===r.category?"selected":"",'>Classic</option>\n                                <option value="modern" ').concat("modern"===r.category?"selected":"",'>Modern</option>\n                                <option value="refreshing" ').concat("refreshing"===r.category?"selected":"",'>Refreshing</option>\n                                <option value="tropical" ').concat("tropical"===r.category?"selected":"",'>Tropical</option>\n                                <option value="spirit_forward" ').concat("spirit_forward"===r.category?"selected":"",'>Spirit Forward</option>\n                            </select>\n                        </div>\n                    </div>\n                    \n                    <div class="grid md:grid-cols-3 gap-4">\n                        <div>\n                            <label class="block text-sm font-medium mb-2">Difficulty</label>\n                            <select name="difficulty" class="w-full px-4 py-3 bg-black bg-opacity-50 border border-gray-600 rounded-lg focus:outline-none focus:border-green-600 text-white">\n                                <option value="easy" ').concat("easy"===r.difficulty?"selected":"",'>Easy</option>\n                                <option value="medium" ').concat("medium"===r.difficulty?"selected":"",'>Medium</option>\n                                <option value="hard" ').concat("hard"===r.difficulty?"selected":"",'>Hard</option>\n                            </select>\n                        </div>\n                        \n                        <div>\n                            <label class="block text-sm font-medium mb-2">Prep Time (min)</label>\n                            <input type="number" name="prepTime" value="').concat(r.prepTime||r.prep_time||5,'" min="1" max="30"\n                                   class="w-full px-4 py-3 bg-black bg-opacity-50 border border-gray-600 rounded-lg focus:outline-none focus:border-green-600 text-white">\n                        </div>\n                        \n                        <div>\n                            <label class="block text-sm font-medium mb-2">Glass Type</label>\n                            <select name="glassType" class="w-full px-4 py-3 bg-black bg-opacity-50 border border-gray-600 rounded-lg focus:outline-none focus:border-green-600 text-white">\n                                <option value="rocks" ').concat("rocks"===(r.glassType||r.glass_type)?"selected":"",'>Rocks</option>\n                                <option value="coupe" ').concat("coupe"===(r.glassType||r.glass_type)?"selected":"",'>Coupe</option>\n                                <option value="martini" ').concat("martini"===(r.glassType||r.glass_type)?"selected":"",'>Martini</option>\n                                <option value="collins" ').concat("collins"===(r.glassType||r.glass_type)?"selected":"",'>Collins</option>\n                                <option value="margarita" ').concat("margarita"===(r.glassType||r.glass_type)?"selected":"",'>Margarita</option>\n                            </select>\n                        </div>\n                    </div>\n                    \n                    <div>\n                        <label class="block text-sm font-medium mb-2">Ingredients</label>\n                        <div id="ingredientsList" class="space-y-2">\n                            ').concat((r.ingredients||[]).map(function(e){return'\n                                <div class="flex gap-2">\n                                    <input type="text" value="'.concat(e,'" \n                                           class="flex-1 px-4 py-3 bg-black bg-opacity-50 border border-gray-600 rounded-lg focus:outline-none focus:border-green-600 text-white ingredient-input">\n                                    <button type="button" onclick="this.parentElement.remove()" class="px-3 py-3 bg-red-600 hover:bg-red-700 rounded-lg">\n                                        <i class="fas fa-trash"></i>\n                                    </button>\n                                </div>\n                            ')}).join(""),'\n                        </div>\n                        <button type="button" onclick="addIngredientField()" class="mt-2 btn-secondary px-4 py-2 text-sm">\n                            <i class="fas fa-plus mr-1"></i>Add Ingredient\n                        </button>\n                    </div>\n                    \n                    <div>\n                        <label class="block text-sm font-medium mb-2">Recipe</label>\n                        <textarea name="recipe" rows="4" \n                                  class="w-full px-4 py-3 bg-black bg-opacity-50 border border-gray-600 rounded-lg focus:outline-none focus:border-green-600 text-white" required>').concat(r.recipe,'</textarea>\n                    </div>\n                    \n                    <div class="grid md:grid-cols-2 gap-4">\n                        <div>\n                            <label class="block text-sm font-medium mb-2">Garnish</label>\n                            <input type="text" name="garnish" value="').concat(r.garnish||"",'" \n                                   class="w-full px-4 py-3 bg-black bg-opacity-50 border border-gray-600 rounded-lg focus:outline-none focus:border-green-600 text-white">\n                        </div>\n                        \n                        <div>\n                            <label class="block text-sm font-medium mb-2">Notes</label>\n                            <input type="text" name="notes" value="').concat(r.notes||"",'" \n                                   class="w-full px-4 py-3 bg-black bg-opacity-50 border border-gray-600 rounded-lg focus:outline-none focus:border-green-600 text-white">\n                        </div>\n                    </div>\n                    \n                    <div class="flex justify-end gap-4 pt-4 border-t border-gray-700">\n                        <button type="button" onclick="this.closest(\'.fixed\').remove()" class="btn-secondary px-6 py-2">\n                            Cancel\n                        </button>\n                        <button type="submit" class="btn-primary px-6 py-2">\n                            Save Cocktail\n                        </button>\n                    </div>\n                </form>\n            </div>\n        '),document.body.appendChild(i);var s=i.querySelector("#cocktailForm");s.addEventListener("submit",function(e){e.preventDefault();var t=new FormData(s),r={name:t.get("name"),ingredients:Array.from(s.querySelectorAll(".ingredient-input")).map(function(e){return e.value}).filter(Boolean),recipe:t.get("recipe"),category:t.get("category"),difficulty:t.get("difficulty"),prepTime:parseInt(t.get("prepTime")),glassType:t.get("glassType"),garnish:t.get("garnish"),notes:t.get("notes")};n(r),i.remove()}),window.addIngredientField=function(){var e=i.querySelector("#ingredientsList"),t=document.createElement("div");t.className="flex gap-2",t.innerHTML='\n                <input type="text" class="flex-1 px-4 py-3 bg-black bg-opacity-50 border border-gray-600 rounded-lg focus:outline-none focus:border-green-600 text-white ingredient-input">\n                <button type="button" onclick="this.parentElement.remove()" class="px-3 py-3 bg-red-600 hover:bg-red-700 rounded-lg">\n                    <i class="fas fa-trash"></i>\n                </button>\n            ',e.appendChild(t)}}},{key:"showNotification",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=document.createElement("div");r.className="fixed top-4 right-4 px-6 py-3 rounded-lg text-white z-50 ".concat("success"===t?"bg-green-600":"error"===t?"bg-red-600":"bg-blue-600"),r.innerHTML='\n            <div class="flex items-center gap-2">\n                <i class="fas fa-'.concat("success"===t?"check":"error"===t?"exclamation-triangle":"info-circle",'"></i>\n                <span>').concat(e,"</span>\n            </div>\n        "),document.body.appendChild(r),setTimeout(function(){r.remove()},3e3)}},{key:"searchCocktails",value:(i=In(On().m(function e(t){var r;return On().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.supabaseService.searchCocktails(t);case 1:return r=e.v,this.filteredCocktails=r,this.renderCocktails(),e.a(2,r);case 2:return e.p=2,e.v,e.a(2,[])}},e,this,[[0,2]])})),function(e){return i.apply(this,arguments)})},{key:"getCocktailsByCategory",value:(n=In(On().m(function e(t){var r;return On().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.supabaseService.getCocktailsByCategory(t);case 1:return r=e.v,this.filteredCocktails=r,this.renderCocktails(),e.a(2,r);case 2:return e.p=2,e.v,e.a(2,[])}},e,this,[[0,2]])})),function(e){return n.apply(this,arguments)})},{key:"cleanup",value:function(){this.realtimeSubscription&&this.supabaseService.unsubscribeFromCocktails()}}],t&&An(e.prototype,t),r&&An(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,n,i,s,o,a,c,l,u,h}());function Dn(e){return Dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dn(e)}function $n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Mn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$n(Object(r),!0).forEach(function(t){Bn(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Bn(e,t,r){return(t=Hn(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nn(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function s(r,n,i,s){var c=n&&n.prototype instanceof a?n:a,l=Object.create(c.prototype);return Un(l,"_invoke",function(r,n,i){var s,a,c,l=0,u=i||[],h=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,r){return s=t,a=0,c=e,d.n=r,o}};function f(r,n){for(a=r,c=n,t=0;!h&&l&&!i&&t<u.length;t++){var i,s=u[t],f=d.p,p=s[2];r>3?(i=p===n)&&(c=s[(a=s[4])?5:(a=3,3)],s[4]=s[5]=e):s[0]<=f&&((i=r<2&&f<s[1])?(a=0,d.v=n,d.n=s[1]):f<p&&(i=r<3||s[0]>n||n>p)&&(s[4]=r,s[5]=n,d.n=p,a=0))}if(i||r>1)return o;throw h=!0,n}return function(i,u,p){if(l>1)throw TypeError("Generator is already running");for(h&&1===u&&f(u,p),a=u,c=p;(t=a<2?e:c)||!h;){s||(a?a<3?(a>1&&(d.n=-1),f(a,c)):d.n=c:d.v=c);try{if(l=2,s){if(a||(i="next"),t=s[i]){if(!(t=t.call(s,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,a<2&&(a=0)}else 1===a&&(t=s.return)&&t.call(s),a<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),a=1);s=e}else if((t=(h=d.n<0)?c:r.call(n,d))!==o)break}catch(t){s=e,a=1,c=t}finally{l=1}}return{value:t,done:h}}}(r,i,s),!0),l}var o={};function a(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(Un(t={},n,function(){return this}),t),h=l.prototype=a.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,Un(e,i,"GeneratorFunction")),e.prototype=Object.create(h),e}return c.prototype=l,Un(h,"constructor",l),Un(l,"constructor",c),c.displayName="GeneratorFunction",Un(l,i,"GeneratorFunction"),Un(h),Un(h,i,"Generator"),Un(h,n,function(){return this}),Un(h,"toString",function(){return"[object Generator]"}),(Nn=function(){return{w:s,m:d}})()}function Un(e,t,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}Un=function(e,t,r,n){function s(t,r){Un(e,t,function(e){return this._invoke(t,r,e)})}t?i?i(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(s("next",0),s("throw",1),s("return",2))},Un(e,t,r,n)}function Wn(e,t,r,n,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,i)}function Fn(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var s=e.apply(t,r);function o(e){Wn(s,n,i,o,a,"next",e)}function a(e){Wn(s,n,i,o,a,"throw",e)}o(void 0)})}}function zn(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return qn(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw s}}}}function qn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Gn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hn(n.key),n)}}function Hn(e){var t=function(e,t){if("object"!=Dn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Dn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Dn(t)?t:t+""}var Kn=function(){return e=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state={items86:JSON.parse(localStorage.getItem("items86")||"[]"),inventoryData:JSON.parse(localStorage.getItem("inventoryData")||"{}"),ocrData:{redWine:null,whiteWine:null,starters:[],entrees:[],cocktail:null},recognition:null,isListening:!1},this.elements={},this.modules={},this.services={},this.initializeServices(),window.logout=function(){return t.logout()}},t=[{key:"init",value:function(){this.cacheElements(),this.initializeModules(),this.setupEventListeners(),this.setupNavigation(),this.setupEnhancedFeatures(),this.registerServiceWorker(),this.startPerformanceMonitoring()}},{key:"startPerformanceMonitoring",value:function(){"PerformanceObserver"in window&&new PerformanceObserver(function(e){var t,r=zn(e.getEntries());try{for(r.s();!(t=r.n()).done;)t.value.duration}catch(e){r.e(e)}finally{r.f()}}).observe({entryTypes:["longtask"]}),setInterval(function(){if("memory"in performance){var e=performance.memory;e.usedJSHeapSize,e.totalJSHeapSize}},1e4)}},{key:"registerServiceWorker",value:function(){"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(function(e){}).catch(function(e){})}},{key:"cacheElements",value:function(){var e=this;["alert86List","current86Items","todaySpecial","inventoryGrid","voiceStatus","voiceText","ocrPreview","ocrResult"].forEach(function(t){e.elements[t]=document.getElementById(t)})}},{key:"initializeModules",value:function(){this.modules.dashboard=new D(this),this.modules.dashboard.initialize(),this.modules.performance=new Se(this),this.modules.performance.initialize(),this.modules.staff=null,this.modules.admin=null,this.modules.wine=null,this.modules.inventory=null,this.modules.cocktails=null}},{key:"loadModule",value:(s=Fn(Nn().m(function e(t){var r,n,i,s;return Nn().w(function(e){for(;;)switch(e.n){case 0:if(!this.modules[t]||null===this.modules[t]){e.n=1;break}return e.a(2,this.modules[t]);case 1:r=performance.now(),s=t,e.n="staff"===s?2:"admin"===s?3:"wine"===s?4:"inventory"===s?5:"cocktails"===s?6:8;break;case 2:return this.modules.staff||(this.modules.staff=new N(this),this.modules.staff.initialize()),n=this.modules.staff,e.a(3,9);case 3:return this.modules.admin||(this.modules.admin=new ue(this),this.modules.admin.initialize()),n=this.modules.admin,e.a(3,9);case 4:return this.modules.wine||(this.modules.wine=new pe(this),this.modules.wine.initialize()),n=this.modules.wine,e.a(3,9);case 5:return this.modules.inventory||(this.modules.inventory=new ve(this),this.modules.inventory.initialize()),n=this.modules.inventory,e.a(3,9);case 6:if(this.modules.cocktails){e.n=7;break}return this.modules.cocktails=Rn,e.n=7,this.modules.cocktails.initialize();case 7:return n=this.modules.cocktails,e.a(3,9);case 8:n=this.modules[t];case 9:return i=performance.now()-r,this.services.monitor&&this.services.monitor.trackModuleLoad(t,i),e.a(2,n)}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"setupEventListeners",value:function(){var e=this,t=document.getElementById("loginForm");t&&t.addEventListener("submit",function(t){t.preventDefault(),e.handleLogin()})}},{key:"setupNavigation",value:function(){var e=this;document.querySelectorAll(".nav-tab").forEach(function(t){t.addEventListener("click",function(r){t.dataset.tab&&(e.showTab(t.dataset.tab),document.querySelectorAll(".nav-tab").forEach(function(e){return e.classList.remove("active")}),t.classList.add("active"))})})}},{key:"initializeServices",value:function(){this.services.performance=new p,this.services.monitor=new _,this.services.search=new x,this.services.theme=new I}},{key:"setupEnhancedFeatures",value:function(){var e=this;document.addEventListener("keydown",function(t){if(t.ctrlKey||t.metaKey)switch(t.key){case"k":t.preventDefault(),e.focusSearch();break;case"t":t.preventDefault(),e.services.theme.toggleTheme();break;case"1":case"2":case"3":case"4":case"5":t.preventDefault();var r=["dashboard","staff","admin","wine","inventory"],n=parseInt(t.key)-1;n<r.length&&e.showTab(r[n])}});var t=document.getElementById("wineSearch");t&&t.addEventListener("input",function(t){var r=t.target.value;if(r.length>1){var n=e.services.search.search(r);e.updateWineResults(n)}})}},{key:"focusSearch",value:function(){var e=document.querySelectorAll('input[type="text"]');e.length>0&&e[0].focus()}},{key:"updateWineResults",value:function(e){document.getElementById("wineCategories")&&e.length}},{key:"handleLogin",value:function(){var e=document.getElementById("username").value.toLowerCase(),t=document.getElementById("password").value;i.authenticate(e,t)?this.showMainApp():alert("Invalid credentials. Please try again.")}},{key:"showMainApp",value:function(){document.getElementById("loginPage").classList.add("hidden"),document.getElementById("mainApp").classList.remove("hidden"),this.init()}},{key:"showTab",value:(n=Fn(Nn().m(function e(t){var r;return Nn().w(function(e){for(;;)switch(e.n){case 0:if(document.querySelectorAll(".tab-content").forEach(function(e){e.classList.add("hidden")}),"dashboard"===t){e.n=1;break}return e.n=1,this.loadModule(t);case 1:(r=document.getElementById(t+"-content"))&&r.classList.remove("hidden");case 2:return e.a(2)}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"logout",value:function(){document.getElementById("mainApp").classList.add("hidden"),document.getElementById("loginPage").classList.remove("hidden"),document.getElementById("username").value="",document.getElementById("password").value="",Object.values(this.modules).forEach(function(e){e&&e.cleanup&&e.cleanup()}),this.clearCaches(),window.gc&&window.gc()}},{key:"clearCaches",value:function(){this.modules.admin&&this.modules.admin.ocrService&&this.modules.admin.ocrService.cache.clear(),this.services.search&&(this.services.search.lastQuery="",this.services.search.lastResults=null)}},{key:"updateState",value:function(e){this.state=Mn(Mn({},this.state),e),this.saveState()}},{key:"saveState",value:function(){localStorage.setItem("items86",JSON.stringify(this.state.items86)),localStorage.setItem("inventoryData",JSON.stringify(this.state.inventoryData))}},{key:"showToast",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=document.createElement("div"),n="success"===t?"bg-green-600":"error"===t?"bg-red-600":"warning"===t?"bg-yellow-600":"bg-dark-green";r.className="fixed bottom-4 right-4 ".concat(n," text-white py-2 px-4 rounded-lg shadow-lg z-50 animate-fade-in-up"),r.textContent=e,document.body.appendChild(r),setTimeout(function(){r.classList.add("animate-fade-out"),setTimeout(function(){document.body.contains(r)&&document.body.removeChild(r)},500)},3e3)}},{key:"handleError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.services.performance&&this.services.performance.metrics.errors.push({message:e.message,context:t,timestamp:Date.now()}),this.showToast("An error occurred: ".concat(e.message),"error")}}],t&&Gn(e.prototype,t),r&&Gn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,n,s}();document.addEventListener("DOMContentLoaded",function(){window.app=new Kn})})()})();
//# sourceMappingURL=bundle.js.map